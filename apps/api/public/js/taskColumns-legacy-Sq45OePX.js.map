{"version":3,"file":"taskColumns-legacy-Sq45OePX.js","sources":["../../../../node_modules/.pnpm/@heroicons+react@2.2.0_react@18.2.0/node_modules/@heroicons/react/20/solid/esm/QuestionMarkCircleIcon.js","../../../web/src/columns/taskColumns.tsx","../../../web/src/columns/taskDeadline.ts"],"sourcesContent":["import * as React from \"react\";\nfunction QuestionMarkCircleIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 20 20\",\n    fill: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M18 10a8 8 0 1 1-16 0 8 8 0 0 1 16 0ZM8.94 6.94a.75.75 0 1 1-1.061-1.061 3 3 0 1 1 2.871 5.026v.345a.75.75 0 0 1-1.5 0v-.5c0-.72.57-1.172 1.081-1.287A1.5 1.5 0 1 0 8.94 6.94ZM10 15a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z\",\n    clipRule: \"evenodd\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(QuestionMarkCircleIcon);\nexport default ForwardRef;","// Конфигурация колонок задач для React Table\r\n// Модули: React, @tanstack/react-table, heroicons, EmployeeLink\r\nimport React from \"react\";\r\nimport type { ColumnDef } from \"@tanstack/react-table\";\r\nimport { PROJECT_TIMEZONE, PROJECT_TIMEZONE_LABEL, type Task } from \"shared\";\r\nimport { QuestionMarkCircleIcon } from \"@heroicons/react/20/solid\";\r\nimport EmployeeLink from \"../components/EmployeeLink\";\r\nimport { getDeadlineState, type DeadlineState } from \"./taskDeadline\";\r\nimport type { User as AppUser } from \"../types/user\";\r\n\r\n// Оформление бейджей статусов и приоритетов на дизайн-токенах\r\nconst badgeBaseClass =\r\n  \"inline-flex min-w-0 items-center gap-0.5 whitespace-nowrap rounded-full px-1.5 py-0.5 text-center text-[0.66rem] font-semibold uppercase tracking-wide shadow-xs\";\r\nconst badgeTextClass = \"text-black dark:text-white\";\r\n\r\nconst buildBadgeClass = (tones: string, extraClass = \"\") =>\r\n  [badgeBaseClass, \"transition-colors\", badgeTextClass, extraClass, tones]\r\n    .filter(Boolean)\r\n    .join(\" \");\r\n\r\nconst focusableBadgeClass =\r\n  \"focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background\";\r\n\r\nconst pillBadgeBaseClass =\r\n  \"inline-flex max-w-full min-w-0 items-center gap-0.5 whitespace-nowrap rounded-full px-1.5 py-0.5 text-left text-[0.7rem] font-semibold leading-tight tracking-normal shadow-xs sm:px-1.5 sm:text-[0.76rem]\";\r\n\r\nconst dateBadgeClass =\r\n  `${pillBadgeBaseClass} font-mono normal-case ${badgeTextClass} ring-1 ring-slate-500/30 bg-slate-500/10 dark:bg-slate-500/20 dark:ring-slate-400/30`;\r\n\r\nconst dateBadgeTimeClass =\r\n  \"text-[0.65rem] font-semibold text-slate-500 dark:text-slate-200\";\r\n\r\nconst numberBadgeClass =\r\n  `${pillBadgeBaseClass} justify-center font-mono uppercase tracking-[0.18em] text-[0.68rem] ${badgeTextClass} ring-1 ring-slate-500/30 bg-slate-500/10 dark:bg-slate-500/20 dark:ring-slate-400/30`;\r\n\r\nconst titleBadgeClass =\r\n  `${pillBadgeBaseClass} justify-start normal-case ${badgeTextClass} ring-1 ring-indigo-500/40 bg-indigo-500/15 dark:bg-indigo-400/25 dark:ring-indigo-300/45`;\r\n\r\nexport const creatorBadgeClass =\r\n  `${pillBadgeBaseClass} w-full max-w-full justify-start normal-case ${badgeTextClass} ring-1 ring-blue-500/40 bg-blue-500/15 dark:bg-blue-400/20 dark:ring-blue-300/45`;\r\n\r\nconst assigneeBadgeClass =\r\n  `${pillBadgeBaseClass} normal-case ${badgeTextClass} ring-1 ring-violet-500/35 bg-violet-500/20 dark:bg-violet-400/30 dark:ring-violet-300/45`;\r\n\r\nexport const fallbackBadgeClass = buildBadgeClass(\r\n  \"bg-muted/60 ring-1 ring-muted-foreground/30 dark:bg-slate-700/60 dark:ring-slate-500/35\",\r\n);\r\n\r\nconst locationBadgeClass =\r\n  `${pillBadgeBaseClass} normal-case ${badgeTextClass} ring-1 ring-emerald-500/30 bg-emerald-500/15 dark:bg-emerald-400/20 dark:ring-emerald-300/30`;\r\n\r\nconst locationLinkBadgeClass =\r\n  `${locationBadgeClass} ${focusableBadgeClass} no-underline underline-offset-4 hover:underline`;\r\n\r\nconst statusBadgeClassMap: Record<Task[\"status\"], string> = {\r\n  Новая: buildBadgeClass(\r\n    \"bg-sky-500/20 ring-1 ring-sky-500/45 dark:bg-sky-400/25 dark:ring-sky-300/45\",\r\n  ),\r\n  \"В работе\": buildBadgeClass(\r\n    \"bg-amber-500/25 ring-1 ring-amber-500/45 dark:bg-amber-400/25 dark:ring-amber-300/45\",\r\n  ),\r\n  Выполнена: buildBadgeClass(\r\n    \"bg-emerald-500/20 ring-1 ring-emerald-500/40 dark:bg-emerald-400/25 dark:ring-emerald-300/45\",\r\n  ),\r\n  Отменена: buildBadgeClass(\r\n    \"bg-rose-500/20 ring-1 ring-rose-500/40 dark:bg-rose-400/25 dark:ring-rose-300/45\",\r\n  ),\r\n};\r\n\r\nconst urgentPriorityBadgeClass = buildBadgeClass(\r\n  \"bg-accent/80 ring-1 ring-destructive/40 dark:bg-accent/60 dark:ring-destructive/40\",\r\n);\r\n\r\nconst highPriorityBadgeClass = buildBadgeClass(\r\n  \"bg-accent/75 ring-1 ring-primary/40 dark:bg-accent/55 dark:ring-primary/40\",\r\n);\r\n\r\nconst normalPriorityBadgeClass = buildBadgeClass(\r\n  \"bg-accent/65 ring-1 ring-primary/30 dark:bg-accent/45 dark:ring-primary/30\",\r\n);\r\n\r\nconst lowPriorityBadgeClass = buildBadgeClass(\r\n  \"bg-accent/50 ring-1 ring-primary/20 dark:bg-accent/35 dark:ring-primary/20\",\r\n);\r\n\r\nconst priorityBadgeClassMap: Record<string, string> = {\r\n  срочно: buildBadgeClass(\r\n    \"bg-rose-500/20 ring-1 ring-rose-500/40 dark:bg-rose-400/25 dark:ring-rose-300/45\",\r\n  ),\r\n  'в течение дня': buildBadgeClass(\r\n    \"bg-sky-500/20 ring-1 ring-sky-500/40 dark:bg-sky-400/25 dark:ring-sky-300/45\",\r\n  ),\r\n  'до выполнения': buildBadgeClass(\r\n    \"bg-slate-500/25 ring-1 ring-slate-500/45 dark:bg-slate-400/25 dark:ring-slate-300/45\",\r\n    \"normal-case\",\r\n  ),\r\n};\r\n\r\nconst hasOwn = <T extends Record<PropertyKey, unknown>>(obj: T, key: PropertyKey): key is keyof T =>\r\n  Object.prototype.hasOwnProperty.call(obj, key);\r\n\r\nexport const getStatusBadgeClass = (value: string) => {\r\n  if (hasOwn(statusBadgeClassMap, value)) {\r\n    return statusBadgeClassMap[value];\r\n  }\r\n  return null;\r\n};\r\n\r\nexport const getPriorityBadgeClass = (value: string) => {\r\n  const normalized = value.trim().toLowerCase();\r\n  if (!normalized) {\r\n    return null;\r\n  }\r\n  if (hasOwn(priorityBadgeClassMap, normalized)) {\r\n    return priorityBadgeClassMap[normalized];\r\n  }\r\n  if (/сроч|urgent/.test(normalized)) {\r\n    return urgentPriorityBadgeClass;\r\n  }\r\n  if (/высок|повыш|high/.test(normalized)) {\r\n    return highPriorityBadgeClass;\r\n  }\r\n  if (/низк|бесср|без\\s+срок|до\\s+выполн|low|minor/.test(normalized)) {\r\n    return lowPriorityBadgeClass;\r\n  }\r\n  if (/обыч|дня|сутк|norm|stand/.test(normalized)) {\r\n    return normalPriorityBadgeClass;\r\n  }\r\n  return null;\r\n};\r\n\r\nconst normalizePriorityLabel = (value: string) => {\r\n  const trimmed = value.trim();\r\n  if (!trimmed) {\r\n    return trimmed;\r\n  }\r\n  if (/^бессроч/i.test(trimmed)) {\r\n    return \"До выполнения\";\r\n  }\r\n  return trimmed;\r\n};\r\n\r\nconst completionNoteTextClass =\r\n  \"text-[11px] font-medium text-slate-600 dark:text-slate-300\";\r\n\r\nconst typeBadgeClassMap: Record<string, string> = {\r\n  доставить: buildBadgeClass(\r\n    \"bg-sky-500/20 ring-1 ring-sky-500/40 dark:bg-sky-400/25 dark:ring-sky-300/45\",\r\n  ),\r\n  купить: buildBadgeClass(\r\n    \"bg-violet-500/20 ring-1 ring-violet-500/40 dark:bg-violet-400/25 dark:ring-violet-300/45\",\r\n  ),\r\n  выполнить: buildBadgeClass(\r\n    \"bg-emerald-500/20 ring-1 ring-emerald-500/40 dark:bg-emerald-400/25 dark:ring-emerald-300/45\",\r\n  ),\r\n  построить: buildBadgeClass(\r\n    \"bg-amber-500/25 ring-1 ring-amber-500/45 dark:bg-amber-400/25 dark:ring-amber-300/45\",\r\n  ),\r\n  починить: buildBadgeClass(\r\n    \"bg-orange-500/20 ring-1 ring-orange-500/40 dark:bg-orange-400/25 dark:ring-orange-300/45\",\r\n  ),\r\n};\r\n\r\nexport const getTypeBadgeClass = (value: string) => {\r\n  const normalized = value.trim().toLowerCase();\r\n  if (!normalized) {\r\n    return null;\r\n  }\r\n  if (hasOwn(typeBadgeClassMap, normalized)) {\r\n    return typeBadgeClassMap[normalized];\r\n  }\r\n  if (/стро|монтаж/.test(normalized)) {\r\n    return typeBadgeClassMap['построить'];\r\n  }\r\n  if (/ремонт|чин/.test(normalized)) {\r\n    return typeBadgeClassMap['починить'];\r\n  }\r\n  if (/закуп|покуп|приобр/.test(normalized)) {\r\n    return typeBadgeClassMap['купить'];\r\n  }\r\n  if (/достав|курьер/.test(normalized)) {\r\n    return typeBadgeClassMap['доставить'];\r\n  }\r\n  if (/исполн|выполн/.test(normalized)) {\r\n    return typeBadgeClassMap['выполнить'];\r\n  }\r\n  return null;\r\n};\r\n\r\nconst parseDistance = (value: unknown) => {\r\n  if (typeof value === \"number\") {\r\n    return Number.isFinite(value) ? value : null;\r\n  }\r\n  if (typeof value === \"string\") {\r\n    const trimmed = value.trim();\r\n    if (!trimmed) {\r\n      return null;\r\n    }\r\n    const normalized = Number(trimmed.replace(/\\s+/g, \"\").replace(/,/g, \".\"));\r\n    return Number.isFinite(normalized) ? normalized : null;\r\n  }\r\n  return null;\r\n};\r\n\r\nconst formatDistanceLabel = (value: unknown) => {\r\n  const numeric = parseDistance(value);\r\n  if (numeric !== null) {\r\n    return numeric.toLocaleString(\"ru-RU\", {\r\n      maximumFractionDigits: 2,\r\n      minimumFractionDigits: 2,\r\n    });\r\n  }\r\n  if (typeof value === \"string\") {\r\n    return value.trim();\r\n  }\r\n  if (typeof value === \"number\") {\r\n    return value.toString();\r\n  }\r\n  return \"\";\r\n};\r\n\r\nconst shortDistanceBadgeClass = buildBadgeClass(\r\n  \"bg-emerald-500/20 ring-1 ring-emerald-500/40 dark:bg-emerald-400/25 dark:ring-emerald-300/45\",\r\n);\r\n\r\nconst mediumDistanceBadgeClass = buildBadgeClass(\r\n  \"bg-sky-500/20 ring-1 ring-sky-500/40 dark:bg-sky-400/25 dark:ring-sky-300/45\",\r\n);\r\n\r\nconst longDistanceBadgeClass = buildBadgeClass(\r\n  \"bg-amber-500/25 ring-1 ring-amber-500/45 dark:bg-amber-400/25 dark:ring-amber-300/45\",\r\n);\r\n\r\nconst extraLongDistanceBadgeClass = buildBadgeClass(\r\n  \"bg-rose-500/20 ring-1 ring-rose-500/40 dark:bg-rose-400/25 dark:ring-rose-300/45\",\r\n);\r\n\r\nconst getDistanceBadgeClass = (value: unknown) => {\r\n  const numeric = parseDistance(value);\r\n  if (numeric === null) {\r\n    return null;\r\n  }\r\n  if (numeric < 5) {\r\n    return shortDistanceBadgeClass;\r\n  }\r\n  if (numeric < 25) {\r\n    return mediumDistanceBadgeClass;\r\n  }\r\n  if (numeric < 100) {\r\n    return longDistanceBadgeClass;\r\n  }\r\n  return extraLongDistanceBadgeClass;\r\n};\r\n\r\nconst fullDateTimeFmt = new Intl.DateTimeFormat(\"ru-RU\", {\r\n  day: \"2-digit\",\r\n  month: \"2-digit\",\r\n  year: \"numeric\",\r\n  hour: \"2-digit\",\r\n  minute: \"2-digit\",\r\n  hour12: false,\r\n  timeZone: PROJECT_TIMEZONE,\r\n});\r\n\r\nconst datePartFmt = new Intl.DateTimeFormat(\"ru-RU\", {\r\n  day: \"2-digit\",\r\n  month: \"2-digit\",\r\n  year: \"numeric\",\r\n  timeZone: PROJECT_TIMEZONE,\r\n});\r\n\r\nconst timePartFmt = new Intl.DateTimeFormat(\"ru-RU\", {\r\n  hour: \"2-digit\",\r\n  minute: \"2-digit\",\r\n  hour12: false,\r\n  timeZone: PROJECT_TIMEZONE,\r\n});\r\n\r\nconst parseDateInput = (value?: string | null) => {\r\n  if (!value) {\r\n    return null;\r\n  }\r\n  const date = new Date(value);\r\n  return Number.isNaN(date.getTime()) ? null : date;\r\n};\r\n\r\nconst formatDate = (value?: string) => {\r\n  const date = parseDateInput(value);\r\n  if (!date) return null;\r\n  const full = `${fullDateTimeFmt.format(date).replace(\", \", \" \")} ${PROJECT_TIMEZONE_LABEL}`;\r\n  const datePart = datePartFmt.format(date);\r\n  const timePart = timePartFmt.format(date);\r\n  return {\r\n    full,\r\n    date: datePart || full,\r\n    time: timePart,\r\n  };\r\n};\r\n\r\nconst renderDateCell = (value?: string) => {\r\n  const formatted = formatDate(value);\r\n  if (!formatted) return \"\";\r\n  return (\r\n    <span className={dateBadgeClass} title={formatted.full}>\r\n      <time\r\n        dateTime={value}\r\n        className=\"flex w-full items-baseline gap-1 truncate tabular-nums\"\r\n      >\r\n        <span className=\"truncate\">{formatted.date}</span>\r\n        {formatted.time ? (\r\n          <span className={dateBadgeTimeClass}>{formatted.time}</span>\r\n        ) : null}\r\n      </time>\r\n    </span>\r\n  );\r\n};\r\n\r\n// Делает текст компактнее, добавляя многоточие по необходимости\r\nconst compactText = (value: string, maxLength: number) => {\r\n  const trimmed = value.trim();\r\n  if (!trimmed || maxLength < 2 || trimmed.length <= maxLength) {\r\n    return trimmed;\r\n  }\r\n  const shortened = trimmed.slice(0, maxLength - 1).trimEnd();\r\n  return `${shortened}…`;\r\n};\r\n\r\nexport type EntityKind = \"task\" | \"request\";\r\n\r\nexport interface TaskRow extends Task {\r\n  id: string;\r\n  created_by?: number | string | null;\r\n  createdBy?: number | string | null;\r\n  creator?: number | string | null;\r\n  assigned_user_id?: number | null;\r\n  assignees?: number[];\r\n  start_date?: string | null;\r\n  due_date?: string | null;\r\n  start_location?: string | null;\r\n  start_location_link?: string | null;\r\n  end_location?: string | null;\r\n  end_location_link?: string | null;\r\n}\r\n\r\ntype EntityCase = \"nominative\" | \"accusative\" | \"genitive\";\r\n\r\nconst ENTITY_WORDS: Record<EntityKind, Record<EntityCase, string>> = {\r\n  task: {\r\n    nominative: \"Задача\",\r\n    accusative: \"Задачу\",\r\n    genitive: \"задачи\",\r\n  },\r\n  request: {\r\n    nominative: \"Заявка\",\r\n    accusative: \"Заявку\",\r\n    genitive: \"заявки\",\r\n  },\r\n};\r\n\r\nconst entityWord = (\r\n  kind: EntityKind,\r\n  form: EntityCase,\r\n  options?: { lower?: boolean },\r\n) => {\r\n  const base = ENTITY_WORDS[kind][form];\r\n  return options?.lower ? base.toLowerCase() : base;\r\n};\r\n\r\nconst resolveEntityKind = (\r\n  value: unknown,\r\n  fallback: EntityKind,\r\n): EntityKind => {\r\n  if (typeof value === \"string\" && value.trim().toLowerCase() === \"request\") {\r\n    return \"request\";\r\n  }\r\n  return fallback;\r\n};\r\n\r\nconst escapeRegExp = (value: string) =>\r\n  value.replace(/[.*+?^${}()|[\\\\]\\\\]/g, \"\\\\$&\");\r\n\r\ntype CountdownLikeState = Extract<\r\n  DeadlineState,\r\n  { kind: \"countdown\" | \"pending\" | \"overdue\" }\r\n>;\r\n\r\nconst countdownBadgeBaseClass = `${pillBadgeBaseClass} min-w-0 justify-start normal-case ${badgeTextClass} tabular-nums ring-1`;\r\n\r\nconst countdownToneClassMap: Record<\r\n  \"safe\" | \"warn\" | \"danger\" | \"overdue\" | \"pending\",\r\n  string\r\n> = {\r\n  safe: `${countdownBadgeBaseClass} bg-emerald-500/25 ring-emerald-500/45 dark:bg-emerald-400/25 dark:ring-emerald-300/45`,\r\n  warn: `${countdownBadgeBaseClass} bg-amber-500/25 ring-amber-500/45 dark:bg-amber-400/25 dark:ring-amber-300/45`,\r\n  danger: `${countdownBadgeBaseClass} bg-orange-500/25 ring-orange-500/45 dark:bg-orange-400/25 dark:ring-orange-300/45`,\r\n  overdue: `${countdownBadgeBaseClass} bg-rose-500/30 ring-rose-500/55 dark:bg-rose-400/30 dark:ring-rose-300/50`,\r\n  pending: `${countdownBadgeBaseClass} bg-sky-500/20 ring-sky-500/45 dark:bg-sky-400/25 dark:ring-sky-300/45`,\r\n};\r\n\r\nconst neutralCountdownBadgeClass = `${countdownBadgeBaseClass} bg-slate-500/15 ring-slate-500/35 dark:bg-slate-500/25 dark:ring-slate-400/35`;\r\n\r\nconst formatCountdownParts = (remainingMs: number) => {\r\n  const absValue = Math.abs(remainingMs);\r\n  const totalMinutes = Math.max(0, Math.floor(absValue / (60 * 1000)));\r\n  const days = Math.floor(totalMinutes / (24 * 60));\r\n  const hours = Math.floor((totalMinutes % (24 * 60)) / 60);\r\n  const minutes = totalMinutes % 60;\r\n  const pad = (value: number) => value.toString().padStart(2, \"0\");\r\n  return {\r\n    days,\r\n    hours,\r\n    minutes,\r\n    paddedDays: pad(days),\r\n    paddedHours: pad(hours),\r\n    paddedMinutes: pad(minutes),\r\n  };\r\n};\r\n\r\nconst getRussianPlural = (\r\n  value: number,\r\n  forms: [string, string, string],\r\n) => {\r\n  const absValue = Math.abs(value) % 100;\r\n  if (absValue >= 11 && absValue <= 14) {\r\n    return forms[2];\r\n  }\r\n  const lastDigit = absValue % 10;\r\n  if (lastDigit === 1) {\r\n    return forms[0];\r\n  }\r\n  if (lastDigit >= 2 && lastDigit <= 4) {\r\n    return forms[1];\r\n  }\r\n  return forms[2];\r\n};\r\n\r\nconst getCountdownToneKey = (\r\n  state: CountdownLikeState,\r\n): keyof typeof countdownToneClassMap => {\r\n  if (state.kind === \"overdue\") {\r\n    return \"overdue\";\r\n  }\r\n  if (state.kind === \"pending\") {\r\n    return \"pending\";\r\n  }\r\n  return state.level;\r\n};\r\n\r\nconst buildCountdownLabel = (state: CountdownLikeState) => {\r\n  const { days, hours, minutes } = formatCountdownParts(state.remainingMs);\r\n  if (state.kind === \"overdue\") {\r\n    return `Просрочено на ${days} ${getRussianPlural(days, [\r\n      \"день\",\r\n      \"дня\",\r\n      \"дней\",\r\n    ])} ${hours} ${getRussianPlural(hours, [\r\n      \"час\",\r\n      \"часа\",\r\n      \"часов\",\r\n    ])} ${minutes} ${getRussianPlural(minutes, [\r\n      \"минута\",\r\n      \"минуты\",\r\n      \"минут\",\r\n    ])}`;\r\n  }\r\n  if (state.kind === \"pending\") {\r\n    return `Начало через ${days} ${getRussianPlural(days, [\r\n      \"день\",\r\n      \"дня\",\r\n      \"дней\",\r\n    ])} ${hours} ${getRussianPlural(hours, [\r\n      \"час\",\r\n      \"часа\",\r\n      \"часов\",\r\n    ])} ${minutes} ${getRussianPlural(minutes, [\r\n      \"минута\",\r\n      \"минуты\",\r\n      \"минут\",\r\n    ])}`;\r\n  }\r\n  return `До дедлайна ${days} ${getRussianPlural(days, [\r\n    \"день\",\r\n    \"дня\",\r\n    \"дней\",\r\n  ])} ${hours} ${getRussianPlural(hours, [\r\n    \"час\",\r\n    \"часа\",\r\n    \"часов\",\r\n  ])} ${minutes} ${getRussianPlural(minutes, [\r\n    \"минута\",\r\n    \"минуты\",\r\n    \"минут\",\r\n  ])}`;\r\n};\r\n\r\nconst buildCountdownTitle = (\r\n  state: CountdownLikeState,\r\n  formatted: ReturnType<typeof formatDate>,\r\n  rawDue?: string,\r\n) => {\r\n  if (!formatted) {\r\n    return rawDue ? rawDue.trim() : undefined;\r\n  }\r\n  if (state.kind === \"overdue\") {\r\n    return `Просрочено с ${formatted.full}`;\r\n  }\r\n  if (state.kind === \"pending\") {\r\n    const note =\r\n      state.issue === \"missing-start\"\r\n        ? \"Не указана дата начала\"\r\n        : \"Диапазон дат некорректен\";\r\n    return `${note}. Срок ${formatted.full}`;\r\n  }\r\n  return `Выполнить до ${formatted.full}`;\r\n};\r\n\r\nconst COMPLETION_THRESHOLD_MS = 60_000;\r\n\r\nconst formatCompletionOffset = (diffMs: number) => {\r\n  const absValue = Math.abs(diffMs);\r\n  if (absValue < COMPLETION_THRESHOLD_MS) {\r\n    return \"менее минуты\";\r\n  }\r\n  const { days, hours, minutes } = formatCountdownParts(absValue);\r\n  const parts: string[] = [];\r\n  if (days) {\r\n    parts.push(`${days} ${getRussianPlural(days, [\"день\", \"дня\", \"дней\"])}`);\r\n  }\r\n  if (hours) {\r\n    parts.push(\r\n      `${hours} ${getRussianPlural(hours, [\"час\", \"часа\", \"часов\"])}`,\r\n    );\r\n  }\r\n  if (minutes && parts.length < 2) {\r\n    parts.push(\r\n      `${minutes} ${getRussianPlural(minutes, [\"минута\", \"минуты\", \"минут\"])}`,\r\n    );\r\n  }\r\n  if (!parts.length) {\r\n    return \"менее минуты\";\r\n  }\r\n  return parts.slice(0, 2).join(\" \");\r\n};\r\n\r\nconst buildCompletionNote = (\r\n  status: Task[\"status\"] | undefined,\r\n  dueValue?: string,\r\n  completedValue?: string | null,\r\n) => {\r\n  if (status !== \"Выполнена\") {\r\n    return null;\r\n  }\r\n  const dueDate = parseDateInput(dueValue);\r\n  const completedDate = parseDateInput(completedValue);\r\n  if (!dueDate || !completedDate) {\r\n    return null;\r\n  }\r\n  const diff = completedDate.getTime() - dueDate.getTime();\r\n  if (!Number.isFinite(diff)) {\r\n    return null;\r\n  }\r\n  if (Math.abs(diff) < COMPLETION_THRESHOLD_MS) {\r\n    return \"Выполнена точно в срок\";\r\n  }\r\n  const offset = formatCompletionOffset(diff);\r\n  if (!offset) {\r\n    return \"Выполнена точно в срок\";\r\n  }\r\n  return diff < 0\r\n    ? `Выполнена досрочно на ${offset}`\r\n    : `Выполнена с опозданием на ${offset}`;\r\n};\r\n\r\n// Fast Refresh обрабатывает вспомогательные компоненты как часть конфигурации таблицы\r\n// eslint-disable-next-line react-refresh/only-export-components\r\nexport function DeadlineCountdownBadge({\r\n  startValue,\r\n  dueValue,\r\n  rawDue,\r\n  status,\r\n  completedAt,\r\n}: {\r\n  startValue?: string;\r\n  dueValue?: string;\r\n  rawDue?: string;\r\n  status?: Task[\"status\"];\r\n  completedAt?: string | null;\r\n}) {\r\n  const completedDate = React.useMemo(\r\n    () => parseDateInput(completedAt),\r\n    [completedAt],\r\n  );\r\n  const isCompleted = status === \"Выполнена\";\r\n\r\n  const [now, setNow] = React.useState<Date>(\r\n    () => completedDate ?? new Date(),\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    if (isCompleted) {\r\n      if (completedDate) {\r\n        setNow(completedDate);\r\n      }\r\n      return;\r\n    }\r\n    const update = () => setNow(new Date());\r\n    update();\r\n    const timer = window.setInterval(update, 60_000);\r\n    return () => window.clearInterval(timer);\r\n  }, [isCompleted, completedDate, startValue, dueValue]);\r\n\r\n  const referenceDate = completedDate ?? now;\r\n\r\n  const state = React.useMemo(\r\n    () => getDeadlineState(startValue, dueValue, referenceDate),\r\n    [startValue, dueValue, referenceDate],\r\n  );\r\n\r\n  const formatted = React.useMemo(() => formatDate(dueValue), [dueValue]);\r\n  const completionNote = React.useMemo(\r\n    () => buildCompletionNote(status, dueValue, completedAt),\r\n    [status, dueValue, completedAt],\r\n  );\r\n\r\n  if (state.kind === \"invalid\") {\r\n    return (\r\n      <span\r\n        className={`${neutralCountdownBadgeClass} inline-flex items-center gap-1.5`}\r\n        title={\r\n          state.reason === \"missing\"\r\n            ? \"Срок не назначен\"\r\n            : \"Срок указан некорректно\"\r\n        }\r\n      >\r\n        <QuestionMarkCircleIcon\r\n          className=\"size-4 flex-shrink-0 text-black dark:text-white\"\r\n          aria-hidden\r\n        />\r\n        <span className=\"truncate\">Нет данных</span>\r\n      </span>\r\n    );\r\n  }\r\n\r\n  const toneKey = getCountdownToneKey(state);\r\n  const className = countdownToneClassMap[toneKey];\r\n  const parts = formatCountdownParts(state.remainingMs);\r\n  const label = buildCountdownLabel(state);\r\n  const title = completionNote\r\n    ? `${completionNote}. ${buildCountdownTitle(state, formatted, rawDue)}`\r\n    : buildCountdownTitle(state, formatted, rawDue);\r\n  return (\r\n    <span\r\n      className={`${className} inline-flex items-center gap-1.5`}\r\n      title={title}\r\n    >\r\n      <span className=\"sr-only\">{label}</span>\r\n      <span\r\n        aria-hidden\r\n        className=\"flex items-end gap-1 text-black dark:text-white\"\r\n      >\r\n        <span className=\"flex flex-col items-center leading-tight\">\r\n          <span className=\"text-[0.8rem] font-semibold tabular-nums\">\r\n            {parts.paddedDays}\r\n          </span>\r\n          <span className=\"text-[9px] font-medium text-black/80 dark:text-white/80\">\r\n            {getRussianPlural(parts.days, [\"день\", \"дня\", \"дней\"])}\r\n          </span>\r\n        </span>\r\n        <span className=\"flex flex-col items-center leading-tight\">\r\n          <span className=\"text-[0.8rem] font-semibold tabular-nums\">\r\n            {parts.paddedHours}\r\n          </span>\r\n          <span className=\"text-[9px] font-medium text-black/80 dark:text-white/80\">\r\n            {getRussianPlural(parts.hours, [\"час\", \"часа\", \"часов\"])}\r\n          </span>\r\n        </span>\r\n        <span className=\"flex flex-col items-center leading-tight\">\r\n          <span className=\"text-[0.8rem] font-semibold tabular-nums\">\r\n            {parts.paddedMinutes}\r\n          </span>\r\n          <span className=\"text-[9px] font-medium text-black/80 dark:text-white/80\">\r\n            {getRussianPlural(parts.minutes, [\"минута\", \"минуты\", \"минут\"])}\r\n          </span>\r\n        </span>\r\n      </span>\r\n      {completionNote ? (\r\n        <span className=\"sr-only\">{completionNote}</span>\r\n      ) : null}\r\n    </span>\r\n  );\r\n}\r\n\r\nconst durationToneClassMap: Record<\r\n  \"completed\" | \"cancelled\" | \"active\" | \"planned\" | \"idle\",\r\n  string\r\n> = {\r\n  completed: `${countdownBadgeBaseClass} bg-emerald-500/25 ring-emerald-500/45 dark:bg-emerald-400/25 dark:ring-emerald-300/45`,\r\n  cancelled: `${countdownBadgeBaseClass} bg-rose-500/30 ring-rose-500/55 dark:bg-rose-400/30 dark:ring-rose-300/50`,\r\n  active: `${countdownBadgeBaseClass} bg-amber-500/25 ring-amber-500/45 dark:bg-amber-400/25 dark:ring-amber-300/45`,\r\n  planned: `${countdownBadgeBaseClass} bg-sky-500/20 ring-sky-500/45 dark:bg-sky-400/25 dark:ring-sky-300/45`,\r\n  idle: neutralCountdownBadgeClass,\r\n};\r\n\r\nconst formatDurationPhrase = (\r\n  parts: ReturnType<typeof formatCountdownParts>,\r\n  variant: \"completed\" | \"running\",\r\n  entityKind: EntityKind,\r\n) => {\r\n  const { days, hours, minutes } = parts;\r\n  if (!days && !hours && !minutes) {\r\n    return variant === \"completed\"\r\n      ? `${entityWord(entityKind, \"nominative\")} завершена менее чем за минуту`\r\n      : \"Затрачено менее минуты\";\r\n  }\r\n  const dayLabel = `${days} ${getRussianPlural(days, [\r\n    \"день\",\r\n    \"дня\",\r\n    \"дней\",\r\n  ])}`;\r\n  const hourLabel = `${hours} ${getRussianPlural(hours, [\r\n    \"час\",\r\n    \"часа\",\r\n    \"часов\",\r\n  ])}`;\r\n  const minuteLabel = `${minutes} ${getRussianPlural(minutes, [\r\n    \"минута\",\r\n    \"минуты\",\r\n    \"минут\",\r\n  ])}`;\r\n  const phrase = `${dayLabel} ${hourLabel} ${minuteLabel}`;\r\n  return variant === \"completed\"\r\n    ? `${entityWord(entityKind, \"nominative\")} завершена за ${phrase}`\r\n    : `Затрачено ${phrase}`;\r\n};\r\n\r\nconst buildDurationTitle = (\r\n  variant: \"completed\" | \"running\" | \"idle\",\r\n  startValue?: string,\r\n  endValue?: string,\r\n  parts?: ReturnType<typeof formatCountdownParts>,\r\n  entityKind: EntityKind = \"task\",\r\n) => {\r\n  const titleParts: string[] = [];\r\n  const startFormatted = startValue ? formatDate(startValue) : null;\r\n  const endFormatted = endValue ? formatDate(endValue) : null;\r\n  if (startFormatted) {\r\n    titleParts.push(`Начало: ${startFormatted.full}`);\r\n  }\r\n  if (endFormatted) {\r\n    titleParts.push(\r\n      variant === \"completed\"\r\n        ? `Завершено: ${endFormatted.full}`\r\n        : `Текущее время: ${endFormatted.full}`,\r\n    );\r\n  }\r\n  if (parts) {\r\n    const phrase = formatDurationPhrase(\r\n      parts,\r\n      variant === \"completed\" ? \"completed\" : \"running\",\r\n      entityKind,\r\n    );\r\n    const normalized =\r\n      variant === \"completed\"\r\n        ? phrase.replace(\r\n            new RegExp(\r\n              `^${escapeRegExp(\r\n                `${entityWord(entityKind, \"nominative\")} завершена за `,\r\n              )}`,\r\n            ),\r\n            \"Продолжительность: \",\r\n          )\r\n        : phrase.replace(/^Затрачено\\s/, \"Продолжительность: \");\r\n    titleParts.push(\r\n      variant === \"idle\" ? `Продолжительность: ${phrase}` : normalized,\r\n    );\r\n  }\r\n  if (!titleParts.length) {\r\n    return variant === \"idle\"\r\n      ? \"Продолжительность появится после указания даты начала\"\r\n      : \"Нет данных о продолжительности\";\r\n  }\r\n  return titleParts.join(\"\\n\");\r\n};\r\n\r\ntype ActualTimeCellProps = {\r\n  progressStartValue?: string | null;\r\n  plannedStartValue?: string | null;\r\n  completedValue?: string | null;\r\n  status?: Task[\"status\"];\r\n  entityKind: EntityKind;\r\n};\r\n\r\n// eslint-disable-next-line react-refresh/only-export-components\r\nfunction ActualTimeCell({\r\n  progressStartValue,\r\n  plannedStartValue,\r\n  completedValue,\r\n  status,\r\n  entityKind,\r\n}: ActualTimeCellProps) {\r\n  const plannedStartDate = React.useMemo(\r\n    () => parseDateInput(plannedStartValue),\r\n    [plannedStartValue],\r\n  );\r\n  const progressStartDate = React.useMemo(\r\n    () => parseDateInput(progressStartValue),\r\n    [progressStartValue],\r\n  );\r\n  const completedDate = React.useMemo(\r\n    () => parseDateInput(completedValue),\r\n    [completedValue],\r\n  );\r\n  const isFinished = status === \"Выполнена\" || status === \"Отменена\";\r\n  const isCancelled = status === \"Отменена\";\r\n  const isNotStarted = status === \"Новая\";\r\n\r\n  const timerStartDate = React.useMemo(() => {\r\n    if (isNotStarted) {\r\n      return null;\r\n    }\r\n    return progressStartDate ?? plannedStartDate ?? null;\r\n  }, [isNotStarted, progressStartDate, plannedStartDate]);\r\n\r\n  const [referenceDate, setReferenceDate] = React.useState<Date>(() => {\r\n    if (isFinished && completedDate) {\r\n      return completedDate;\r\n    }\r\n    return new Date();\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    if (isFinished) {\r\n      if (completedDate) {\r\n        setReferenceDate(completedDate);\r\n      }\r\n      return undefined;\r\n    }\r\n    if (!timerStartDate) {\r\n      return undefined;\r\n    }\r\n    const update = () => setReferenceDate(new Date());\r\n    update();\r\n    const timer = window.setInterval(update, 60_000);\r\n    return () => window.clearInterval(timer);\r\n  }, [isFinished, completedDate, timerStartDate]);\r\n\r\n  const effectiveEndDate = isFinished && completedDate\r\n    ? completedDate\r\n    : referenceDate;\r\n  const durationMs = timerStartDate\r\n    ? Math.max(0, effectiveEndDate.getTime() - timerStartDate.getTime())\r\n    : null;\r\n  const durationParts = React.useMemo(() => {\r\n    if (isNotStarted) {\r\n      return formatCountdownParts(0);\r\n    }\r\n    return durationMs !== null ? formatCountdownParts(durationMs) : null;\r\n  }, [durationMs, isNotStarted]);\r\n\r\n  const endIso = React.useMemo(() => effectiveEndDate.toISOString(), [\r\n    effectiveEndDate,\r\n  ]);\r\n\r\n  const variant: \"completed\" | \"running\" | \"idle\" =\r\n    isNotStarted || !timerStartDate\r\n      ? \"idle\"\r\n      : isFinished\r\n      ? \"completed\"\r\n      : \"running\";\r\n\r\n  const toneKey: keyof typeof durationToneClassMap =\r\n    isNotStarted || !timerStartDate\r\n      ? \"idle\"\r\n      : isFinished\r\n      ? isCancelled\r\n        ? \"cancelled\"\r\n        : \"completed\"\r\n      : status === \"В работе\"\r\n      ? \"active\"\r\n      : \"planned\";\r\n\r\n  const label = isNotStarted\r\n    ? `${entityWord(entityKind, \"nominative\")} ещё не начата`\r\n    : durationParts\r\n    ? formatDurationPhrase(\r\n        durationParts,\r\n        variant === \"completed\" ? \"completed\" : \"running\",\r\n        entityKind,\r\n      )\r\n    : \"Продолжительность появится после начала\";\r\n\r\n  const startValueForTooltip =\r\n    progressStartValue ?? plannedStartValue ?? undefined;\r\n\r\n  const durationBadgeTitle = isNotStarted\r\n    ? `Таймер запустится после перевода ${entityWord(entityKind, \"genitive\", { lower: true })} в статус «В работе»`\r\n    : buildDurationTitle(\r\n        variant,\r\n        startValueForTooltip,\r\n        variant === \"completed\" ? completedValue ?? undefined : endIso,\r\n        durationParts ?? undefined,\r\n        entityKind,\r\n      );\r\n\r\n  const renderStopBadge = () => {\r\n    if (isFinished && completedDate && completedValue) {\r\n      return renderDateCell(completedValue);\r\n    }\r\n    if (isFinished) {\r\n      return (\r\n        <span className={dateBadgeClass} title=\"Нет отметки о завершении\">\r\n          <span className=\"truncate\">Нет данных</span>\r\n        </span>\r\n      );\r\n    }\r\n    if (!timerStartDate) {\r\n      const placeholder =\r\n        status === \"Новая\"\r\n          ? \"Не начата\"\r\n          : status === \"В работе\"\r\n          ? \"В работе\"\r\n          : \"В ожидании\";\r\n      const title =\r\n        status === \"Новая\"\r\n          ? `${entityWord(entityKind, \"nominative\")} ещё не начата`\r\n          : status === \"В работе\"\r\n          ? \"Таймер запустится после фиксации начала\"\r\n          : \"Дата начала отсутствует\";\r\n      return (\r\n        <span className={dateBadgeClass} title={title}>\r\n          <span className=\"truncate\">{placeholder}</span>\r\n        </span>\r\n      );\r\n    }\r\n    const placeholder = status === \"В работе\" ? \"В работе\" : \"В ожидании\";\r\n    return (\r\n      <span\r\n        className={dateBadgeClass}\r\n        title={`${entityWord(entityKind, \"nominative\")} ещё не завершена`}\r\n      >\r\n        <span className=\"truncate\">{placeholder}</span>\r\n      </span>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-col items-start gap-1\">\r\n      {renderStopBadge()}\r\n      <span\r\n        className={`${durationToneClassMap[toneKey]} inline-flex items-center gap-1.5`}\r\n        title={durationBadgeTitle}\r\n      >\r\n        <span className=\"sr-only\">{label}</span>\r\n        {durationParts ? (\r\n          <span\r\n            aria-hidden\r\n            className=\"flex items-end gap-1 text-black dark:text-white\"\r\n          >\r\n            <span className=\"flex flex-col items-center leading-tight\">\r\n              <span className=\"text-[0.8rem] font-semibold tabular-nums\">\r\n                {durationParts.paddedDays}\r\n              </span>\r\n              <span className=\"text-[9px] font-medium text-black/80 dark:text-white/80\">\r\n                {getRussianPlural(durationParts.days, [\r\n                  \"день\",\r\n                  \"дня\",\r\n                  \"дней\",\r\n                ])}\r\n              </span>\r\n            </span>\r\n            <span className=\"flex flex-col items-center leading-tight\">\r\n              <span className=\"text-[0.8rem] font-semibold tabular-nums\">\r\n                {durationParts.paddedHours}\r\n              </span>\r\n              <span className=\"text-[9px] font-medium text-black/80 dark:text-white/80\">\r\n                {getRussianPlural(durationParts.hours, [\r\n                  \"час\",\r\n                  \"часа\",\r\n                  \"часов\",\r\n                ])}\r\n              </span>\r\n            </span>\r\n            <span className=\"flex flex-col items-center leading-tight\">\r\n              <span className=\"text-[0.8rem] font-semibold tabular-nums\">\r\n                {durationParts.paddedMinutes}\r\n              </span>\r\n              <span className=\"text-[9px] font-medium text-black/80 dark:text-white/80\">\r\n                {getRussianPlural(durationParts.minutes, [\r\n                  \"минута\",\r\n                  \"минуты\",\r\n                  \"минут\",\r\n                ])}\r\n              </span>\r\n            </span>\r\n          </span>\r\n        ) : (\r\n          <span className=\"text-xs font-medium text-black dark:text-white\">\r\n            {label}\r\n          </span>\r\n        )}\r\n      </span>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function taskColumns(\r\n  users: Record<number, AppUser>,\r\n  defaultKind: EntityKind = \"task\",\r\n): ColumnDef<TaskRow>[] {\r\n  const cols: ColumnDef<TaskRow>[] = [\r\n    {\r\n      header: \"Номер\",\r\n      id: \"number\",\r\n      accessorFn: (row) => {\r\n        const rowKind = resolveEntityKind(row.kind, defaultKind);\r\n        const rawValue =\r\n          rowKind === \"request\"\r\n            ? row.request_id || row.task_number || row._id\r\n            : row.task_number || row.request_id || row._id;\r\n        if (typeof rawValue === \"string\") {\r\n          return rawValue;\r\n        }\r\n        if (rawValue === undefined || rawValue === null) {\r\n          return \"\";\r\n        }\r\n        return String(rawValue);\r\n      },\r\n      meta: {\r\n        width: \"clamp(4.25rem, 8vw, 6.25rem)\",\r\n        minWidth: \"4rem\",\r\n        maxWidth: \"6.5rem\",\r\n        cellClassName:\r\n          \"whitespace-nowrap text-center font-mono tabular-nums sm:text-left sm:pl-1.5\",\r\n        headerClassName: \"whitespace-nowrap text-center sm:text-left\",\r\n      },\r\n      cell: (p) => {\r\n        const row = p.row.original as TaskRow;\r\n        const rowKind = resolveEntityKind(row.kind, defaultKind);\r\n        const value = (p.getValue<string>() || \"\").trim();\r\n        const fallback =\r\n          rowKind === \"request\"\r\n            ? (row.request_id as string | undefined) ??\r\n              (row.task_number as string | undefined) ??\r\n              String(row._id)\r\n            : (row.task_number as string | undefined) ??\r\n              (row.request_id as string | undefined) ??\r\n              String(row._id);\r\n        const display = value || fallback || \"\";\r\n        const numericMatch = display.match(/\\d+/);\r\n        const shortValue = numericMatch ? numericMatch[0] : display;\r\n        return (\r\n          <span className={`${numberBadgeClass} justify-center`} title={display}>\r\n            <span className=\"truncate\">{shortValue}</span>\r\n          </span>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: `${entityWord(defaultKind, \"accusative\")} создал`,\r\n      accessorKey: \"createdAt\",\r\n      meta: {\r\n        width: \"clamp(9rem, 18vw, 14rem)\",\r\n        minWidth: \"8.5rem\",\r\n        maxWidth: \"16rem\",\r\n        cellClassName: \"whitespace-nowrap\",\r\n      },\r\n      cell: ({ row }) => {\r\n        const rawCreator =\r\n          (row.original.created_by as unknown) ??\r\n          (row.original.createdBy as unknown) ??\r\n          (row.original.creator as unknown);\r\n        const creatorId =\r\n          typeof rawCreator === \"number\"\r\n            ? rawCreator\r\n            : typeof rawCreator === \"string\" && rawCreator.trim()\r\n            ? Number(rawCreator)\r\n            : NaN;\r\n        if (!Number.isFinite(creatorId)) {\r\n          return <span className=\"text-muted-foreground\">—</span>;\r\n        }\r\n        const id = creatorId as number;\r\n        const user = users[id];\r\n        const label =\r\n          (user?.name as string | undefined) ||\r\n          (user?.telegram_username as string | undefined) ||\r\n          (user?.username as string | undefined) ||\r\n          String(id);\r\n        const title = label.trim() || String(id);\r\n        return (\r\n          <EmployeeLink\r\n            employeeId={id}\r\n            stopPropagation\r\n            title={title}\r\n            className={`${creatorBadgeClass} ${focusableBadgeClass} no-underline`}\r\n          >\r\n            <span className=\"truncate\">{compactText(label, 32)}</span>\r\n          </EmployeeLink>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: \"Название\",\r\n      accessorKey: \"title\",\r\n      meta: {\r\n        width: \"clamp(8rem, 18vw, 18rem)\",\r\n        minWidth: \"7rem\",\r\n        maxWidth: \"18rem\",\r\n        cellClassName: \"align-top\",\r\n      },\r\n      cell: (p) => {\r\n        const v = p.getValue<string>() || \"\";\r\n        const compact = compactText(v, 72);\r\n        const row = p.row.original as TaskRow;\r\n        const completionNote = buildCompletionNote(\r\n          row.status,\r\n          row.due_date ?? undefined,\r\n          row.completed_at ?? undefined,\r\n        );\r\n        return (\r\n          <div className=\"flex flex-col items-start gap-1\">\r\n            <span\r\n              title={v}\r\n              className={`${titleBadgeClass} whitespace-normal`}\r\n            >\r\n              <span\r\n                className=\"block max-w-full break-words text-left leading-snug\"\r\n                style={{\r\n                  display: \"-webkit-box\",\r\n                  WebkitLineClamp: 2,\r\n                  WebkitBoxOrient: \"vertical\",\r\n                  overflow: \"hidden\",\r\n                }}\r\n              >\r\n                {compact}\r\n              </span>\r\n            </span>\r\n            {completionNote ? (\r\n              <span className={completionNoteTextClass}>{completionNote}</span>\r\n            ) : null}\r\n          </div>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: \"Исполнители\",\r\n      accessorKey: \"assignees\",\r\n      meta: {\r\n        width: \"clamp(7rem, 20vw, 13rem)\",\r\n        minWidth: \"6rem\",\r\n        maxWidth: \"13rem\",\r\n      },\r\n      cell: ({ row }) => {\r\n        const ids = Array.isArray(row.original.assignees)\r\n          ? row.original.assignees\r\n          : typeof row.original.assigned_user_id === \"number\"\r\n          ? [row.original.assigned_user_id]\r\n          : [];\r\n        if (!ids.length) {\r\n          return <span className=\"text-muted-foreground\">—</span>;\r\n        }\r\n        const labels = ids.map((id) => ({\r\n          id,\r\n          label:\r\n            users[id]?.name ||\r\n            users[id]?.telegram_username ||\r\n            users[id]?.username ||\r\n            String(id),\r\n        }));\r\n        const tooltip = labels.map((item) => item.label).join(\", \");\r\n        return (\r\n          <div\r\n            className=\"flex w-full flex-wrap items-start gap-1 leading-tight\"\r\n            title={tooltip}\r\n          >\r\n            {labels.map(({ id, label }) => (\r\n              <EmployeeLink\r\n                key={id}\r\n                employeeId={id}\r\n                stopPropagation\r\n                className={`${assigneeBadgeClass} ${focusableBadgeClass} no-underline`}\r\n              >\r\n                <span className=\"truncate\">{compactText(label, 18)}</span>\r\n              </EmployeeLink>\r\n            ))}\r\n          </div>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: \"Статус\",\r\n      accessorKey: \"status\",\r\n      meta: {\r\n        width: \"clamp(4.5rem, 8vw, 6.5rem)\",\r\n        minWidth: \"4.5rem\",\r\n        maxWidth: \"6.5rem\",\r\n        cellClassName: \"whitespace-nowrap\",\r\n      },\r\n      cell: (p) => {\r\n        const value = p.getValue<string>() || \"\";\r\n        if (!value) {\r\n          return \"\";\r\n        }\r\n        const badgeClass = getStatusBadgeClass(value);\r\n        if (!badgeClass) {\r\n          return <span className={fallbackBadgeClass}>{value}</span>;\r\n        }\r\n        return <span className={badgeClass}>{value}</span>;\r\n      },\r\n    },\r\n    {\r\n      header: \"Приоритет\",\r\n      accessorKey: \"priority\",\r\n      meta: {\r\n        width: \"clamp(8.5rem, 15vw, 12.5rem)\",\r\n        minWidth: \"8.5rem\",\r\n        maxWidth: \"12.5rem\",\r\n        cellClassName: \"whitespace-nowrap\",\r\n      },\r\n      cell: (p) => {\r\n        const value = p.getValue<string>() || \"\";\r\n        if (!value.trim()) {\r\n          return \"\";\r\n        }\r\n        const display = normalizePriorityLabel(value);\r\n        const badgeClass = getPriorityBadgeClass(value);\r\n        const className = badgeClass || `${fallbackBadgeClass} normal-case`;\r\n        return (\r\n          <span className={className} title={display}>\r\n            {display}\r\n          </span>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: \"Начало\",\r\n      accessorKey: \"start_date\",\r\n      meta: {\r\n        width: \"clamp(6.75rem, 11vw, 8.75rem)\",\r\n        minWidth: \"6.5rem\",\r\n        maxWidth: \"9rem\",\r\n        cellClassName: \"whitespace-nowrap text-xs sm:text-sm\",\r\n      },\r\n      cell: (p) => renderDateCell(p.getValue<string>()),\r\n    },\r\n    {\r\n      header: \"Дедлайн\",\r\n      accessorKey: \"due_date\",\r\n      meta: {\r\n        width: \"clamp(10.5rem, 20vw, 15.5rem)\",\r\n        minWidth: \"10rem\",\r\n        maxWidth: \"16.5rem\",\r\n        cellClassName: \"whitespace-nowrap text-xs sm:text-sm\",\r\n      },\r\n      cell: (p) => {\r\n        const dueValue = p.getValue<string>();\r\n        const row = p.row.original;\r\n        const countdown = (\r\n          <DeadlineCountdownBadge\r\n            startValue={row.start_date ?? undefined}\r\n            dueValue={row.due_date ?? undefined}\r\n            rawDue={dueValue}\r\n            status={row.status}\r\n            completedAt={row.completed_at ?? undefined}\r\n          />\r\n        );\r\n        if (!dueValue) {\r\n          return countdown;\r\n        }\r\n        const dateCell = renderDateCell(dueValue);\r\n        if (typeof dateCell === \"string\") {\r\n          if (!dateCell) {\r\n            return countdown;\r\n          }\r\n          return (\r\n            <div className=\"flex flex-col items-start gap-1\">\r\n              {dateCell ? <span>{dateCell}</span> : null}\r\n              {countdown}\r\n            </div>\r\n          );\r\n        }\r\n        return (\r\n          <div className=\"flex flex-col items-start gap-1\">\r\n            {dateCell}\r\n            {countdown}\r\n          </div>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: \"Время выполнения\",\r\n      accessorKey: \"completed_at\",\r\n      meta: {\r\n        width: \"clamp(10.5rem, 20vw, 15.5rem)\",\r\n        minWidth: \"10rem\",\r\n        maxWidth: \"16.5rem\",\r\n        cellClassName: \"whitespace-nowrap text-xs sm:text-sm\",\r\n      },\r\n      cell: (p) => {\r\n        const row = p.row.original;\r\n        const rowKind = resolveEntityKind(row.kind, defaultKind);\r\n        return (\r\n          <ActualTimeCell\r\n            progressStartValue={row.in_progress_at ?? undefined}\r\n            plannedStartValue={row.start_date ?? undefined}\r\n            completedValue={p.getValue<string | null>() ?? undefined}\r\n            status={row.status}\r\n            entityKind={rowKind}\r\n          />\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: \"Тип\",\r\n      accessorKey: \"task_type\",\r\n      meta: {\r\n        width: \"clamp(4.5rem, 8vw, 6.5rem)\",\r\n        minWidth: \"4.5rem\",\r\n        maxWidth: \"6.5rem\",\r\n        cellClassName: \"whitespace-nowrap\",\r\n      },\r\n      cell: (p) => {\r\n        const value = p.getValue<string>() || \"\";\r\n        const trimmed = value.trim();\r\n        if (!trimmed) {\r\n          return \"\";\r\n        }\r\n        const badgeClass = getTypeBadgeClass(trimmed);\r\n        const className = badgeClass || `${fallbackBadgeClass} normal-case`;\r\n        return (\r\n          <span className={className} title={trimmed}>\r\n            {trimmed}\r\n          </span>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: \"Старт\",\r\n      accessorKey: \"start_location\",\r\n      meta: {\r\n        width: \"clamp(5.5rem, 14vw, 9.5rem)\",\r\n        minWidth: \"5rem\",\r\n        maxWidth: \"9.5rem\",\r\n        cellClassName: \"whitespace-nowrap\",\r\n      },\r\n      cell: ({ row }) => {\r\n        const name = row.original.start_location ?? \"\";\r\n        const trimmed = name.trim();\r\n        const firstToken = trimmed.split(/[\\s,;]+/).filter(Boolean)[0] || trimmed;\r\n        const compact = compactText(firstToken, 24);\r\n        const link = row.original.start_location_link ?? undefined;\r\n        return link ? (\r\n          <a\r\n            href={link}\r\n            target=\"_blank\"\r\n            rel=\"noopener noreferrer\"\r\n            className={locationLinkBadgeClass}\r\n            title={name}\r\n          >\r\n            <span className=\"truncate\">{compact}</span>\r\n          </a>\r\n        ) : (\r\n          <span title={name} className={locationBadgeClass}>\r\n            <span className=\"truncate\">{compact}</span>\r\n          </span>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: \"Финиш\",\r\n      accessorKey: \"end_location\",\r\n      meta: {\r\n        width: \"clamp(5.5rem, 14vw, 9.5rem)\",\r\n        minWidth: \"5rem\",\r\n        maxWidth: \"9.5rem\",\r\n        cellClassName: \"whitespace-nowrap\",\r\n      },\r\n      cell: ({ row }) => {\r\n        const name = row.original.end_location ?? \"\";\r\n        const trimmed = name.trim();\r\n        const firstToken = trimmed.split(/[\\s,;]+/).filter(Boolean)[0] || trimmed;\r\n        const compact = compactText(firstToken, 24);\r\n        const link = row.original.end_location_link ?? undefined;\r\n        return link ? (\r\n          <a\r\n            href={link}\r\n            target=\"_blank\"\r\n            rel=\"noopener noreferrer\"\r\n            className={locationLinkBadgeClass}\r\n            title={name}\r\n          >\r\n            <span className=\"truncate\">{compact}</span>\r\n          </a>\r\n        ) : (\r\n          <span title={name} className={locationBadgeClass}>\r\n            <span className=\"truncate\">{compact}</span>\r\n          </span>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: \"Км\",\r\n      accessorKey: \"route_distance_km\",\r\n      meta: {\r\n        width: \"clamp(3.25rem, 6vw, 4.75rem)\",\r\n        minWidth: \"3rem\",\r\n        maxWidth: \"4.75rem\",\r\n        cellClassName: \"whitespace-nowrap text-center sm:text-left\",\r\n        headerClassName: \"text-center sm:text-left\",\r\n      },\r\n      cell: (p) => {\r\n        const raw = p.getValue<number | string | null>();\r\n        if (raw === null || raw === undefined || (typeof raw === \"string\" && !raw.trim())) {\r\n          return \"\";\r\n        }\r\n        const display = formatDistanceLabel(raw);\r\n        if (!display) {\r\n          return \"\";\r\n        }\r\n        const badgeClass = getDistanceBadgeClass(raw);\r\n        const className = badgeClass || fallbackBadgeClass;\r\n        return (\r\n          <span className={className} title={`${display} км`}>\r\n            {display}\r\n          </span>\r\n        );\r\n      },\r\n    },\r\n  ];\r\n  return cols;\r\n}\r\n","// Назначение файла: функции расчёта и форматирования сроков задач.\r\n// Основные модули: стандартный объект Date.\r\n\r\nexport type DeadlineLevel = \"safe\" | \"warn\" | \"danger\";\r\n\r\ntype PendingIssue = \"missing-start\" | \"invalid-range\";\r\n\r\ntype InvalidReason = \"missing\" | \"invalid\";\r\n\r\nexport interface DeadlineStateBase {\r\n  dueDate: Date | null;\r\n  startDate: Date | null;\r\n  remainingMs: number | null;\r\n}\r\n\r\nexport interface CountdownState extends DeadlineStateBase {\r\n  kind: \"countdown\";\r\n  remainingMs: number;\r\n  ratio: number;\r\n  level: DeadlineLevel;\r\n}\r\n\r\nexport interface PendingState extends DeadlineStateBase {\r\n  kind: \"pending\";\r\n  remainingMs: number;\r\n  issue: PendingIssue;\r\n}\r\n\r\nexport interface OverdueState extends DeadlineStateBase {\r\n  kind: \"overdue\";\r\n  remainingMs: number;\r\n}\r\n\r\nexport interface InvalidState extends DeadlineStateBase {\r\n  kind: \"invalid\";\r\n  reason: InvalidReason;\r\n}\r\n\r\nexport type DeadlineState =\r\n  | CountdownState\r\n  | PendingState\r\n  | OverdueState\r\n  | InvalidState;\r\n\r\nconst DAY = 24 * 60 * 60 * 1000;\r\nconst HOUR = 60 * 60 * 1000;\r\nconst MINUTE = 60 * 1000;\r\n\r\nconst parseDateValue = (value?: string) => {\r\n  if (!value) {\r\n    return null;\r\n  }\r\n  const date = new Date(value);\r\n  return Number.isNaN(date.getTime()) ? null : date;\r\n};\r\n\r\nconst clampRatio = (value: number) => {\r\n  if (Number.isNaN(value)) {\r\n    return 0;\r\n  }\r\n  if (value > 1) {\r\n    return 1;\r\n  }\r\n  if (value < 0) {\r\n    return 0;\r\n  }\r\n  return value;\r\n};\r\n\r\nexport const getDeadlineState = (\r\n  startValue?: string,\r\n  dueValue?: string,\r\n  referenceDate = new Date(),\r\n): DeadlineState => {\r\n  const dueDate = parseDateValue(dueValue);\r\n  const startDate = parseDateValue(startValue);\r\n\r\n  if (!dueDate) {\r\n    return {\r\n      kind: \"invalid\",\r\n      reason: dueValue ? \"invalid\" : \"missing\",\r\n      dueDate: null,\r\n      startDate,\r\n      remainingMs: null,\r\n    };\r\n  }\r\n\r\n  const remainingMs = dueDate.getTime() - referenceDate.getTime();\r\n\r\n  if (remainingMs < 0) {\r\n    return {\r\n      kind: \"overdue\",\r\n      dueDate,\r\n      startDate,\r\n      remainingMs,\r\n    };\r\n  }\r\n\r\n  if (!startDate) {\r\n    return {\r\n      kind: \"pending\",\r\n      issue: \"missing-start\",\r\n      dueDate,\r\n      startDate: null,\r\n      remainingMs,\r\n    };\r\n  }\r\n\r\n  if (startDate.getTime() >= dueDate.getTime()) {\r\n    return {\r\n      kind: \"pending\",\r\n      issue: \"invalid-range\",\r\n      dueDate,\r\n      startDate,\r\n      remainingMs,\r\n    };\r\n  }\r\n\r\n  const totalMs = dueDate.getTime() - startDate.getTime();\r\n  const ratio = clampRatio(remainingMs / totalMs);\r\n  let level: DeadlineLevel;\r\n  if (ratio > 0.6) {\r\n    level = \"safe\";\r\n  } else if (ratio >= 0.2) {\r\n    level = \"warn\";\r\n  } else {\r\n    level = \"danger\";\r\n  }\r\n\r\n  return {\r\n    kind: \"countdown\",\r\n    ratio,\r\n    level,\r\n    dueDate,\r\n    startDate,\r\n    remainingMs,\r\n  };\r\n};\r\n\r\nexport const formatDurationShort = (value: number) => {\r\n  if (!Number.isFinite(value) || value === 0) {\r\n    return \"0м\";\r\n  }\r\n  const abs = Math.abs(value);\r\n  const parts: string[] = [];\r\n  let rest = abs;\r\n\r\n  const pushPart = (divisor: number, suffix: string) => {\r\n    const amount = Math.floor(rest / divisor);\r\n    if (amount > 0) {\r\n      parts.push(`${amount}${suffix}`);\r\n      rest -= amount * divisor;\r\n    }\r\n  };\r\n\r\n  pushPart(DAY, \"д\");\r\n  if (parts.length < 2) {\r\n    pushPart(HOUR, \"ч\");\r\n  }\r\n  if (parts.length < 2) {\r\n    pushPart(MINUTE, \"м\");\r\n  }\r\n\r\n  if (parts.length === 0) {\r\n    return \"<1м\";\r\n  }\r\n\r\n  return parts.slice(0, 2).join(\" \");\r\n};\r\n\r\n"],"names":["QuestionMarkCircleIcon","_ref","svgRef","title","titleId","props","_objectWithoutProperties","_excluded","React.createElement","Object","assign","xmlns","viewBox","fill","ref","id","fillRule","d","clipRule","users","defaultKind","arguments","length","undefined","header","accessorFn","row","rawValue","resolveEntityKind","kind","request_id","task_number","_id","String","meta","width","minWidth","maxWidth","cellClassName","headerClassName","cell","p","_ref6","_row$request_id","_ref7","_row$task_number","original","rowKind","value","getValue","trim","fallback","display","numericMatch","match","shortValue","jsx","className","concat","numberBadgeClass","children","entityWord","accessorKey","_ref8","_ref9","_row$original$created","rawCreator","created_by","createdBy","creator","creatorId","Number","NaN","isFinite","user","label","name","telegram_username","username","EmployeeLink","employeeId","stopPropagation","creatorBadgeClass","focusableBadgeClass","compactText","_row$due_date","_row$completed_at","v","compact","completionNote","buildCompletionNote","status","due_date","completed_at","jsxs","titleBadgeClass","style","WebkitLineClamp","WebkitBoxOrient","overflow","completionNoteTextClass","_ref0","ids","Array","isArray","assignees","assigned_user_id","labels","map","_users$id","_users$id2","_users$id3","tooltip","item","join","_ref1","assigneeBadgeClass","badgeClass","getStatusBadgeClass","fallbackBadgeClass","normalizePriorityLabel","getPriorityBadgeClass","renderDateCell","_row$start_date","_row$due_date2","_row$completed_at2","dueValue","countdown","DeadlineCountdownBadge","startValue","start_date","rawDue","completedAt","dateCell","_row$in_progress_at","_row$start_date2","_p$getValue","ActualTimeCell","progressStartValue","in_progress_at","plannedStartValue","completedValue","entityKind","trimmed","getTypeBadgeClass","_ref10","_row$original$start_l","_row$original$start_l2","start_location","firstToken","split","filter","Boolean","link","start_location_link","href","target","rel","locationLinkBadgeClass","locationBadgeClass","_ref11","_row$original$end_loc","_row$original$end_loc2","end_location","end_location_link","raw","formatDistanceLabel","getDistanceBadgeClass","ForwardRef","React.forwardRef","parseDateValue","date","Date","isNaN","getTime","getDeadlineState","referenceDate","dueDate","startDate","reason","remainingMs","issue","totalMs","ratio","level","badgeBaseClass","badgeTextClass","buildBadgeClass","tones","pillBadgeBaseClass","dateBadgeClass","exports","statusBadgeClassMap","Новая","Выполнена","Отменена","urgentPriorityBadgeClass","highPriorityBadgeClass","normalPriorityBadgeClass","lowPriorityBadgeClass","priorityBadgeClassMap","срочно","hasOwn","obj","key","prototype","hasOwnProperty","call","normalized","toLowerCase","test","typeBadgeClassMap","доставить","купить","выполнить","построить","починить","parseDistance","replace","numeric","toLocaleString","maximumFractionDigits","minimumFractionDigits","toString","shortDistanceBadgeClass","mediumDistanceBadgeClass","longDistanceBadgeClass","extraLongDistanceBadgeClass","fullDateTimeFmt","Intl","DateTimeFormat","day","month","year","hour","minute","hour12","timeZone","PROJECT_TIMEZONE","datePartFmt","timePartFmt","parseDateInput","formatDate","full","format","PROJECT_TIMEZONE_LABEL","time","formatted","dateTime","maxLength","shortened","slice","trimEnd","ENTITY_WORDS","task","nominative","accusative","genitive","request","form","options","base","lower","countdownBadgeBaseClass","countdownToneClassMap","safe","warn","danger","overdue","pending","neutralCountdownBadgeClass","formatCountdownParts","absValue","Math","abs","totalMinutes","max","floor","days","hours","minutes","pad","padStart","paddedDays","paddedHours","paddedMinutes","getRussianPlural","forms","lastDigit","getCountdownToneKey","state","buildCountdownLabel","_formatCountdownParts","buildCountdownTitle","note","completedDate","diff","offset","diffMs","_formatCountdownParts2","parts","push","formatCompletionOffset","_ref2","React","useMemo","isCompleted","_React$useState2","_slicedToArray","useState","now","setNow","useEffect","update","timer","window","setInterval","clearInterval","toneKey","durationToneClassMap","completed","cancelled","active","planned","idle","formatDurationPhrase","variant","dayLabel","hourLabel","minuteLabel","phrase","buildDurationTitle","endValue","titleParts","startFormatted","endFormatted","RegExp","_ref3","_ref5","plannedStartDate","progressStartDate","isFinished","isCancelled","isNotStarted","timerStartDate","_ref4","_React$useState4","setReferenceDate","effectiveEndDate","durationMs","durationParts","endIso","toISOString","startValueForTooltip","durationBadgeTitle","placeholder","renderStopBadge"],"mappings":"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","x_google_ignoreList":[0]}