{"version":3,"file":"collections-D369OXTN.js","sources":["../../../web/src/services/collections.ts"],"sourcesContent":["// Назначение: запросы к API универсальных коллекций\n// Основные модули: authFetch, i18n\nimport i18n from '../i18n';\nimport authFetch from '../utils/authFetch';\n\nexport interface CollectionItemMeta {\n  invalid?: boolean;\n  invalidReason?: string;\n  invalidCode?: string;\n  invalidAt?: string;\n  syncPending?: boolean;\n  syncWarning?: string;\n  syncError?: string;\n  syncFailedAt?: string;\n  legacy?: boolean;\n  readonly?: boolean;\n  readonlyReason?: string;\n  source?: string;\n  sourceId?: string;\n  fleetId?: string;\n  departmentId?: string;\n  divisionId?: string;\n  positionId?: string;\n  defaultLabel?: string;\n  fieldType?: string;\n  required?: boolean;\n  order?: number;\n  virtual?: boolean;\n  address?: string;\n  latitude?: number;\n  longitude?: number;\n  location?: { lat?: number; lng?: number };\n  tg_theme_url?: string;\n  tg_chat_id?: string;\n  tg_topic_id?: number;\n  tg_photos_url?: string;\n  tg_photos_chat_id?: string;\n  tg_photos_topic_id?: number;\n  [key: string]: unknown;\n}\n\nexport interface CollectionItem {\n  _id: string;\n  type: string;\n  name: string;\n  value: string;\n  meta?: CollectionItemMeta;\n}\n\nexport interface CollectionObjectMeta extends CollectionItemMeta {\n  address?: string;\n  latitude?: number;\n  longitude?: number;\n  location?: { lat?: number; lng?: number };\n}\n\nexport interface CollectionObject extends CollectionItem {\n  address: string;\n  latitude?: number;\n  longitude?: number;\n  meta?: CollectionObjectMeta;\n}\n\nexport type CollectionObjectPayload = {\n  name: string;\n  address: string;\n  latitude?: number;\n  longitude?: number;\n};\n\ntype ProblemValidationError = {\n  msg?: string;\n  message?: string;\n  [key: string]: unknown;\n};\n\ntype ProblemResponse = {\n  error?: string;\n  detail?: unknown;\n  message?: string;\n  errors?: ProblemValidationError[];\n};\n\ntype ParseErrorOptions = {\n  collectionType?: string;\n};\n\nconst validationMessageKeys: Record<string, string> = {\n  'Некорректный тип коллекции': 'collections.errors.invalidType',\n  'Тип коллекции обязателен': 'collections.errors.typeRequired',\n  'Некорректное название элемента': 'collections.errors.invalidName',\n  'Название элемента обязательно': 'collections.errors.nameRequired',\n  'Некорректное значение элемента': 'collections.errors.invalidValue',\n  'Значение элемента обязательно': 'collections.errors.valueRequired',\n  'Значение элемента не может быть пустым': 'collections.errors.valueRequired',\n  'Ошибка валидации': 'collections.errors.generalValidation',\n  'Ссылка на тему Telegram должна иметь формат https://t.me/c/<id>/<topic>':\n    'collections.errors.invalidTelegramTopicUrl',\n};\n\nconst typeSpecificValidationKeys: Record<string, Record<string, string>> = {\n  departments: {\n    'Значение элемента обязательно':\n      'collections.errors.departmentsMustHaveDivisions',\n  },\n};\n\nconst tryParseJson = (raw: string): unknown => {\n  try {\n    return JSON.parse(raw);\n  } catch {\n    return undefined;\n  }\n};\n\nconst translateValidationMessage = (\n  raw: string | undefined,\n  options?: ParseErrorOptions,\n): string => {\n  if (!raw) return '';\n  const trimmed = raw.trim();\n  if (!trimmed) return '';\n  const collectionType = options?.collectionType;\n  const specificKey =\n    collectionType && typeSpecificValidationKeys[collectionType]?.[trimmed];\n  const key = specificKey ?? validationMessageKeys[trimmed];\n  if (key) return i18n.t(key);\n  return trimmed;\n};\n\nconst translateValidationErrors = (\n  errors: ProblemValidationError[] | undefined,\n  options?: ParseErrorOptions,\n): string[] => {\n  if (!errors?.length) return [];\n  const translated = errors\n    .map((error) => {\n      const base =\n        typeof error?.msg === 'string'\n          ? error.msg\n          : typeof error?.message === 'string'\n            ? error.message\n            : '';\n      return translateValidationMessage(base, options);\n    })\n    .filter(Boolean);\n  if (translated.length) return translated;\n  return [i18n.t('collections.errors.generalValidation')];\n};\n\nconst extractMessagesFromPayload = (\n  payload: unknown,\n  options?: ParseErrorOptions,\n): string[] => {\n  if (!payload) return [];\n  if (Array.isArray(payload)) {\n    const asErrors = payload.filter((item): item is ProblemValidationError =>\n      Boolean(item && typeof item === 'object' && 'msg' in item),\n    );\n    if (asErrors.length) return translateValidationErrors(asErrors, options);\n    const directStrings = payload\n      .map((item) =>\n        typeof item === 'string'\n          ? translateValidationMessage(item, options)\n          : '',\n      )\n      .filter(Boolean);\n    if (directStrings.length) return directStrings;\n  }\n  if (typeof payload === 'string') {\n    const parsed = tryParseJson(payload);\n    if (parsed !== undefined) {\n      const nested = extractMessagesFromPayload(parsed, options);\n      if (nested.length) return nested;\n    }\n    const translated = translateValidationMessage(payload, options);\n    return translated ? [translated] : [];\n  }\n  return [];\n};\n\nexport const parseErrorMessage = (\n  status: number,\n  body: string,\n  options?: ParseErrorOptions,\n): string => {\n  const fallback =\n    status === 429\n      ? i18n.t('collections.fallback.rateLimited')\n      : status === 403\n        ? i18n.t('collections.fallback.forbidden')\n        : i18n.t('collections.fallback.loadFailed');\n\n  if (body) {\n    const parsed = tryParseJson(body) as ProblemResponse | undefined;\n    if (parsed) {\n      const errorMessages = translateValidationErrors(parsed.errors, options);\n      if (errorMessages.length) {\n        return Array.from(new Set(errorMessages)).join('. ');\n      }\n      const detailMessages = extractMessagesFromPayload(parsed.detail, options);\n      if (detailMessages.length) {\n        return Array.from(new Set(detailMessages)).join('. ');\n      }\n      const generalMessage =\n        translateValidationMessage(parsed.error, options) ||\n        translateValidationMessage(parsed.message, options);\n      if (generalMessage) return generalMessage;\n    } else {\n      const translated = translateValidationMessage(body, options);\n      if (translated) return translated;\n    }\n  }\n\n  return fallback;\n};\n\nconst normalizeCoordinate = (value: unknown): number | undefined => {\n  const numeric =\n    typeof value === 'string'\n      ? Number.parseFloat(value)\n      : typeof value === 'number'\n        ? value\n        : Number.NaN;\n  return Number.isFinite(numeric) ? numeric : undefined;\n};\n\nconst buildObjectMeta = (\n  address: string,\n  latitude?: number,\n  longitude?: number,\n): CollectionObjectMeta | undefined => {\n  const meta: CollectionObjectMeta = {};\n  if (address) {\n    meta.address = address;\n  }\n  if (latitude !== undefined || longitude !== undefined) {\n    meta.location = { lat: latitude, lng: longitude };\n  }\n  if (latitude !== undefined) {\n    meta.latitude = latitude;\n  }\n  if (longitude !== undefined) {\n    meta.longitude = longitude;\n  }\n  return Object.keys(meta).length ? meta : undefined;\n};\n\nexport const toCollectionObject = (item: CollectionItem): CollectionObject => {\n  const meta = (item.meta ?? {}) as CollectionObjectMeta;\n  const address =\n    typeof meta.address === 'string' && meta.address.trim().length\n      ? meta.address.trim()\n      : item.value.trim();\n  const latitude =\n    normalizeCoordinate(meta.latitude ?? meta.location?.lat) ?? undefined;\n  const longitude =\n    normalizeCoordinate(meta.longitude ?? meta.location?.lng) ?? undefined;\n  return {\n    ...item,\n    address,\n    latitude,\n    longitude,\n    meta,\n  };\n};\n\nexport const fetchCollectionItems = async (\n  type: string,\n  search = '',\n  page = 1,\n  limit = 10,\n) => {\n  const res = await authFetch(\n    `/api/v1/collections?type=${type}&page=${page}&limit=${limit}${search ? `&search=${encodeURIComponent(search)}` : ''}`,\n  );\n  if (!res.ok) {\n    const body = await res.text().catch(() => '');\n    throw new Error(\n      parseErrorMessage(res.status, body, { collectionType: type }),\n    );\n  }\n  return res.json();\n};\n\nconst isFiniteNumber = (value: unknown): value is number =>\n  typeof value === 'number' && Number.isFinite(value);\n\nexport const fetchAllCollectionItems = async (\n  type: string,\n  search = '',\n  limit = 200,\n): Promise<CollectionItem[]> => {\n  const effectiveLimit = limit > 0 ? limit : 200;\n  const aggregated: CollectionItem[] = [];\n  let page = 1;\n  let expectedTotal = 0;\n  // ограничиваем количество итераций, чтобы избежать бесконечных циклов при ошибках пагинации\n  const maxIterations = 100;\n  while (page <= maxIterations) {\n    const response = (await fetchCollectionItems(\n      type,\n      search,\n      page,\n      effectiveLimit,\n    )) as { items?: CollectionItem[]; total?: number };\n    const items = Array.isArray(response.items) ? response.items : [];\n    if (\n      !items.length &&\n      aggregated.length === 0 &&\n      !isFiniteNumber(response.total)\n    ) {\n      return [];\n    }\n    aggregated.push(...items);\n    if (isFiniteNumber(response.total)) {\n      expectedTotal = Math.max(expectedTotal, response.total);\n    }\n    if (items.length < effectiveLimit) {\n      break;\n    }\n    if (expectedTotal && aggregated.length >= expectedTotal) {\n      break;\n    }\n    page += 1;\n  }\n  if (expectedTotal && aggregated.length > expectedTotal) {\n    return aggregated.slice(0, expectedTotal);\n  }\n  return aggregated;\n};\n\nexport const fetchCollectionObjects = async (\n  search = '',\n  page = 1,\n  limit = 10,\n): Promise<{ items: CollectionObject[]; total: number }> => {\n  const response = (await fetchCollectionItems(\n    'objects',\n    search,\n    page,\n    limit,\n  )) as { items?: CollectionItem[]; total?: number };\n  const items = Array.isArray(response.items)\n    ? response.items.map(toCollectionObject)\n    : [];\n  return { items, total: response.total ?? items.length };\n};\n\nexport const fetchAllCollectionObjects = async (\n  search = '',\n  limit = 200,\n): Promise<CollectionObject[]> => {\n  const items = await fetchAllCollectionItems('objects', search, limit);\n  return items.map(toCollectionObject);\n};\n\nexport const createCollectionItem = (\n  type: string,\n  data: { name: string; value: string; meta?: Record<string, unknown> },\n) =>\n  authFetch('/api/v1/collections', {\n    method: 'POST',\n    confirmed: true,\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ type, ...data }),\n  }).then(async (r) => {\n    if (!r.ok) {\n      const body = await r.text().catch(() => '');\n      throw new Error(\n        parseErrorMessage(r.status, body, { collectionType: type }),\n      );\n    }\n    return r.json();\n  });\n\nexport const updateCollectionItem = (\n  id: string,\n  data: { name?: string; value?: string; meta?: Record<string, unknown> },\n  options?: ParseErrorOptions,\n) =>\n  authFetch(`/api/v1/collections/${id}`, {\n    method: 'PUT',\n    confirmed: true,\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(data),\n  }).then(async (r) => {\n    if (!r.ok) {\n      const body = await r.text().catch(() => '');\n      throw new Error(parseErrorMessage(r.status, body, options));\n    }\n    return r.json();\n  });\n\nexport const removeCollectionItem = async (id: string) => {\n  const r = await authFetch(`/api/v1/collections/${id}`, {\n    method: 'DELETE',\n    confirmed: true,\n  });\n  if (!r.ok) {\n    const body = await r.text().catch(() => '');\n    throw new Error(parseErrorMessage(r.status, body));\n  }\n  return r.json();\n};\n\nconst buildObjectPayload = (\n  data: CollectionObjectPayload,\n): { name: string; value: string; meta?: CollectionObjectMeta } => {\n  const trimmedAddress = data.address.trim();\n  const latitude = normalizeCoordinate(data.latitude);\n  const longitude = normalizeCoordinate(data.longitude);\n  const meta = buildObjectMeta(trimmedAddress, latitude, longitude);\n  return {\n    name: data.name.trim(),\n    value: trimmedAddress,\n    meta,\n  };\n};\n\nexport const createCollectionObject = (payload: CollectionObjectPayload) =>\n  createCollectionItem('objects', buildObjectPayload(payload));\n\nexport const updateCollectionObject = (\n  id: string,\n  payload: CollectionObjectPayload,\n) =>\n  updateCollectionItem(id, buildObjectPayload(payload), {\n    collectionType: 'objects',\n  });\n\nexport const removeCollectionObject = (id: string) => removeCollectionItem(id);\n"],"names":["validationMessageKeys","typeSpecificValidationKeys","tryParseJson","raw","translateValidationMessage","options","trimmed","collectionType","specificKey","_a","key","i18n","translateValidationErrors","errors","translated","error","base","extractMessagesFromPayload","payload","asErrors","item","directStrings","parsed","nested","parseErrorMessage","status","body","fallback","errorMessages","detailMessages","generalMessage","normalizeCoordinate","value","numeric","toCollectionObject","meta","address","latitude","_d","_c","_b","longitude","_g","_f","_e","fetchCollectionItems","type","search","page","limit","res","authFetch","isFiniteNumber","fetchAllCollectionItems","effectiveLimit","aggregated","expectedTotal","maxIterations","response","items","fetchCollectionObjects","createCollectionItem","data","r","updateCollectionItem","id","removeCollectionItem"],"mappings":"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"}