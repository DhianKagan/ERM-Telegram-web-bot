{"version":3,"file":"taskColumns-Ca4qs_dU.js","sources":["../../../../node_modules/.pnpm/@heroicons+react@2.2.0_react@18.2.0/node_modules/@heroicons/react/20/solid/esm/QuestionMarkCircleIcon.js","../../../web/src/columns/taskDeadline.ts","../../../web/src/columns/taskColumns.tsx"],"sourcesContent":["import * as React from \"react\";\nfunction QuestionMarkCircleIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 20 20\",\n    fill: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M18 10a8 8 0 1 1-16 0 8 8 0 0 1 16 0ZM8.94 6.94a.75.75 0 1 1-1.061-1.061 3 3 0 1 1 2.871 5.026v.345a.75.75 0 0 1-1.5 0v-.5c0-.72.57-1.172 1.081-1.287A1.5 1.5 0 1 0 8.94 6.94ZM10 15a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z\",\n    clipRule: \"evenodd\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(QuestionMarkCircleIcon);\nexport default ForwardRef;","// Назначение файла: функции расчёта и форматирования сроков задач.\r\n// Основные модули: стандартный объект Date.\r\n\r\nexport type DeadlineLevel = \"safe\" | \"warn\" | \"danger\";\r\n\r\ntype PendingIssue = \"missing-start\" | \"invalid-range\";\r\n\r\ntype InvalidReason = \"missing\" | \"invalid\";\r\n\r\nexport interface DeadlineStateBase {\r\n  dueDate: Date | null;\r\n  startDate: Date | null;\r\n  remainingMs: number | null;\r\n}\r\n\r\nexport interface CountdownState extends DeadlineStateBase {\r\n  kind: \"countdown\";\r\n  remainingMs: number;\r\n  ratio: number;\r\n  level: DeadlineLevel;\r\n}\r\n\r\nexport interface PendingState extends DeadlineStateBase {\r\n  kind: \"pending\";\r\n  remainingMs: number;\r\n  issue: PendingIssue;\r\n}\r\n\r\nexport interface OverdueState extends DeadlineStateBase {\r\n  kind: \"overdue\";\r\n  remainingMs: number;\r\n}\r\n\r\nexport interface InvalidState extends DeadlineStateBase {\r\n  kind: \"invalid\";\r\n  reason: InvalidReason;\r\n}\r\n\r\nexport type DeadlineState =\r\n  | CountdownState\r\n  | PendingState\r\n  | OverdueState\r\n  | InvalidState;\r\n\r\nconst DAY = 24 * 60 * 60 * 1000;\r\nconst HOUR = 60 * 60 * 1000;\r\nconst MINUTE = 60 * 1000;\r\n\r\nconst parseDateValue = (value?: string) => {\r\n  if (!value) {\r\n    return null;\r\n  }\r\n  const date = new Date(value);\r\n  return Number.isNaN(date.getTime()) ? null : date;\r\n};\r\n\r\nconst clampRatio = (value: number) => {\r\n  if (Number.isNaN(value)) {\r\n    return 0;\r\n  }\r\n  if (value > 1) {\r\n    return 1;\r\n  }\r\n  if (value < 0) {\r\n    return 0;\r\n  }\r\n  return value;\r\n};\r\n\r\nexport const getDeadlineState = (\r\n  startValue?: string,\r\n  dueValue?: string,\r\n  referenceDate = new Date(),\r\n): DeadlineState => {\r\n  const dueDate = parseDateValue(dueValue);\r\n  const startDate = parseDateValue(startValue);\r\n\r\n  if (!dueDate) {\r\n    return {\r\n      kind: \"invalid\",\r\n      reason: dueValue ? \"invalid\" : \"missing\",\r\n      dueDate: null,\r\n      startDate,\r\n      remainingMs: null,\r\n    };\r\n  }\r\n\r\n  const remainingMs = dueDate.getTime() - referenceDate.getTime();\r\n\r\n  if (remainingMs < 0) {\r\n    return {\r\n      kind: \"overdue\",\r\n      dueDate,\r\n      startDate,\r\n      remainingMs,\r\n    };\r\n  }\r\n\r\n  if (!startDate) {\r\n    return {\r\n      kind: \"pending\",\r\n      issue: \"missing-start\",\r\n      dueDate,\r\n      startDate: null,\r\n      remainingMs,\r\n    };\r\n  }\r\n\r\n  if (startDate.getTime() >= dueDate.getTime()) {\r\n    return {\r\n      kind: \"pending\",\r\n      issue: \"invalid-range\",\r\n      dueDate,\r\n      startDate,\r\n      remainingMs,\r\n    };\r\n  }\r\n\r\n  const totalMs = dueDate.getTime() - startDate.getTime();\r\n  const ratio = clampRatio(remainingMs / totalMs);\r\n  let level: DeadlineLevel;\r\n  if (ratio > 0.6) {\r\n    level = \"safe\";\r\n  } else if (ratio >= 0.2) {\r\n    level = \"warn\";\r\n  } else {\r\n    level = \"danger\";\r\n  }\r\n\r\n  return {\r\n    kind: \"countdown\",\r\n    ratio,\r\n    level,\r\n    dueDate,\r\n    startDate,\r\n    remainingMs,\r\n  };\r\n};\r\n\r\nexport const formatDurationShort = (value: number) => {\r\n  if (!Number.isFinite(value) || value === 0) {\r\n    return \"0м\";\r\n  }\r\n  const abs = Math.abs(value);\r\n  const parts: string[] = [];\r\n  let rest = abs;\r\n\r\n  const pushPart = (divisor: number, suffix: string) => {\r\n    const amount = Math.floor(rest / divisor);\r\n    if (amount > 0) {\r\n      parts.push(`${amount}${suffix}`);\r\n      rest -= amount * divisor;\r\n    }\r\n  };\r\n\r\n  pushPart(DAY, \"д\");\r\n  if (parts.length < 2) {\r\n    pushPart(HOUR, \"ч\");\r\n  }\r\n  if (parts.length < 2) {\r\n    pushPart(MINUTE, \"м\");\r\n  }\r\n\r\n  if (parts.length === 0) {\r\n    return \"<1м\";\r\n  }\r\n\r\n  return parts.slice(0, 2).join(\" \");\r\n};\r\n\r\n","// Конфигурация колонок задач для React Table\r\n// Модули: React, @tanstack/react-table, heroicons, EmployeeLink\r\nimport React from \"react\";\r\nimport type { ColumnDef } from \"@tanstack/react-table\";\r\nimport { PROJECT_TIMEZONE, PROJECT_TIMEZONE_LABEL, type Task } from \"shared\";\r\nimport { QuestionMarkCircleIcon } from \"@heroicons/react/20/solid\";\r\nimport EmployeeLink from \"../components/EmployeeLink\";\r\nimport { getDeadlineState, type DeadlineState } from \"./taskDeadline\";\r\nimport type { User as AppUser } from \"../types/user\";\r\n\r\n// Оформление бейджей статусов и приоритетов на дизайн-токенах\r\nconst badgeBaseClass =\r\n  \"inline-flex min-w-0 items-center gap-0.5 whitespace-nowrap rounded-full px-1.5 py-0.5 text-center text-[0.66rem] font-semibold uppercase tracking-wide shadow-xs\";\r\nconst badgeTextClass = \"text-black dark:text-white\";\r\n\r\nconst buildBadgeClass = (tones: string, extraClass = \"\") =>\r\n  [badgeBaseClass, \"transition-colors\", badgeTextClass, extraClass, tones]\r\n    .filter(Boolean)\r\n    .join(\" \");\r\n\r\nconst focusableBadgeClass =\r\n  \"focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background\";\r\n\r\nconst pillBadgeBaseClass =\r\n  \"inline-flex max-w-full min-w-0 items-center gap-0.5 whitespace-nowrap rounded-full px-1.5 py-0.5 text-left text-[0.7rem] font-semibold leading-tight tracking-normal shadow-xs sm:px-1.5 sm:text-[0.76rem]\";\r\n\r\nconst dateBadgeClass =\r\n  `${pillBadgeBaseClass} font-mono normal-case ${badgeTextClass} ring-1 ring-slate-500/30 bg-slate-500/10 dark:bg-slate-500/20 dark:ring-slate-400/30`;\r\n\r\nconst dateBadgeTimeClass =\r\n  \"text-[0.65rem] font-semibold text-slate-500 dark:text-slate-200\";\r\n\r\nconst numberBadgeClass =\r\n  `${pillBadgeBaseClass} justify-center font-mono uppercase tracking-[0.18em] text-[0.68rem] ${badgeTextClass} ring-1 ring-slate-500/30 bg-slate-500/10 dark:bg-slate-500/20 dark:ring-slate-400/30`;\r\n\r\nconst titleBadgeClass =\r\n  `${pillBadgeBaseClass} justify-start normal-case ${badgeTextClass} ring-1 ring-indigo-500/40 bg-indigo-500/15 dark:bg-indigo-400/25 dark:ring-indigo-300/45`;\r\n\r\nexport const creatorBadgeClass =\r\n  `${pillBadgeBaseClass} w-full max-w-full justify-start normal-case ${badgeTextClass} ring-1 ring-blue-500/40 bg-blue-500/15 dark:bg-blue-400/20 dark:ring-blue-300/45`;\r\n\r\nconst assigneeBadgeClass =\r\n  `${pillBadgeBaseClass} normal-case ${badgeTextClass} ring-1 ring-violet-500/35 bg-violet-500/20 dark:bg-violet-400/30 dark:ring-violet-300/45`;\r\n\r\nexport const fallbackBadgeClass = buildBadgeClass(\r\n  \"bg-muted/60 ring-1 ring-muted-foreground/30 dark:bg-slate-700/60 dark:ring-slate-500/35\",\r\n);\r\n\r\nconst locationBadgeClass =\r\n  `${pillBadgeBaseClass} normal-case ${badgeTextClass} ring-1 ring-emerald-500/30 bg-emerald-500/15 dark:bg-emerald-400/20 dark:ring-emerald-300/30`;\r\n\r\nconst locationLinkBadgeClass =\r\n  `${locationBadgeClass} ${focusableBadgeClass} no-underline underline-offset-4 hover:underline`;\r\n\r\nconst statusBadgeClassMap: Record<Task[\"status\"], string> = {\r\n  Новая: buildBadgeClass(\r\n    \"bg-sky-500/20 ring-1 ring-sky-500/45 dark:bg-sky-400/25 dark:ring-sky-300/45\",\r\n  ),\r\n  \"В работе\": buildBadgeClass(\r\n    \"bg-amber-500/25 ring-1 ring-amber-500/45 dark:bg-amber-400/25 dark:ring-amber-300/45\",\r\n  ),\r\n  Выполнена: buildBadgeClass(\r\n    \"bg-emerald-500/20 ring-1 ring-emerald-500/40 dark:bg-emerald-400/25 dark:ring-emerald-300/45\",\r\n  ),\r\n  Отменена: buildBadgeClass(\r\n    \"bg-rose-500/20 ring-1 ring-rose-500/40 dark:bg-rose-400/25 dark:ring-rose-300/45\",\r\n  ),\r\n};\r\n\r\nconst urgentPriorityBadgeClass = buildBadgeClass(\r\n  \"bg-accent/80 ring-1 ring-destructive/40 dark:bg-accent/60 dark:ring-destructive/40\",\r\n);\r\n\r\nconst highPriorityBadgeClass = buildBadgeClass(\r\n  \"bg-accent/75 ring-1 ring-primary/40 dark:bg-accent/55 dark:ring-primary/40\",\r\n);\r\n\r\nconst normalPriorityBadgeClass = buildBadgeClass(\r\n  \"bg-accent/65 ring-1 ring-primary/30 dark:bg-accent/45 dark:ring-primary/30\",\r\n);\r\n\r\nconst lowPriorityBadgeClass = buildBadgeClass(\r\n  \"bg-accent/50 ring-1 ring-primary/20 dark:bg-accent/35 dark:ring-primary/20\",\r\n);\r\n\r\nconst priorityBadgeClassMap: Record<string, string> = {\r\n  срочно: buildBadgeClass(\r\n    \"bg-rose-500/20 ring-1 ring-rose-500/40 dark:bg-rose-400/25 dark:ring-rose-300/45\",\r\n  ),\r\n  'в течение дня': buildBadgeClass(\r\n    \"bg-sky-500/20 ring-1 ring-sky-500/40 dark:bg-sky-400/25 dark:ring-sky-300/45\",\r\n  ),\r\n  'до выполнения': buildBadgeClass(\r\n    \"bg-slate-500/25 ring-1 ring-slate-500/45 dark:bg-slate-400/25 dark:ring-slate-300/45\",\r\n    \"normal-case\",\r\n  ),\r\n};\r\n\r\nconst hasOwn = <T extends Record<PropertyKey, unknown>>(obj: T, key: PropertyKey): key is keyof T =>\r\n  Object.prototype.hasOwnProperty.call(obj, key);\r\n\r\nexport const getStatusBadgeClass = (value: string) => {\r\n  if (hasOwn(statusBadgeClassMap, value)) {\r\n    return statusBadgeClassMap[value];\r\n  }\r\n  return null;\r\n};\r\n\r\nexport const getPriorityBadgeClass = (value: string) => {\r\n  const normalized = value.trim().toLowerCase();\r\n  if (!normalized) {\r\n    return null;\r\n  }\r\n  if (hasOwn(priorityBadgeClassMap, normalized)) {\r\n    return priorityBadgeClassMap[normalized];\r\n  }\r\n  if (/сроч|urgent/.test(normalized)) {\r\n    return urgentPriorityBadgeClass;\r\n  }\r\n  if (/высок|повыш|high/.test(normalized)) {\r\n    return highPriorityBadgeClass;\r\n  }\r\n  if (/низк|бесср|без\\s+срок|до\\s+выполн|low|minor/.test(normalized)) {\r\n    return lowPriorityBadgeClass;\r\n  }\r\n  if (/обыч|дня|сутк|norm|stand/.test(normalized)) {\r\n    return normalPriorityBadgeClass;\r\n  }\r\n  return null;\r\n};\r\n\r\nconst normalizePriorityLabel = (value: string) => {\r\n  const trimmed = value.trim();\r\n  if (!trimmed) {\r\n    return trimmed;\r\n  }\r\n  if (/^бессроч/i.test(trimmed)) {\r\n    return \"До выполнения\";\r\n  }\r\n  return trimmed;\r\n};\r\n\r\nconst completionNoteTextClass =\r\n  \"text-[11px] font-medium text-slate-600 dark:text-slate-300\";\r\n\r\nconst typeBadgeClassMap: Record<string, string> = {\r\n  доставить: buildBadgeClass(\r\n    \"bg-sky-500/20 ring-1 ring-sky-500/40 dark:bg-sky-400/25 dark:ring-sky-300/45\",\r\n  ),\r\n  купить: buildBadgeClass(\r\n    \"bg-violet-500/20 ring-1 ring-violet-500/40 dark:bg-violet-400/25 dark:ring-violet-300/45\",\r\n  ),\r\n  выполнить: buildBadgeClass(\r\n    \"bg-emerald-500/20 ring-1 ring-emerald-500/40 dark:bg-emerald-400/25 dark:ring-emerald-300/45\",\r\n  ),\r\n  построить: buildBadgeClass(\r\n    \"bg-amber-500/25 ring-1 ring-amber-500/45 dark:bg-amber-400/25 dark:ring-amber-300/45\",\r\n  ),\r\n  починить: buildBadgeClass(\r\n    \"bg-orange-500/20 ring-1 ring-orange-500/40 dark:bg-orange-400/25 dark:ring-orange-300/45\",\r\n  ),\r\n};\r\n\r\nexport const getTypeBadgeClass = (value: string) => {\r\n  const normalized = value.trim().toLowerCase();\r\n  if (!normalized) {\r\n    return null;\r\n  }\r\n  if (hasOwn(typeBadgeClassMap, normalized)) {\r\n    return typeBadgeClassMap[normalized];\r\n  }\r\n  if (/стро|монтаж/.test(normalized)) {\r\n    return typeBadgeClassMap['построить'];\r\n  }\r\n  if (/ремонт|чин/.test(normalized)) {\r\n    return typeBadgeClassMap['починить'];\r\n  }\r\n  if (/закуп|покуп|приобр/.test(normalized)) {\r\n    return typeBadgeClassMap['купить'];\r\n  }\r\n  if (/достав|курьер/.test(normalized)) {\r\n    return typeBadgeClassMap['доставить'];\r\n  }\r\n  if (/исполн|выполн/.test(normalized)) {\r\n    return typeBadgeClassMap['выполнить'];\r\n  }\r\n  return null;\r\n};\r\n\r\nconst parseDistance = (value: unknown) => {\r\n  if (typeof value === \"number\") {\r\n    return Number.isFinite(value) ? value : null;\r\n  }\r\n  if (typeof value === \"string\") {\r\n    const trimmed = value.trim();\r\n    if (!trimmed) {\r\n      return null;\r\n    }\r\n    const normalized = Number(trimmed.replace(/\\s+/g, \"\").replace(/,/g, \".\"));\r\n    return Number.isFinite(normalized) ? normalized : null;\r\n  }\r\n  return null;\r\n};\r\n\r\nconst formatDistanceLabel = (value: unknown) => {\r\n  const numeric = parseDistance(value);\r\n  if (numeric !== null) {\r\n    return numeric.toLocaleString(\"ru-RU\", {\r\n      maximumFractionDigits: 2,\r\n      minimumFractionDigits: 2,\r\n    });\r\n  }\r\n  if (typeof value === \"string\") {\r\n    return value.trim();\r\n  }\r\n  if (typeof value === \"number\") {\r\n    return value.toString();\r\n  }\r\n  return \"\";\r\n};\r\n\r\nconst shortDistanceBadgeClass = buildBadgeClass(\r\n  \"bg-emerald-500/20 ring-1 ring-emerald-500/40 dark:bg-emerald-400/25 dark:ring-emerald-300/45\",\r\n);\r\n\r\nconst mediumDistanceBadgeClass = buildBadgeClass(\r\n  \"bg-sky-500/20 ring-1 ring-sky-500/40 dark:bg-sky-400/25 dark:ring-sky-300/45\",\r\n);\r\n\r\nconst longDistanceBadgeClass = buildBadgeClass(\r\n  \"bg-amber-500/25 ring-1 ring-amber-500/45 dark:bg-amber-400/25 dark:ring-amber-300/45\",\r\n);\r\n\r\nconst extraLongDistanceBadgeClass = buildBadgeClass(\r\n  \"bg-rose-500/20 ring-1 ring-rose-500/40 dark:bg-rose-400/25 dark:ring-rose-300/45\",\r\n);\r\n\r\nconst getDistanceBadgeClass = (value: unknown) => {\r\n  const numeric = parseDistance(value);\r\n  if (numeric === null) {\r\n    return null;\r\n  }\r\n  if (numeric < 5) {\r\n    return shortDistanceBadgeClass;\r\n  }\r\n  if (numeric < 25) {\r\n    return mediumDistanceBadgeClass;\r\n  }\r\n  if (numeric < 100) {\r\n    return longDistanceBadgeClass;\r\n  }\r\n  return extraLongDistanceBadgeClass;\r\n};\r\n\r\nconst fullDateTimeFmt = new Intl.DateTimeFormat(\"ru-RU\", {\r\n  day: \"2-digit\",\r\n  month: \"2-digit\",\r\n  year: \"numeric\",\r\n  hour: \"2-digit\",\r\n  minute: \"2-digit\",\r\n  hour12: false,\r\n  timeZone: PROJECT_TIMEZONE,\r\n});\r\n\r\nconst datePartFmt = new Intl.DateTimeFormat(\"ru-RU\", {\r\n  day: \"2-digit\",\r\n  month: \"2-digit\",\r\n  year: \"numeric\",\r\n  timeZone: PROJECT_TIMEZONE,\r\n});\r\n\r\nconst timePartFmt = new Intl.DateTimeFormat(\"ru-RU\", {\r\n  hour: \"2-digit\",\r\n  minute: \"2-digit\",\r\n  hour12: false,\r\n  timeZone: PROJECT_TIMEZONE,\r\n});\r\n\r\nconst parseDateInput = (value?: string | null) => {\r\n  if (!value) {\r\n    return null;\r\n  }\r\n  const date = new Date(value);\r\n  return Number.isNaN(date.getTime()) ? null : date;\r\n};\r\n\r\nconst formatDate = (value?: string) => {\r\n  const date = parseDateInput(value);\r\n  if (!date) return null;\r\n  const full = `${fullDateTimeFmt.format(date).replace(\", \", \" \")} ${PROJECT_TIMEZONE_LABEL}`;\r\n  const datePart = datePartFmt.format(date);\r\n  const timePart = timePartFmt.format(date);\r\n  return {\r\n    full,\r\n    date: datePart || full,\r\n    time: timePart,\r\n  };\r\n};\r\n\r\nconst renderDateCell = (value?: string) => {\r\n  const formatted = formatDate(value);\r\n  if (!formatted) return \"\";\r\n  return (\r\n    <span className={dateBadgeClass} title={formatted.full}>\r\n      <time\r\n        dateTime={value}\r\n        className=\"flex w-full items-baseline gap-1 truncate tabular-nums\"\r\n      >\r\n        <span className=\"truncate\">{formatted.date}</span>\r\n        {formatted.time ? (\r\n          <span className={dateBadgeTimeClass}>{formatted.time}</span>\r\n        ) : null}\r\n      </time>\r\n    </span>\r\n  );\r\n};\r\n\r\n// Делает текст компактнее, добавляя многоточие по необходимости\r\nconst compactText = (value: string, maxLength: number) => {\r\n  const trimmed = value.trim();\r\n  if (!trimmed || maxLength < 2 || trimmed.length <= maxLength) {\r\n    return trimmed;\r\n  }\r\n  const shortened = trimmed.slice(0, maxLength - 1).trimEnd();\r\n  return `${shortened}…`;\r\n};\r\n\r\nexport type EntityKind = \"task\" | \"request\";\r\n\r\nexport interface TaskRow extends Task {\r\n  id: string;\r\n  created_by?: number | string | null;\r\n  createdBy?: number | string | null;\r\n  creator?: number | string | null;\r\n  assigned_user_id?: number | null;\r\n  assignees?: number[];\r\n  start_date?: string | null;\r\n  due_date?: string | null;\r\n  start_location?: string | null;\r\n  start_location_link?: string | null;\r\n  end_location?: string | null;\r\n  end_location_link?: string | null;\r\n}\r\n\r\ntype EntityCase = \"nominative\" | \"accusative\" | \"genitive\";\r\n\r\nconst ENTITY_WORDS: Record<EntityKind, Record<EntityCase, string>> = {\r\n  task: {\r\n    nominative: \"Задача\",\r\n    accusative: \"Задачу\",\r\n    genitive: \"задачи\",\r\n  },\r\n  request: {\r\n    nominative: \"Заявка\",\r\n    accusative: \"Заявку\",\r\n    genitive: \"заявки\",\r\n  },\r\n};\r\n\r\nconst entityWord = (\r\n  kind: EntityKind,\r\n  form: EntityCase,\r\n  options?: { lower?: boolean },\r\n) => {\r\n  const base = ENTITY_WORDS[kind][form];\r\n  return options?.lower ? base.toLowerCase() : base;\r\n};\r\n\r\nconst resolveEntityKind = (\r\n  value: unknown,\r\n  fallback: EntityKind,\r\n): EntityKind => {\r\n  if (typeof value === \"string\" && value.trim().toLowerCase() === \"request\") {\r\n    return \"request\";\r\n  }\r\n  return fallback;\r\n};\r\n\r\nconst escapeRegExp = (value: string) =>\r\n  value.replace(/[.*+?^${}()|[\\\\]\\\\]/g, \"\\\\$&\");\r\n\r\ntype CountdownLikeState = Extract<\r\n  DeadlineState,\r\n  { kind: \"countdown\" | \"pending\" | \"overdue\" }\r\n>;\r\n\r\nconst countdownBadgeBaseClass = `${pillBadgeBaseClass} min-w-0 justify-start normal-case ${badgeTextClass} tabular-nums ring-1`;\r\n\r\nconst countdownToneClassMap: Record<\r\n  \"safe\" | \"warn\" | \"danger\" | \"overdue\" | \"pending\",\r\n  string\r\n> = {\r\n  safe: `${countdownBadgeBaseClass} bg-emerald-500/25 ring-emerald-500/45 dark:bg-emerald-400/25 dark:ring-emerald-300/45`,\r\n  warn: `${countdownBadgeBaseClass} bg-amber-500/25 ring-amber-500/45 dark:bg-amber-400/25 dark:ring-amber-300/45`,\r\n  danger: `${countdownBadgeBaseClass} bg-orange-500/25 ring-orange-500/45 dark:bg-orange-400/25 dark:ring-orange-300/45`,\r\n  overdue: `${countdownBadgeBaseClass} bg-rose-500/30 ring-rose-500/55 dark:bg-rose-400/30 dark:ring-rose-300/50`,\r\n  pending: `${countdownBadgeBaseClass} bg-sky-500/20 ring-sky-500/45 dark:bg-sky-400/25 dark:ring-sky-300/45`,\r\n};\r\n\r\nconst neutralCountdownBadgeClass = `${countdownBadgeBaseClass} bg-slate-500/15 ring-slate-500/35 dark:bg-slate-500/25 dark:ring-slate-400/35`;\r\n\r\nconst formatCountdownParts = (remainingMs: number) => {\r\n  const absValue = Math.abs(remainingMs);\r\n  const totalMinutes = Math.max(0, Math.floor(absValue / (60 * 1000)));\r\n  const days = Math.floor(totalMinutes / (24 * 60));\r\n  const hours = Math.floor((totalMinutes % (24 * 60)) / 60);\r\n  const minutes = totalMinutes % 60;\r\n  const pad = (value: number) => value.toString().padStart(2, \"0\");\r\n  return {\r\n    days,\r\n    hours,\r\n    minutes,\r\n    paddedDays: pad(days),\r\n    paddedHours: pad(hours),\r\n    paddedMinutes: pad(minutes),\r\n  };\r\n};\r\n\r\nconst getRussianPlural = (\r\n  value: number,\r\n  forms: [string, string, string],\r\n) => {\r\n  const absValue = Math.abs(value) % 100;\r\n  if (absValue >= 11 && absValue <= 14) {\r\n    return forms[2];\r\n  }\r\n  const lastDigit = absValue % 10;\r\n  if (lastDigit === 1) {\r\n    return forms[0];\r\n  }\r\n  if (lastDigit >= 2 && lastDigit <= 4) {\r\n    return forms[1];\r\n  }\r\n  return forms[2];\r\n};\r\n\r\nconst getCountdownToneKey = (\r\n  state: CountdownLikeState,\r\n): keyof typeof countdownToneClassMap => {\r\n  if (state.kind === \"overdue\") {\r\n    return \"overdue\";\r\n  }\r\n  if (state.kind === \"pending\") {\r\n    return \"pending\";\r\n  }\r\n  return state.level;\r\n};\r\n\r\nconst buildCountdownLabel = (state: CountdownLikeState) => {\r\n  const { days, hours, minutes } = formatCountdownParts(state.remainingMs);\r\n  if (state.kind === \"overdue\") {\r\n    return `Просрочено на ${days} ${getRussianPlural(days, [\r\n      \"день\",\r\n      \"дня\",\r\n      \"дней\",\r\n    ])} ${hours} ${getRussianPlural(hours, [\r\n      \"час\",\r\n      \"часа\",\r\n      \"часов\",\r\n    ])} ${minutes} ${getRussianPlural(minutes, [\r\n      \"минута\",\r\n      \"минуты\",\r\n      \"минут\",\r\n    ])}`;\r\n  }\r\n  if (state.kind === \"pending\") {\r\n    return `Начало через ${days} ${getRussianPlural(days, [\r\n      \"день\",\r\n      \"дня\",\r\n      \"дней\",\r\n    ])} ${hours} ${getRussianPlural(hours, [\r\n      \"час\",\r\n      \"часа\",\r\n      \"часов\",\r\n    ])} ${minutes} ${getRussianPlural(minutes, [\r\n      \"минута\",\r\n      \"минуты\",\r\n      \"минут\",\r\n    ])}`;\r\n  }\r\n  return `До дедлайна ${days} ${getRussianPlural(days, [\r\n    \"день\",\r\n    \"дня\",\r\n    \"дней\",\r\n  ])} ${hours} ${getRussianPlural(hours, [\r\n    \"час\",\r\n    \"часа\",\r\n    \"часов\",\r\n  ])} ${minutes} ${getRussianPlural(minutes, [\r\n    \"минута\",\r\n    \"минуты\",\r\n    \"минут\",\r\n  ])}`;\r\n};\r\n\r\nconst buildCountdownTitle = (\r\n  state: CountdownLikeState,\r\n  formatted: ReturnType<typeof formatDate>,\r\n  rawDue?: string,\r\n) => {\r\n  if (!formatted) {\r\n    return rawDue ? rawDue.trim() : undefined;\r\n  }\r\n  if (state.kind === \"overdue\") {\r\n    return `Просрочено с ${formatted.full}`;\r\n  }\r\n  if (state.kind === \"pending\") {\r\n    const note =\r\n      state.issue === \"missing-start\"\r\n        ? \"Не указана дата начала\"\r\n        : \"Диапазон дат некорректен\";\r\n    return `${note}. Срок ${formatted.full}`;\r\n  }\r\n  return `Выполнить до ${formatted.full}`;\r\n};\r\n\r\nconst COMPLETION_THRESHOLD_MS = 60_000;\r\n\r\nconst formatCompletionOffset = (diffMs: number) => {\r\n  const absValue = Math.abs(diffMs);\r\n  if (absValue < COMPLETION_THRESHOLD_MS) {\r\n    return \"менее минуты\";\r\n  }\r\n  const { days, hours, minutes } = formatCountdownParts(absValue);\r\n  const parts: string[] = [];\r\n  if (days) {\r\n    parts.push(`${days} ${getRussianPlural(days, [\"день\", \"дня\", \"дней\"])}`);\r\n  }\r\n  if (hours) {\r\n    parts.push(\r\n      `${hours} ${getRussianPlural(hours, [\"час\", \"часа\", \"часов\"])}`,\r\n    );\r\n  }\r\n  if (minutes && parts.length < 2) {\r\n    parts.push(\r\n      `${minutes} ${getRussianPlural(minutes, [\"минута\", \"минуты\", \"минут\"])}`,\r\n    );\r\n  }\r\n  if (!parts.length) {\r\n    return \"менее минуты\";\r\n  }\r\n  return parts.slice(0, 2).join(\" \");\r\n};\r\n\r\nconst buildCompletionNote = (\r\n  status: Task[\"status\"] | undefined,\r\n  dueValue?: string,\r\n  completedValue?: string | null,\r\n) => {\r\n  if (status !== \"Выполнена\") {\r\n    return null;\r\n  }\r\n  const dueDate = parseDateInput(dueValue);\r\n  const completedDate = parseDateInput(completedValue);\r\n  if (!dueDate || !completedDate) {\r\n    return null;\r\n  }\r\n  const diff = completedDate.getTime() - dueDate.getTime();\r\n  if (!Number.isFinite(diff)) {\r\n    return null;\r\n  }\r\n  if (Math.abs(diff) < COMPLETION_THRESHOLD_MS) {\r\n    return \"Выполнена точно в срок\";\r\n  }\r\n  const offset = formatCompletionOffset(diff);\r\n  if (!offset) {\r\n    return \"Выполнена точно в срок\";\r\n  }\r\n  return diff < 0\r\n    ? `Выполнена досрочно на ${offset}`\r\n    : `Выполнена с опозданием на ${offset}`;\r\n};\r\n\r\n// Fast Refresh обрабатывает вспомогательные компоненты как часть конфигурации таблицы\r\n// eslint-disable-next-line react-refresh/only-export-components\r\nexport function DeadlineCountdownBadge({\r\n  startValue,\r\n  dueValue,\r\n  rawDue,\r\n  status,\r\n  completedAt,\r\n}: {\r\n  startValue?: string;\r\n  dueValue?: string;\r\n  rawDue?: string;\r\n  status?: Task[\"status\"];\r\n  completedAt?: string | null;\r\n}) {\r\n  const completedDate = React.useMemo(\r\n    () => parseDateInput(completedAt),\r\n    [completedAt],\r\n  );\r\n  const isCompleted = status === \"Выполнена\";\r\n\r\n  const [now, setNow] = React.useState<Date>(\r\n    () => completedDate ?? new Date(),\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    if (isCompleted) {\r\n      if (completedDate) {\r\n        setNow(completedDate);\r\n      }\r\n      return;\r\n    }\r\n    const update = () => setNow(new Date());\r\n    update();\r\n    const timer = window.setInterval(update, 60_000);\r\n    return () => window.clearInterval(timer);\r\n  }, [isCompleted, completedDate, startValue, dueValue]);\r\n\r\n  const referenceDate = completedDate ?? now;\r\n\r\n  const state = React.useMemo(\r\n    () => getDeadlineState(startValue, dueValue, referenceDate),\r\n    [startValue, dueValue, referenceDate],\r\n  );\r\n\r\n  const formatted = React.useMemo(() => formatDate(dueValue), [dueValue]);\r\n  const completionNote = React.useMemo(\r\n    () => buildCompletionNote(status, dueValue, completedAt),\r\n    [status, dueValue, completedAt],\r\n  );\r\n\r\n  if (state.kind === \"invalid\") {\r\n    return (\r\n      <span\r\n        className={`${neutralCountdownBadgeClass} inline-flex items-center gap-1.5`}\r\n        title={\r\n          state.reason === \"missing\"\r\n            ? \"Срок не назначен\"\r\n            : \"Срок указан некорректно\"\r\n        }\r\n      >\r\n        <QuestionMarkCircleIcon\r\n          className=\"size-4 flex-shrink-0 text-black dark:text-white\"\r\n          aria-hidden\r\n        />\r\n        <span className=\"truncate\">Нет данных</span>\r\n      </span>\r\n    );\r\n  }\r\n\r\n  const toneKey = getCountdownToneKey(state);\r\n  const className = countdownToneClassMap[toneKey];\r\n  const parts = formatCountdownParts(state.remainingMs);\r\n  const label = buildCountdownLabel(state);\r\n  const title = completionNote\r\n    ? `${completionNote}. ${buildCountdownTitle(state, formatted, rawDue)}`\r\n    : buildCountdownTitle(state, formatted, rawDue);\r\n  return (\r\n    <span\r\n      className={`${className} inline-flex items-center gap-1.5`}\r\n      title={title}\r\n    >\r\n      <span className=\"sr-only\">{label}</span>\r\n      <span\r\n        aria-hidden\r\n        className=\"flex items-end gap-1 text-black dark:text-white\"\r\n      >\r\n        <span className=\"flex flex-col items-center leading-tight\">\r\n          <span className=\"text-[0.8rem] font-semibold tabular-nums\">\r\n            {parts.paddedDays}\r\n          </span>\r\n          <span className=\"text-[9px] font-medium text-black/80 dark:text-white/80\">\r\n            {getRussianPlural(parts.days, [\"день\", \"дня\", \"дней\"])}\r\n          </span>\r\n        </span>\r\n        <span className=\"flex flex-col items-center leading-tight\">\r\n          <span className=\"text-[0.8rem] font-semibold tabular-nums\">\r\n            {parts.paddedHours}\r\n          </span>\r\n          <span className=\"text-[9px] font-medium text-black/80 dark:text-white/80\">\r\n            {getRussianPlural(parts.hours, [\"час\", \"часа\", \"часов\"])}\r\n          </span>\r\n        </span>\r\n        <span className=\"flex flex-col items-center leading-tight\">\r\n          <span className=\"text-[0.8rem] font-semibold tabular-nums\">\r\n            {parts.paddedMinutes}\r\n          </span>\r\n          <span className=\"text-[9px] font-medium text-black/80 dark:text-white/80\">\r\n            {getRussianPlural(parts.minutes, [\"минута\", \"минуты\", \"минут\"])}\r\n          </span>\r\n        </span>\r\n      </span>\r\n      {completionNote ? (\r\n        <span className=\"sr-only\">{completionNote}</span>\r\n      ) : null}\r\n    </span>\r\n  );\r\n}\r\n\r\nconst durationToneClassMap: Record<\r\n  \"completed\" | \"cancelled\" | \"active\" | \"planned\" | \"idle\",\r\n  string\r\n> = {\r\n  completed: `${countdownBadgeBaseClass} bg-emerald-500/25 ring-emerald-500/45 dark:bg-emerald-400/25 dark:ring-emerald-300/45`,\r\n  cancelled: `${countdownBadgeBaseClass} bg-rose-500/30 ring-rose-500/55 dark:bg-rose-400/30 dark:ring-rose-300/50`,\r\n  active: `${countdownBadgeBaseClass} bg-amber-500/25 ring-amber-500/45 dark:bg-amber-400/25 dark:ring-amber-300/45`,\r\n  planned: `${countdownBadgeBaseClass} bg-sky-500/20 ring-sky-500/45 dark:bg-sky-400/25 dark:ring-sky-300/45`,\r\n  idle: neutralCountdownBadgeClass,\r\n};\r\n\r\nconst formatDurationPhrase = (\r\n  parts: ReturnType<typeof formatCountdownParts>,\r\n  variant: \"completed\" | \"running\",\r\n  entityKind: EntityKind,\r\n) => {\r\n  const { days, hours, minutes } = parts;\r\n  if (!days && !hours && !minutes) {\r\n    return variant === \"completed\"\r\n      ? `${entityWord(entityKind, \"nominative\")} завершена менее чем за минуту`\r\n      : \"Затрачено менее минуты\";\r\n  }\r\n  const dayLabel = `${days} ${getRussianPlural(days, [\r\n    \"день\",\r\n    \"дня\",\r\n    \"дней\",\r\n  ])}`;\r\n  const hourLabel = `${hours} ${getRussianPlural(hours, [\r\n    \"час\",\r\n    \"часа\",\r\n    \"часов\",\r\n  ])}`;\r\n  const minuteLabel = `${minutes} ${getRussianPlural(minutes, [\r\n    \"минута\",\r\n    \"минуты\",\r\n    \"минут\",\r\n  ])}`;\r\n  const phrase = `${dayLabel} ${hourLabel} ${minuteLabel}`;\r\n  return variant === \"completed\"\r\n    ? `${entityWord(entityKind, \"nominative\")} завершена за ${phrase}`\r\n    : `Затрачено ${phrase}`;\r\n};\r\n\r\nconst buildDurationTitle = (\r\n  variant: \"completed\" | \"running\" | \"idle\",\r\n  startValue?: string,\r\n  endValue?: string,\r\n  parts?: ReturnType<typeof formatCountdownParts>,\r\n  entityKind: EntityKind = \"task\",\r\n) => {\r\n  const titleParts: string[] = [];\r\n  const startFormatted = startValue ? formatDate(startValue) : null;\r\n  const endFormatted = endValue ? formatDate(endValue) : null;\r\n  if (startFormatted) {\r\n    titleParts.push(`Начало: ${startFormatted.full}`);\r\n  }\r\n  if (endFormatted) {\r\n    titleParts.push(\r\n      variant === \"completed\"\r\n        ? `Завершено: ${endFormatted.full}`\r\n        : `Текущее время: ${endFormatted.full}`,\r\n    );\r\n  }\r\n  if (parts) {\r\n    const phrase = formatDurationPhrase(\r\n      parts,\r\n      variant === \"completed\" ? \"completed\" : \"running\",\r\n      entityKind,\r\n    );\r\n    const normalized =\r\n      variant === \"completed\"\r\n        ? phrase.replace(\r\n            new RegExp(\r\n              `^${escapeRegExp(\r\n                `${entityWord(entityKind, \"nominative\")} завершена за `,\r\n              )}`,\r\n            ),\r\n            \"Продолжительность: \",\r\n          )\r\n        : phrase.replace(/^Затрачено\\s/, \"Продолжительность: \");\r\n    titleParts.push(\r\n      variant === \"idle\" ? `Продолжительность: ${phrase}` : normalized,\r\n    );\r\n  }\r\n  if (!titleParts.length) {\r\n    return variant === \"idle\"\r\n      ? \"Продолжительность появится после указания даты начала\"\r\n      : \"Нет данных о продолжительности\";\r\n  }\r\n  return titleParts.join(\"\\n\");\r\n};\r\n\r\ntype ActualTimeCellProps = {\r\n  progressStartValue?: string | null;\r\n  plannedStartValue?: string | null;\r\n  completedValue?: string | null;\r\n  status?: Task[\"status\"];\r\n  entityKind: EntityKind;\r\n};\r\n\r\n// eslint-disable-next-line react-refresh/only-export-components\r\nfunction ActualTimeCell({\r\n  progressStartValue,\r\n  plannedStartValue,\r\n  completedValue,\r\n  status,\r\n  entityKind,\r\n}: ActualTimeCellProps) {\r\n  const plannedStartDate = React.useMemo(\r\n    () => parseDateInput(plannedStartValue),\r\n    [plannedStartValue],\r\n  );\r\n  const progressStartDate = React.useMemo(\r\n    () => parseDateInput(progressStartValue),\r\n    [progressStartValue],\r\n  );\r\n  const completedDate = React.useMemo(\r\n    () => parseDateInput(completedValue),\r\n    [completedValue],\r\n  );\r\n  const isFinished = status === \"Выполнена\" || status === \"Отменена\";\r\n  const isCancelled = status === \"Отменена\";\r\n  const isNotStarted = status === \"Новая\";\r\n\r\n  const timerStartDate = React.useMemo(() => {\r\n    if (isNotStarted) {\r\n      return null;\r\n    }\r\n    return progressStartDate ?? plannedStartDate ?? null;\r\n  }, [isNotStarted, progressStartDate, plannedStartDate]);\r\n\r\n  const [referenceDate, setReferenceDate] = React.useState<Date>(() => {\r\n    if (isFinished && completedDate) {\r\n      return completedDate;\r\n    }\r\n    return new Date();\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    if (isFinished) {\r\n      if (completedDate) {\r\n        setReferenceDate(completedDate);\r\n      }\r\n      return undefined;\r\n    }\r\n    if (!timerStartDate) {\r\n      return undefined;\r\n    }\r\n    const update = () => setReferenceDate(new Date());\r\n    update();\r\n    const timer = window.setInterval(update, 60_000);\r\n    return () => window.clearInterval(timer);\r\n  }, [isFinished, completedDate, timerStartDate]);\r\n\r\n  const effectiveEndDate = isFinished && completedDate\r\n    ? completedDate\r\n    : referenceDate;\r\n  const durationMs = timerStartDate\r\n    ? Math.max(0, effectiveEndDate.getTime() - timerStartDate.getTime())\r\n    : null;\r\n  const durationParts = React.useMemo(() => {\r\n    if (isNotStarted) {\r\n      return formatCountdownParts(0);\r\n    }\r\n    return durationMs !== null ? formatCountdownParts(durationMs) : null;\r\n  }, [durationMs, isNotStarted]);\r\n\r\n  const endIso = React.useMemo(() => effectiveEndDate.toISOString(), [\r\n    effectiveEndDate,\r\n  ]);\r\n\r\n  const variant: \"completed\" | \"running\" | \"idle\" =\r\n    isNotStarted || !timerStartDate\r\n      ? \"idle\"\r\n      : isFinished\r\n      ? \"completed\"\r\n      : \"running\";\r\n\r\n  const toneKey: keyof typeof durationToneClassMap =\r\n    isNotStarted || !timerStartDate\r\n      ? \"idle\"\r\n      : isFinished\r\n      ? isCancelled\r\n        ? \"cancelled\"\r\n        : \"completed\"\r\n      : status === \"В работе\"\r\n      ? \"active\"\r\n      : \"planned\";\r\n\r\n  const label = isNotStarted\r\n    ? `${entityWord(entityKind, \"nominative\")} ещё не начата`\r\n    : durationParts\r\n    ? formatDurationPhrase(\r\n        durationParts,\r\n        variant === \"completed\" ? \"completed\" : \"running\",\r\n        entityKind,\r\n      )\r\n    : \"Продолжительность появится после начала\";\r\n\r\n  const startValueForTooltip =\r\n    progressStartValue ?? plannedStartValue ?? undefined;\r\n\r\n  const durationBadgeTitle = isNotStarted\r\n    ? `Таймер запустится после перевода ${entityWord(entityKind, \"genitive\", { lower: true })} в статус «В работе»`\r\n    : buildDurationTitle(\r\n        variant,\r\n        startValueForTooltip,\r\n        variant === \"completed\" ? completedValue ?? undefined : endIso,\r\n        durationParts ?? undefined,\r\n        entityKind,\r\n      );\r\n\r\n  const renderStopBadge = () => {\r\n    if (isFinished && completedDate && completedValue) {\r\n      return renderDateCell(completedValue);\r\n    }\r\n    if (isFinished) {\r\n      return (\r\n        <span className={dateBadgeClass} title=\"Нет отметки о завершении\">\r\n          <span className=\"truncate\">Нет данных</span>\r\n        </span>\r\n      );\r\n    }\r\n    if (!timerStartDate) {\r\n      const placeholder =\r\n        status === \"Новая\"\r\n          ? \"Не начата\"\r\n          : status === \"В работе\"\r\n          ? \"В работе\"\r\n          : \"В ожидании\";\r\n      const title =\r\n        status === \"Новая\"\r\n          ? `${entityWord(entityKind, \"nominative\")} ещё не начата`\r\n          : status === \"В работе\"\r\n          ? \"Таймер запустится после фиксации начала\"\r\n          : \"Дата начала отсутствует\";\r\n      return (\r\n        <span className={dateBadgeClass} title={title}>\r\n          <span className=\"truncate\">{placeholder}</span>\r\n        </span>\r\n      );\r\n    }\r\n    const placeholder = status === \"В работе\" ? \"В работе\" : \"В ожидании\";\r\n    return (\r\n      <span\r\n        className={dateBadgeClass}\r\n        title={`${entityWord(entityKind, \"nominative\")} ещё не завершена`}\r\n      >\r\n        <span className=\"truncate\">{placeholder}</span>\r\n      </span>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-col items-start gap-1\">\r\n      {renderStopBadge()}\r\n      <span\r\n        className={`${durationToneClassMap[toneKey]} inline-flex items-center gap-1.5`}\r\n        title={durationBadgeTitle}\r\n      >\r\n        <span className=\"sr-only\">{label}</span>\r\n        {durationParts ? (\r\n          <span\r\n            aria-hidden\r\n            className=\"flex items-end gap-1 text-black dark:text-white\"\r\n          >\r\n            <span className=\"flex flex-col items-center leading-tight\">\r\n              <span className=\"text-[0.8rem] font-semibold tabular-nums\">\r\n                {durationParts.paddedDays}\r\n              </span>\r\n              <span className=\"text-[9px] font-medium text-black/80 dark:text-white/80\">\r\n                {getRussianPlural(durationParts.days, [\r\n                  \"день\",\r\n                  \"дня\",\r\n                  \"дней\",\r\n                ])}\r\n              </span>\r\n            </span>\r\n            <span className=\"flex flex-col items-center leading-tight\">\r\n              <span className=\"text-[0.8rem] font-semibold tabular-nums\">\r\n                {durationParts.paddedHours}\r\n              </span>\r\n              <span className=\"text-[9px] font-medium text-black/80 dark:text-white/80\">\r\n                {getRussianPlural(durationParts.hours, [\r\n                  \"час\",\r\n                  \"часа\",\r\n                  \"часов\",\r\n                ])}\r\n              </span>\r\n            </span>\r\n            <span className=\"flex flex-col items-center leading-tight\">\r\n              <span className=\"text-[0.8rem] font-semibold tabular-nums\">\r\n                {durationParts.paddedMinutes}\r\n              </span>\r\n              <span className=\"text-[9px] font-medium text-black/80 dark:text-white/80\">\r\n                {getRussianPlural(durationParts.minutes, [\r\n                  \"минута\",\r\n                  \"минуты\",\r\n                  \"минут\",\r\n                ])}\r\n              </span>\r\n            </span>\r\n          </span>\r\n        ) : (\r\n          <span className=\"text-xs font-medium text-black dark:text-white\">\r\n            {label}\r\n          </span>\r\n        )}\r\n      </span>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function taskColumns(\r\n  users: Record<number, AppUser>,\r\n  defaultKind: EntityKind = \"task\",\r\n): ColumnDef<TaskRow>[] {\r\n  const cols: ColumnDef<TaskRow>[] = [\r\n    {\r\n      header: \"Номер\",\r\n      id: \"number\",\r\n      accessorFn: (row) => {\r\n        const rowKind = resolveEntityKind(row.kind, defaultKind);\r\n        const rawValue =\r\n          rowKind === \"request\"\r\n            ? row.request_id || row.task_number || row._id\r\n            : row.task_number || row.request_id || row._id;\r\n        if (typeof rawValue === \"string\") {\r\n          return rawValue;\r\n        }\r\n        if (rawValue === undefined || rawValue === null) {\r\n          return \"\";\r\n        }\r\n        return String(rawValue);\r\n      },\r\n      meta: {\r\n        width: \"clamp(4.25rem, 8vw, 6.25rem)\",\r\n        minWidth: \"4rem\",\r\n        maxWidth: \"6.5rem\",\r\n        cellClassName:\r\n          \"whitespace-nowrap text-center font-mono tabular-nums sm:text-left sm:pl-1.5\",\r\n        headerClassName: \"whitespace-nowrap text-center sm:text-left\",\r\n      },\r\n      cell: (p) => {\r\n        const row = p.row.original as TaskRow;\r\n        const rowKind = resolveEntityKind(row.kind, defaultKind);\r\n        const value = (p.getValue<string>() || \"\").trim();\r\n        const fallback =\r\n          rowKind === \"request\"\r\n            ? (row.request_id as string | undefined) ??\r\n              (row.task_number as string | undefined) ??\r\n              String(row._id)\r\n            : (row.task_number as string | undefined) ??\r\n              (row.request_id as string | undefined) ??\r\n              String(row._id);\r\n        const display = value || fallback || \"\";\r\n        const numericMatch = display.match(/\\d+/);\r\n        const shortValue = numericMatch ? numericMatch[0] : display;\r\n        return (\r\n          <span className={`${numberBadgeClass} justify-center`} title={display}>\r\n            <span className=\"truncate\">{shortValue}</span>\r\n          </span>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: `${entityWord(defaultKind, \"accusative\")} создал`,\r\n      accessorKey: \"createdAt\",\r\n      meta: {\r\n        width: \"clamp(9rem, 18vw, 14rem)\",\r\n        minWidth: \"8.5rem\",\r\n        maxWidth: \"16rem\",\r\n        cellClassName: \"whitespace-nowrap\",\r\n      },\r\n      cell: ({ row }) => {\r\n        const rawCreator =\r\n          (row.original.created_by as unknown) ??\r\n          (row.original.createdBy as unknown) ??\r\n          (row.original.creator as unknown);\r\n        const creatorId =\r\n          typeof rawCreator === \"number\"\r\n            ? rawCreator\r\n            : typeof rawCreator === \"string\" && rawCreator.trim()\r\n            ? Number(rawCreator)\r\n            : NaN;\r\n        if (!Number.isFinite(creatorId)) {\r\n          return <span className=\"text-muted-foreground\">—</span>;\r\n        }\r\n        const id = creatorId as number;\r\n        const user = users[id];\r\n        const label =\r\n          (user?.name as string | undefined) ||\r\n          (user?.telegram_username as string | undefined) ||\r\n          (user?.username as string | undefined) ||\r\n          String(id);\r\n        const title = label.trim() || String(id);\r\n        return (\r\n          <EmployeeLink\r\n            employeeId={id}\r\n            stopPropagation\r\n            title={title}\r\n            className={`${creatorBadgeClass} ${focusableBadgeClass} no-underline`}\r\n          >\r\n            <span className=\"truncate\">{compactText(label, 32)}</span>\r\n          </EmployeeLink>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: \"Название\",\r\n      accessorKey: \"title\",\r\n      meta: {\r\n        width: \"clamp(8rem, 18vw, 18rem)\",\r\n        minWidth: \"7rem\",\r\n        maxWidth: \"18rem\",\r\n        cellClassName: \"align-top\",\r\n      },\r\n      cell: (p) => {\r\n        const v = p.getValue<string>() || \"\";\r\n        const compact = compactText(v, 72);\r\n        const row = p.row.original as TaskRow;\r\n        const completionNote = buildCompletionNote(\r\n          row.status,\r\n          row.due_date ?? undefined,\r\n          row.completed_at ?? undefined,\r\n        );\r\n        return (\r\n          <div className=\"flex flex-col items-start gap-1\">\r\n            <span\r\n              title={v}\r\n              className={`${titleBadgeClass} whitespace-normal`}\r\n            >\r\n              <span\r\n                className=\"block max-w-full break-words text-left leading-snug\"\r\n                style={{\r\n                  display: \"-webkit-box\",\r\n                  WebkitLineClamp: 2,\r\n                  WebkitBoxOrient: \"vertical\",\r\n                  overflow: \"hidden\",\r\n                }}\r\n              >\r\n                {compact}\r\n              </span>\r\n            </span>\r\n            {completionNote ? (\r\n              <span className={completionNoteTextClass}>{completionNote}</span>\r\n            ) : null}\r\n          </div>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: \"Исполнители\",\r\n      accessorKey: \"assignees\",\r\n      meta: {\r\n        width: \"clamp(7rem, 20vw, 13rem)\",\r\n        minWidth: \"6rem\",\r\n        maxWidth: \"13rem\",\r\n      },\r\n      cell: ({ row }) => {\r\n        const ids = Array.isArray(row.original.assignees)\r\n          ? row.original.assignees\r\n          : typeof row.original.assigned_user_id === \"number\"\r\n          ? [row.original.assigned_user_id]\r\n          : [];\r\n        if (!ids.length) {\r\n          return <span className=\"text-muted-foreground\">—</span>;\r\n        }\r\n        const labels = ids.map((id) => ({\r\n          id,\r\n          label:\r\n            users[id]?.name ||\r\n            users[id]?.telegram_username ||\r\n            users[id]?.username ||\r\n            String(id),\r\n        }));\r\n        const tooltip = labels.map((item) => item.label).join(\", \");\r\n        return (\r\n          <div\r\n            className=\"flex w-full flex-wrap items-start gap-1 leading-tight\"\r\n            title={tooltip}\r\n          >\r\n            {labels.map(({ id, label }) => (\r\n              <EmployeeLink\r\n                key={id}\r\n                employeeId={id}\r\n                stopPropagation\r\n                className={`${assigneeBadgeClass} ${focusableBadgeClass} no-underline`}\r\n              >\r\n                <span className=\"truncate\">{compactText(label, 18)}</span>\r\n              </EmployeeLink>\r\n            ))}\r\n          </div>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: \"Статус\",\r\n      accessorKey: \"status\",\r\n      meta: {\r\n        width: \"clamp(4.5rem, 8vw, 6.5rem)\",\r\n        minWidth: \"4.5rem\",\r\n        maxWidth: \"6.5rem\",\r\n        cellClassName: \"whitespace-nowrap\",\r\n      },\r\n      cell: (p) => {\r\n        const value = p.getValue<string>() || \"\";\r\n        if (!value) {\r\n          return \"\";\r\n        }\r\n        const badgeClass = getStatusBadgeClass(value);\r\n        if (!badgeClass) {\r\n          return <span className={fallbackBadgeClass}>{value}</span>;\r\n        }\r\n        return <span className={badgeClass}>{value}</span>;\r\n      },\r\n    },\r\n    {\r\n      header: \"Приоритет\",\r\n      accessorKey: \"priority\",\r\n      meta: {\r\n        width: \"clamp(8.5rem, 15vw, 12.5rem)\",\r\n        minWidth: \"8.5rem\",\r\n        maxWidth: \"12.5rem\",\r\n        cellClassName: \"whitespace-nowrap\",\r\n      },\r\n      cell: (p) => {\r\n        const value = p.getValue<string>() || \"\";\r\n        if (!value.trim()) {\r\n          return \"\";\r\n        }\r\n        const display = normalizePriorityLabel(value);\r\n        const badgeClass = getPriorityBadgeClass(value);\r\n        const className = badgeClass || `${fallbackBadgeClass} normal-case`;\r\n        return (\r\n          <span className={className} title={display}>\r\n            {display}\r\n          </span>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: \"Начало\",\r\n      accessorKey: \"start_date\",\r\n      meta: {\r\n        width: \"clamp(6.75rem, 11vw, 8.75rem)\",\r\n        minWidth: \"6.5rem\",\r\n        maxWidth: \"9rem\",\r\n        cellClassName: \"whitespace-nowrap text-xs sm:text-sm\",\r\n      },\r\n      cell: (p) => renderDateCell(p.getValue<string>()),\r\n    },\r\n    {\r\n      header: \"Дедлайн\",\r\n      accessorKey: \"due_date\",\r\n      meta: {\r\n        width: \"clamp(10.5rem, 20vw, 15.5rem)\",\r\n        minWidth: \"10rem\",\r\n        maxWidth: \"16.5rem\",\r\n        cellClassName: \"whitespace-nowrap text-xs sm:text-sm\",\r\n      },\r\n      cell: (p) => {\r\n        const dueValue = p.getValue<string>();\r\n        const row = p.row.original;\r\n        const countdown = (\r\n          <DeadlineCountdownBadge\r\n            startValue={row.start_date ?? undefined}\r\n            dueValue={row.due_date ?? undefined}\r\n            rawDue={dueValue}\r\n            status={row.status}\r\n            completedAt={row.completed_at ?? undefined}\r\n          />\r\n        );\r\n        if (!dueValue) {\r\n          return countdown;\r\n        }\r\n        const dateCell = renderDateCell(dueValue);\r\n        if (typeof dateCell === \"string\") {\r\n          if (!dateCell) {\r\n            return countdown;\r\n          }\r\n          return (\r\n            <div className=\"flex flex-col items-start gap-1\">\r\n              {dateCell ? <span>{dateCell}</span> : null}\r\n              {countdown}\r\n            </div>\r\n          );\r\n        }\r\n        return (\r\n          <div className=\"flex flex-col items-start gap-1\">\r\n            {dateCell}\r\n            {countdown}\r\n          </div>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: \"Время выполнения\",\r\n      accessorKey: \"completed_at\",\r\n      meta: {\r\n        width: \"clamp(10.5rem, 20vw, 15.5rem)\",\r\n        minWidth: \"10rem\",\r\n        maxWidth: \"16.5rem\",\r\n        cellClassName: \"whitespace-nowrap text-xs sm:text-sm\",\r\n      },\r\n      cell: (p) => {\r\n        const row = p.row.original;\r\n        const rowKind = resolveEntityKind(row.kind, defaultKind);\r\n        return (\r\n          <ActualTimeCell\r\n            progressStartValue={row.in_progress_at ?? undefined}\r\n            plannedStartValue={row.start_date ?? undefined}\r\n            completedValue={p.getValue<string | null>() ?? undefined}\r\n            status={row.status}\r\n            entityKind={rowKind}\r\n          />\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: \"Тип\",\r\n      accessorKey: \"task_type\",\r\n      meta: {\r\n        width: \"clamp(4.5rem, 8vw, 6.5rem)\",\r\n        minWidth: \"4.5rem\",\r\n        maxWidth: \"6.5rem\",\r\n        cellClassName: \"whitespace-nowrap\",\r\n      },\r\n      cell: (p) => {\r\n        const value = p.getValue<string>() || \"\";\r\n        const trimmed = value.trim();\r\n        if (!trimmed) {\r\n          return \"\";\r\n        }\r\n        const badgeClass = getTypeBadgeClass(trimmed);\r\n        const className = badgeClass || `${fallbackBadgeClass} normal-case`;\r\n        return (\r\n          <span className={className} title={trimmed}>\r\n            {trimmed}\r\n          </span>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: \"Старт\",\r\n      accessorKey: \"start_location\",\r\n      meta: {\r\n        width: \"clamp(5.5rem, 14vw, 9.5rem)\",\r\n        minWidth: \"5rem\",\r\n        maxWidth: \"9.5rem\",\r\n        cellClassName: \"whitespace-nowrap\",\r\n      },\r\n      cell: ({ row }) => {\r\n        const name = row.original.start_location ?? \"\";\r\n        const trimmed = name.trim();\r\n        const firstToken = trimmed.split(/[\\s,;]+/).filter(Boolean)[0] || trimmed;\r\n        const compact = compactText(firstToken, 24);\r\n        const link = row.original.start_location_link ?? undefined;\r\n        return link ? (\r\n          <a\r\n            href={link}\r\n            target=\"_blank\"\r\n            rel=\"noopener noreferrer\"\r\n            className={locationLinkBadgeClass}\r\n            title={name}\r\n          >\r\n            <span className=\"truncate\">{compact}</span>\r\n          </a>\r\n        ) : (\r\n          <span title={name} className={locationBadgeClass}>\r\n            <span className=\"truncate\">{compact}</span>\r\n          </span>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: \"Финиш\",\r\n      accessorKey: \"end_location\",\r\n      meta: {\r\n        width: \"clamp(5.5rem, 14vw, 9.5rem)\",\r\n        minWidth: \"5rem\",\r\n        maxWidth: \"9.5rem\",\r\n        cellClassName: \"whitespace-nowrap\",\r\n      },\r\n      cell: ({ row }) => {\r\n        const name = row.original.end_location ?? \"\";\r\n        const trimmed = name.trim();\r\n        const firstToken = trimmed.split(/[\\s,;]+/).filter(Boolean)[0] || trimmed;\r\n        const compact = compactText(firstToken, 24);\r\n        const link = row.original.end_location_link ?? undefined;\r\n        return link ? (\r\n          <a\r\n            href={link}\r\n            target=\"_blank\"\r\n            rel=\"noopener noreferrer\"\r\n            className={locationLinkBadgeClass}\r\n            title={name}\r\n          >\r\n            <span className=\"truncate\">{compact}</span>\r\n          </a>\r\n        ) : (\r\n          <span title={name} className={locationBadgeClass}>\r\n            <span className=\"truncate\">{compact}</span>\r\n          </span>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      header: \"Км\",\r\n      accessorKey: \"route_distance_km\",\r\n      meta: {\r\n        width: \"clamp(3.25rem, 6vw, 4.75rem)\",\r\n        minWidth: \"3rem\",\r\n        maxWidth: \"4.75rem\",\r\n        cellClassName: \"whitespace-nowrap text-center sm:text-left\",\r\n        headerClassName: \"text-center sm:text-left\",\r\n      },\r\n      cell: (p) => {\r\n        const raw = p.getValue<number | string | null>();\r\n        if (raw === null || raw === undefined || (typeof raw === \"string\" && !raw.trim())) {\r\n          return \"\";\r\n        }\r\n        const display = formatDistanceLabel(raw);\r\n        if (!display) {\r\n          return \"\";\r\n        }\r\n        const badgeClass = getDistanceBadgeClass(raw);\r\n        const className = badgeClass || fallbackBadgeClass;\r\n        return (\r\n          <span className={className} title={`${display} км`}>\r\n            {display}\r\n          </span>\r\n        );\r\n      },\r\n    },\r\n  ];\r\n  return cols;\r\n}\r\n"],"names":["QuestionMarkCircleIcon","title","titleId","props","svgRef","React.createElement","ForwardRef","React.forwardRef","parseDateValue","value","date","clampRatio","getDeadlineState","startValue","dueValue","referenceDate","dueDate","startDate","remainingMs","totalMs","ratio","level","badgeBaseClass","badgeTextClass","buildBadgeClass","tones","extraClass","focusableBadgeClass","pillBadgeBaseClass","dateBadgeClass","dateBadgeTimeClass","numberBadgeClass","titleBadgeClass","creatorBadgeClass","assigneeBadgeClass","fallbackBadgeClass","locationBadgeClass","locationLinkBadgeClass","statusBadgeClassMap","urgentPriorityBadgeClass","highPriorityBadgeClass","normalPriorityBadgeClass","lowPriorityBadgeClass","priorityBadgeClassMap","hasOwn","obj","key","getStatusBadgeClass","getPriorityBadgeClass","normalized","normalizePriorityLabel","trimmed","completionNoteTextClass","typeBadgeClassMap","getTypeBadgeClass","parseDistance","formatDistanceLabel","numeric","shortDistanceBadgeClass","mediumDistanceBadgeClass","longDistanceBadgeClass","extraLongDistanceBadgeClass","getDistanceBadgeClass","fullDateTimeFmt","PROJECT_TIMEZONE","datePartFmt","timePartFmt","parseDateInput","formatDate","full","PROJECT_TIMEZONE_LABEL","datePart","timePart","renderDateCell","formatted","jsxs","jsx","compactText","maxLength","shortened","ENTITY_WORDS","entityWord","kind","form","options","base","resolveEntityKind","fallback","escapeRegExp","countdownBadgeBaseClass","countdownToneClassMap","neutralCountdownBadgeClass","formatCountdownParts","absValue","totalMinutes","days","hours","minutes","pad","getRussianPlural","forms","lastDigit","getCountdownToneKey","state","buildCountdownLabel","buildCountdownTitle","rawDue","note","COMPLETION_THRESHOLD_MS","formatCompletionOffset","diffMs","parts","buildCompletionNote","status","completedValue","completedDate","diff","offset","DeadlineCountdownBadge","completedAt","React","isCompleted","now","setNow","update","timer","completionNote","toneKey","className","label","durationToneClassMap","formatDurationPhrase","variant","entityKind","dayLabel","hourLabel","minuteLabel","phrase","buildDurationTitle","endValue","titleParts","startFormatted","endFormatted","ActualTimeCell","progressStartValue","plannedStartValue","plannedStartDate","progressStartDate","isFinished","isCancelled","isNotStarted","timerStartDate","_a","setReferenceDate","effectiveEndDate","durationMs","durationParts","endIso","startValueForTooltip","durationBadgeTitle","renderStopBadge","placeholder","taskColumns","users","defaultKind","row","rawValue","p","rowKind","_b","_d","_c","display","numericMatch","shortValue","rawCreator","creatorId","id","user","EmployeeLink","v","compact","ids","labels","tooltip","item","badgeClass","countdown","dateCell","name","firstToken","link","raw"],"mappings":"qLACA,SAASA,GAAuB,CAC9B,MAAAC,EACA,QAAAC,EACA,GAAGC,CACL,EAAGC,EAAQ,CACT,OAAoBC,gBAAoB,MAAO,OAAO,OAAO,CAC3D,MAAO,6BACP,QAAS,YACT,KAAM,eACN,cAAe,OACf,YAAa,OACb,IAAKD,EACL,kBAAmBF,CACvB,EAAKC,CAAK,EAAGF,EAAqBI,EAAAA,cAAoB,QAAS,CAC3D,GAAIH,CACR,EAAKD,CAAK,EAAI,KAAmBI,EAAAA,cAAoB,OAAQ,CACzD,SAAU,UACV,EAAG,oNACH,SAAU,SACd,CAAG,CAAC,CACJ,CACA,MAAMC,GAA2BC,EAAAA,WAAiBP,EAAsB,EC0BlEQ,EAAkBC,GAAmB,CACzC,GAAI,CAACA,EACH,OAAO,KAET,MAAMC,EAAO,IAAI,KAAKD,CAAK,EAC3B,OAAO,OAAO,MAAMC,EAAK,QAAA,CAAS,EAAI,KAAOA,CAC/C,EAEMC,GAAcF,GACd,OAAO,MAAMA,CAAK,EACb,EAELA,EAAQ,EACH,EAELA,EAAQ,EACH,EAEFA,EAGIG,GAAmB,CAC9BC,EACAC,EACAC,EAAgB,IAAI,OACF,CAClB,MAAMC,EAAUR,EAAeM,CAAQ,EACjCG,EAAYT,EAAeK,CAAU,EAE3C,GAAI,CAACG,EACH,MAAO,CACL,KAAM,UACN,OAAQF,EAAW,UAAY,UAC/B,QAAS,KACT,UAAAG,EACA,YAAa,IAAA,EAIjB,MAAMC,EAAcF,EAAQ,QAAA,EAAYD,EAAc,QAAA,EAEtD,GAAIG,EAAc,EAChB,MAAO,CACL,KAAM,UACN,QAAAF,EACA,UAAAC,EACA,YAAAC,CAAA,EAIJ,GAAI,CAACD,EACH,MAAO,CACL,KAAM,UACN,MAAO,gBACP,QAAAD,EACA,UAAW,KACX,YAAAE,CAAA,EAIJ,GAAID,EAAU,QAAA,GAAaD,EAAQ,UACjC,MAAO,CACL,KAAM,UACN,MAAO,gBACP,QAAAA,EACA,UAAAC,EACA,YAAAC,CAAA,EAIJ,MAAMC,EAAUH,EAAQ,QAAA,EAAYC,EAAU,QAAA,EACxCG,EAAQT,GAAWO,EAAcC,CAAO,EAC9C,IAAIE,EACJ,OAAID,EAAQ,GACVC,EAAQ,OACCD,GAAS,GAClBC,EAAQ,OAERA,EAAQ,SAGH,CACL,KAAM,YACN,MAAAD,EACA,MAAAC,EACA,QAAAL,EACA,UAAAC,EACA,YAAAC,CAAA,CAEJ,EC9HMI,GACJ,mKACIC,EAAiB,6BAEjBC,EAAkB,CAACC,EAAeC,EAAa,KACnD,CAACJ,GAAgB,oBAAqBC,EAAgBG,EAAYD,CAAK,EACpE,OAAO,OAAO,EACd,KAAK,GAAG,EAEPE,EACJ,2IAEIC,EACJ,6MAEIC,EACJ,GAAG,OAAAD,EAAkB,2BAA0B,OAAAL,EAAc,yFAEzDO,GACJ,kEAEIC,GACJ,GAAG,OAAAH,EAAkB,yEAAwE,OAAAL,EAAc,yFAEvGS,GACJ,GAAG,OAAAJ,EAAkB,+BAA8B,OAAAL,EAAc,6FAEtDU,GACX,GAAG,OAAAL,EAAkB,iDAAgD,OAAAL,EAAc,qFAE/EW,GACJ,GAAG,OAAAN,EAAkB,iBAAgB,OAAAL,EAAc,6FAExCY,EAAqBX,EAChC,yFACF,EAEMY,EACJ,GAAG,OAAAR,EAAkB,iBAAgB,OAAAL,EAAc,iGAE/Cc,EACJ,GAAG,OAAAD,EAAkB,KAAI,OAAAT,EAAmB,oDAExCW,EAAsD,CAC1D,MAAOd,EACL,8EAAA,EAEF,WAAYA,EACV,sFAAA,EAEF,UAAWA,EACT,8FAAA,EAEF,SAAUA,EACR,kFAAA,CAEJ,EAEMe,GAA2Bf,EAC/B,oFACF,EAEMgB,GAAyBhB,EAC7B,4EACF,EAEMiB,GAA2BjB,EAC/B,4EACF,EAEMkB,GAAwBlB,EAC5B,4EACF,EAEMmB,EAAgD,CACpD,OAAQnB,EACN,kFAAA,EAEF,gBAAiBA,EACf,8EAAA,EAEF,gBAAiBA,EACf,uFACA,aAAA,CAEJ,EAEMoB,EAAS,CAAyCC,EAAQC,IAC9D,OAAO,UAAU,eAAe,KAAKD,EAAKC,CAAG,EAElCC,GAAuBtC,GAC9BmC,EAAON,EAAqB7B,CAAK,EAC5B6B,EAAoB7B,CAAK,EAE3B,KAGIuC,GAAyBvC,GAAkB,CACtD,MAAMwC,EAAaxC,EAAM,KAAA,EAAO,YAAA,EAChC,OAAKwC,EAGDL,EAAOD,EAAuBM,CAAU,EACnCN,EAAsBM,CAAU,EAErC,cAAc,KAAKA,CAAU,EACxBV,GAEL,mBAAmB,KAAKU,CAAU,EAC7BT,GAEL,8CAA8C,KAAKS,CAAU,EACxDP,GAEL,2BAA2B,KAAKO,CAAU,EACrCR,GAEF,KAjBE,IAkBX,EAEMS,GAA0BzC,GAAkB,CAChD,MAAM0C,EAAU1C,EAAM,KAAA,EACtB,OAAK0C,IAGD,YAAY,KAAKA,CAAO,EACnB,gBAEFA,EACT,EAEMC,GACJ,6DAEIC,EAA4C,CAChD,UAAW7B,EACT,8EAAA,EAEF,OAAQA,EACN,0FAAA,EAEF,UAAWA,EACT,8FAAA,EAEF,UAAWA,EACT,sFAAA,EAEF,SAAUA,EACR,0FAAA,CAEJ,EAEa8B,GAAqB7C,GAAkB,CAClD,MAAMwC,EAAaxC,EAAM,KAAA,EAAO,YAAA,EAChC,OAAKwC,EAGDL,EAAOS,EAAmBJ,CAAU,EAC/BI,EAAkBJ,CAAU,EAEjC,cAAc,KAAKA,CAAU,EACxBI,EAAkB,UAEvB,aAAa,KAAKJ,CAAU,EACvBI,EAAkB,SAEvB,qBAAqB,KAAKJ,CAAU,EAC/BI,EAAkB,OAEvB,gBAAgB,KAAKJ,CAAU,EAC1BI,EAAkB,UAEvB,gBAAgB,KAAKJ,CAAU,EAC1BI,EAAkB,UAEpB,KApBE,IAqBX,EAEME,EAAiB9C,GAAmB,CACxC,GAAI,OAAOA,GAAU,SACnB,OAAO,OAAO,SAASA,CAAK,EAAIA,EAAQ,KAE1C,GAAI,OAAOA,GAAU,SAAU,CAC7B,MAAM0C,EAAU1C,EAAM,KAAA,EACtB,GAAI,CAAC0C,EACH,OAAO,KAET,MAAMF,EAAa,OAAOE,EAAQ,QAAQ,OAAQ,EAAE,EAAE,QAAQ,KAAM,GAAG,CAAC,EACxE,OAAO,OAAO,SAASF,CAAU,EAAIA,EAAa,IACpD,CACA,OAAO,IACT,EAEMO,GAAuB/C,GAAmB,CAC9C,MAAMgD,EAAUF,EAAc9C,CAAK,EACnC,OAAIgD,IAAY,KACPA,EAAQ,eAAe,QAAS,CACrC,sBAAuB,EACvB,sBAAuB,CAAA,CACxB,EAEC,OAAOhD,GAAU,SACZA,EAAM,KAAA,EAEX,OAAOA,GAAU,SACZA,EAAM,SAAA,EAER,EACT,EAEMiD,GAA0BlC,EAC9B,8FACF,EAEMmC,GAA2BnC,EAC/B,8EACF,EAEMoC,GAAyBpC,EAC7B,sFACF,EAEMqC,GAA8BrC,EAClC,kFACF,EAEMsC,GAAyBrD,GAAmB,CAChD,MAAMgD,EAAUF,EAAc9C,CAAK,EACnC,OAAIgD,IAAY,KACP,KAELA,EAAU,EACLC,GAELD,EAAU,GACLE,GAELF,EAAU,IACLG,GAEFC,EACT,EAEME,GAAkB,IAAI,KAAK,eAAe,QAAS,CACvD,IAAK,UACL,MAAO,UACP,KAAM,UACN,KAAM,UACN,OAAQ,UACR,OAAQ,GACR,SAAUC,CACZ,CAAC,EAEKC,GAAc,IAAI,KAAK,eAAe,QAAS,CACnD,IAAK,UACL,MAAO,UACP,KAAM,UACN,SAAUD,CACZ,CAAC,EAEKE,GAAc,IAAI,KAAK,eAAe,QAAS,CACnD,KAAM,UACN,OAAQ,UACR,OAAQ,GACR,SAAUF,CACZ,CAAC,EAEKG,EAAkB1D,GAA0B,CAChD,GAAI,CAACA,EACH,OAAO,KAET,MAAMC,EAAO,IAAI,KAAKD,CAAK,EAC3B,OAAO,OAAO,MAAMC,EAAK,QAAA,CAAS,EAAI,KAAOA,CAC/C,EAEM0D,EAAc3D,GAAmB,CACrC,MAAMC,EAAOyD,EAAe1D,CAAK,EACjC,GAAI,CAACC,EAAM,OAAO,KAClB,MAAM2D,EAAO,GAAG,OAAAN,GAAgB,OAAOrD,CAAI,EAAE,QAAQ,KAAM,GAAG,EAAC,KAAI,OAAA4D,IAC7DC,EAAWN,GAAY,OAAOvD,CAAI,EAClC8D,EAAWN,GAAY,OAAOxD,CAAI,EACxC,MAAO,CACL,KAAA2D,EACA,KAAME,GAAYF,EAClB,KAAMG,CAAA,CAEV,EAEMC,EAAkBhE,GAAmB,CACzC,MAAMiE,EAAYN,EAAW3D,CAAK,EAClC,OAAKiE,QAEF,OAAA,CAAK,UAAW7C,EAAgB,MAAO6C,EAAU,KAChD,SAAAC,EAAAA,KAAC,OAAA,CACC,SAAUlE,EACV,UAAU,yDAEV,SAAA,CAAAmE,EAAAA,IAAC,OAAA,CAAK,UAAU,WAAY,SAAAF,EAAU,KAAK,EAC1CA,EAAU,KACTE,MAAC,OAAA,CAAK,UAAW9C,GAAqB,SAAA4C,EAAU,KAAK,EACnD,IAAA,CAAA,CAAA,EAER,EAZqB,EAczB,EAGMG,EAAc,CAACpE,EAAeqE,IAAsB,CACxD,MAAM3B,EAAU1C,EAAM,KAAA,EACtB,GAAI,CAAC0C,GAAW2B,EAAY,GAAK3B,EAAQ,QAAU2B,EACjD,OAAO3B,EAET,MAAM4B,EAAY5B,EAAQ,MAAM,EAAG2B,EAAY,CAAC,EAAE,QAAA,EAClD,MAAO,GAAG,OAAAC,EAAS,IACrB,EAqBMC,GAA+D,CACnE,KAAM,CACJ,WAAY,SACZ,WAAY,SACZ,SAAU,QAAA,EAEZ,QAAS,CACP,WAAY,SACZ,WAAY,SACZ,SAAU,QAAA,CAEd,EAEMC,EAAa,CACjBC,EACAC,EACAC,IACG,CACH,MAAMC,EAAOL,GAAaE,CAAI,EAAEC,CAAI,EACpC,OAAOC,GAAA,MAAAA,EAAS,MAAQC,EAAK,YAAA,EAAgBA,CAC/C,EAEMC,EAAoB,CACxB7E,EACA8E,IAEI,OAAO9E,GAAU,UAAYA,EAAM,OAAO,YAAA,IAAkB,UACvD,UAEF8E,EAGHC,GAAgB/E,GACpBA,EAAM,QAAQ,uBAAwB,MAAM,EAOxCgF,EAA0B,GAAG,OAAA7D,EAAkB,uCAAsC,OAAAL,EAAc,wBAEnGmE,GAGF,CACF,KAAM,GAAG,OAAAD,EAAuB,0FAChC,KAAM,GAAG,OAAAA,EAAuB,kFAChC,OAAQ,GAAG,OAAAA,EAAuB,sFAClC,QAAS,GAAG,OAAAA,EAAuB,8EACnC,QAAS,GAAG,OAAAA,EAAuB,yEACrC,EAEME,EAA6B,GAAG,OAAAF,EAAuB,kFAEvDG,EAAwB1E,GAAwB,CACpD,MAAM2E,EAAW,KAAK,IAAI3E,CAAW,EAC/B4E,EAAe,KAAK,IAAI,EAAG,KAAK,MAAMD,GAAY,GAAK,IAAK,CAAC,EAC7DE,EAAO,KAAK,MAAMD,EAAgB,IAAQ,EAC1CE,EAAQ,KAAK,MAAOF,EAAgB,KAAY,EAAE,EAClDG,EAAUH,EAAe,GACzBI,EAAOzF,GAAkBA,EAAM,WAAW,SAAS,EAAG,GAAG,EAC/D,MAAO,CACL,KAAAsF,EACA,MAAAC,EACA,QAAAC,EACA,WAAYC,EAAIH,CAAI,EACpB,YAAaG,EAAIF,CAAK,EACtB,cAAeE,EAAID,CAAO,CAAA,CAE9B,EAEME,EAAmB,CACvB1F,EACA2F,IACG,CACH,MAAMP,EAAW,KAAK,IAAIpF,CAAK,EAAI,IACnC,GAAIoF,GAAY,IAAMA,GAAY,GAChC,OAAOO,EAAM,CAAC,EAEhB,MAAMC,EAAYR,EAAW,GAC7B,OAAIQ,IAAc,EACTD,EAAM,CAAC,EAEZC,GAAa,GAAKA,GAAa,EAC1BD,EAAM,CAAC,EAETA,EAAM,CAAC,CAChB,EAEME,GACJC,GAEIA,EAAM,OAAS,UACV,UAELA,EAAM,OAAS,UACV,UAEFA,EAAM,MAGTC,GAAuBD,GAA8B,CACzD,KAAM,CAAE,KAAAR,EAAM,MAAAC,EAAO,QAAAC,GAAYL,EAAqBW,EAAM,WAAW,EACvE,OAAIA,EAAM,OAAS,UACV,iBAAiB,OAAAR,EAAI,KAAI,OAAAI,EAAiBJ,EAAM,CACrD,OACA,MACA,MAAA,CACD,EAAC,KAAI,OAAAC,EAAK,KAAI,OAAAG,EAAiBH,EAAO,CACrC,MACA,OACA,OAAA,CACD,EAAC,KAAI,OAAAC,EAAO,KAAI,OAAAE,EAAiBF,EAAS,CACzC,SACA,SACA,OAAA,CACD,GAECM,EAAM,OAAS,UACV,gBAAgB,OAAAR,EAAI,KAAI,OAAAI,EAAiBJ,EAAM,CACpD,OACA,MACA,MAAA,CACD,EAAC,KAAI,OAAAC,EAAK,KAAI,OAAAG,EAAiBH,EAAO,CACrC,MACA,OACA,OAAA,CACD,EAAC,KAAI,OAAAC,EAAO,KAAI,OAAAE,EAAiBF,EAAS,CACzC,SACA,SACA,OAAA,CACD,GAEI,eAAe,OAAAF,EAAI,KAAI,OAAAI,EAAiBJ,EAAM,CACnD,OACA,MACA,MAAA,CACD,EAAC,KAAI,OAAAC,EAAK,KAAI,OAAAG,EAAiBH,EAAO,CACrC,MACA,OACA,OAAA,CACD,EAAC,KAAI,OAAAC,EAAO,KAAI,OAAAE,EAAiBF,EAAS,CACzC,SACA,SACA,OAAA,CACD,EACH,EAEMQ,EAAsB,CAC1BF,EACA7B,EACAgC,IACG,CACH,GAAI,CAAChC,EACH,OAAOgC,EAASA,EAAO,KAAA,EAAS,OAElC,GAAIH,EAAM,OAAS,UACjB,MAAO,gBAAgB,OAAA7B,EAAU,MAEnC,GAAI6B,EAAM,OAAS,UAAW,CAC5B,MAAMI,EACJJ,EAAM,QAAU,gBACZ,yBACA,2BACN,MAAO,GAAG,OAAAI,EAAI,WAAU,OAAAjC,EAAU,KACpC,CACA,MAAO,gBAAgB,OAAAA,EAAU,KACnC,EAEMkC,GAA0B,IAE1BC,GAA0BC,GAAmB,CACjD,MAAMjB,EAAW,KAAK,IAAIiB,CAAM,EAChC,GAAIjB,EAAWe,GACb,MAAO,eAET,KAAM,CAAE,KAAAb,EAAM,MAAAC,EAAO,QAAAC,CAAA,EAAYL,EAAqBC,CAAQ,EACxDkB,EAAkB,CAAA,EAcxB,OAbIhB,GACFgB,EAAM,KAAK,GAAG,OAAAhB,EAAI,KAAI,OAAAI,EAAiBJ,EAAM,CAAC,OAAQ,MAAO,MAAM,CAAC,EAAG,EAErEC,GACFe,EAAM,KACJ,GAAG,OAAAf,EAAK,KAAI,OAAAG,EAAiBH,EAAO,CAAC,MAAO,OAAQ,OAAO,CAAC,EAAC,EAG7DC,GAAWc,EAAM,OAAS,GAC5BA,EAAM,KACJ,GAAG,OAAAd,EAAO,KAAI,OAAAE,EAAiBF,EAAS,CAAC,SAAU,SAAU,OAAO,CAAC,EAAC,EAGrEc,EAAM,OAGJA,EAAM,MAAM,EAAG,CAAC,EAAE,KAAK,GAAG,EAFxB,cAGX,EAEMC,GAAsB,CAC1BC,EACAnG,EACAoG,IACG,CACH,GAAID,IAAW,YACb,OAAO,KAET,MAAMjG,EAAUmD,EAAerD,CAAQ,EACjCqG,EAAgBhD,EAAe+C,CAAc,EACnD,GAAI,CAAClG,GAAW,CAACmG,EACf,OAAO,KAET,MAAMC,EAAOD,EAAc,QAAA,EAAYnG,EAAQ,QAAA,EAC/C,GAAI,CAAC,OAAO,SAASoG,CAAI,EACvB,OAAO,KAET,GAAI,KAAK,IAAIA,CAAI,EAAIR,GACnB,MAAO,yBAET,MAAMS,EAASR,GAAuBO,CAAI,EAC1C,OAAKC,EAGED,EAAO,EACV,yBAAyB,OAAAC,GACzB,6BAA6B,OAAAA,GAJxB,wBAKX,EAIO,SAASC,GAAuB,CACrC,WAAAzG,EACA,SAAAC,EACA,OAAA4F,EACA,OAAAO,EACA,YAAAM,CACF,EAMG,CACD,MAAMJ,EAAgBK,EAAM,QAC1B,IAAMrD,EAAeoD,CAAW,EAChC,CAACA,CAAW,CAAA,EAERE,EAAcR,IAAW,YAEzB,CAACS,EAAKC,CAAM,EAAIH,EAAM,SAC1B,IAAML,GAAA,KAAAA,EAAiB,IAAI,IAAK,EAGlCK,EAAM,UAAU,IAAM,CACpB,GAAIC,EAAa,CACXN,GACFQ,EAAOR,CAAa,EAEtB,MACF,CACA,MAAMS,EAAS,IAAMD,EAAO,IAAI,IAAM,EACtCC,EAAA,EACA,MAAMC,EAAQ,OAAO,YAAYD,EAAQ,GAAM,EAC/C,MAAO,IAAM,OAAO,cAAcC,CAAK,CACzC,EAAG,CAACJ,EAAaN,EAAetG,EAAYC,CAAQ,CAAC,EAErD,MAAMC,EAAgBoG,GAAA,KAAAA,EAAiBO,EAEjCnB,EAAQiB,EAAM,QAClB,IAAM5G,GAAiBC,EAAYC,EAAUC,CAAa,EAC1D,CAACF,EAAYC,EAAUC,CAAa,CAAA,EAGhC2D,EAAY8C,EAAM,QAAQ,IAAMpD,EAAWtD,CAAQ,EAAG,CAACA,CAAQ,CAAC,EAChEgH,EAAiBN,EAAM,QAC3B,IAAMR,GAAoBC,EAAQnG,EAAUyG,CAAW,EACvD,CAACN,EAAQnG,EAAUyG,CAAW,CAAA,EAGhC,GAAIhB,EAAM,OAAS,UACjB,OACE5B,EAAAA,KAAC,OAAA,CACC,UAAW,GAAG,OAAAgB,EAA0B,qCACxC,MACEY,EAAM,SAAW,UACb,mBACA,0BAGN,SAAA,CAAA3B,EAAAA,IAAC5E,GAAA,CACC,UAAU,kDACV,cAAW,EAAA,CAAA,EAEb4E,EAAAA,IAAC,OAAA,CAAK,UAAU,WAAW,SAAA,YAAA,CAAU,CAAA,CAAA,CAAA,EAK3C,MAAMmD,EAAUzB,GAAoBC,CAAK,EACnCyB,EAAYtC,GAAsBqC,CAAO,EACzChB,EAAQnB,EAAqBW,EAAM,WAAW,EAC9C0B,EAAQzB,GAAoBD,CAAK,EACjCtG,EAAQ6H,EACV,GAAG,OAAAA,EAAc,MAAK,OAAArB,EAAoBF,EAAO7B,EAAWgC,CAAM,GAClED,EAAoBF,EAAO7B,EAAWgC,CAAM,EAChD,OACE/B,EAAAA,KAAC,OAAA,CACC,UAAW,GAAG,OAAAqD,EAAS,qCACvB,MAAA/H,EAEA,SAAA,CAAA2E,EAAAA,IAAC,OAAA,CAAK,UAAU,UAAW,SAAAqD,EAAM,EACjCtD,EAAAA,KAAC,OAAA,CACC,cAAW,GACX,UAAU,kDAEV,SAAA,CAAAA,EAAAA,KAAC,OAAA,CAAK,UAAU,2CACd,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,UAAU,2CACb,SAAAmC,EAAM,WACT,EACAnC,EAAAA,IAAC,OAAA,CAAK,UAAU,0DACb,SAAAuB,EAAiBY,EAAM,KAAM,CAAC,OAAQ,MAAO,MAAM,CAAC,CAAA,CACvD,CAAA,EACF,EACApC,EAAAA,KAAC,OAAA,CAAK,UAAU,2CACd,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,UAAU,2CACb,SAAAmC,EAAM,YACT,EACAnC,EAAAA,IAAC,OAAA,CAAK,UAAU,0DACb,SAAAuB,EAAiBY,EAAM,MAAO,CAAC,MAAO,OAAQ,OAAO,CAAC,CAAA,CACzD,CAAA,EACF,EACApC,EAAAA,KAAC,OAAA,CAAK,UAAU,2CACd,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,UAAU,2CACb,SAAAmC,EAAM,cACT,EACAnC,EAAAA,IAAC,OAAA,CAAK,UAAU,0DACb,SAAAuB,EAAiBY,EAAM,QAAS,CAAC,SAAU,SAAU,OAAO,CAAC,CAAA,CAChE,CAAA,CAAA,CACF,CAAA,CAAA,CAAA,EAEDe,EACClD,EAAAA,IAAC,OAAA,CAAK,UAAU,UAAW,WAAe,EACxC,IAAA,CAAA,CAAA,CAGV,CAEA,MAAMsD,GAGF,CACF,UAAW,GAAG,OAAAzC,EAAuB,0FACrC,UAAW,GAAG,OAAAA,EAAuB,8EACrC,OAAQ,GAAG,OAAAA,EAAuB,kFAClC,QAAS,GAAG,OAAAA,EAAuB,0EACnC,KAAME,CACR,EAEMwC,GAAuB,CAC3BpB,EACAqB,EACAC,IACG,CACH,KAAM,CAAE,KAAAtC,EAAM,MAAAC,EAAO,QAAAC,CAAA,EAAYc,EACjC,GAAI,CAAChB,GAAQ,CAACC,GAAS,CAACC,EACtB,OAAOmC,IAAY,YACf,GAAG,OAAAnD,EAAWoD,EAAY,YAAY,EAAC,kCACvC,yBAEN,MAAMC,EAAW,GAAG,OAAAvC,EAAI,KAAI,OAAAI,EAAiBJ,EAAM,CACjD,OACA,MACA,MAAA,CACD,GACKwC,EAAY,GAAG,OAAAvC,EAAK,KAAI,OAAAG,EAAiBH,EAAO,CACpD,MACA,OACA,OAAA,CACD,GACKwC,EAAc,GAAG,OAAAvC,EAAO,KAAI,OAAAE,EAAiBF,EAAS,CAC1D,SACA,SACA,OAAA,CACD,GACKwC,EAAS,GAAG,OAAAH,EAAQ,KAAI,OAAAC,EAAS,KAAI,OAAAC,GAC3C,OAAOJ,IAAY,YACf,GAAG,OAAAnD,EAAWoD,EAAY,YAAY,EAAC,kBAAiB,OAAAI,GACxD,aAAa,OAAAA,EACnB,EAEMC,GAAqB,CACzBN,EACAvH,EACA8H,EACA5B,EACAsB,EAAyB,SACtB,CACH,MAAMO,EAAuB,CAAA,EACvBC,EAAiBhI,EAAauD,EAAWvD,CAAU,EAAI,KACvDiI,EAAeH,EAAWvE,EAAWuE,CAAQ,EAAI,KAWvD,GAVIE,GACFD,EAAW,KAAK,WAAW,OAAAC,EAAe,KAAM,EAE9CC,GACFF,EAAW,KACTR,IAAY,YACR,cAAc,OAAAU,EAAa,MAC3B,kBAAkB,OAAAA,EAAa,KAAI,EAGvC/B,EAAO,CACT,MAAM0B,EAASN,GACbpB,EACAqB,IAAY,YAAc,YAAc,UACxCC,CAAA,EAEIpF,EACJmF,IAAY,YACRK,EAAO,QACL,IAAI,OACF,IAAI,OAAAjD,GACF,GAAG,OAAAP,EAAWoD,EAAY,YAAY,EAAC,iBAAA,EACxC,EAEH,qBAAA,EAEFI,EAAO,QAAQ,eAAgB,qBAAqB,EAC1DG,EAAW,KACTR,IAAY,OAAS,sBAAsB,OAAAK,GAAWxF,CAAA,CAE1D,CACA,OAAK2F,EAAW,OAKTA,EAAW,KAAK,IAAI,EAJlBR,IAAY,OACf,wDACA,gCAGR,EAWA,SAASW,GAAe,CACtB,mBAAAC,EACA,kBAAAC,EACA,eAAA/B,EACA,OAAAD,EACA,WAAAoB,CACF,EAAwB,OACtB,MAAMa,EAAmB1B,EAAM,QAC7B,IAAMrD,EAAe8E,CAAiB,EACtC,CAACA,CAAiB,CAAA,EAEdE,EAAoB3B,EAAM,QAC9B,IAAMrD,EAAe6E,CAAkB,EACvC,CAACA,CAAkB,CAAA,EAEf7B,EAAgBK,EAAM,QAC1B,IAAMrD,EAAe+C,CAAc,EACnC,CAACA,CAAc,CAAA,EAEXkC,EAAanC,IAAW,aAAeA,IAAW,WAClDoC,EAAcpC,IAAW,WACzBqC,EAAerC,IAAW,QAE1BsC,EAAiB/B,EAAM,QAAQ,IAAM,OACzC,OAAI8B,EACK,MAEFE,EAAAL,GAAA,KAAAA,EAAqBD,IAArB,KAAAM,EAAyC,IAClD,EAAG,CAACF,EAAcH,EAAmBD,CAAgB,CAAC,EAEhD,CAACnI,EAAe0I,CAAgB,EAAIjC,EAAM,SAAe,IACzD4B,GAAcjC,EACTA,MAEE,IACZ,EAEDK,EAAM,UAAU,IAAM,CACpB,GAAI4B,EAAY,CACVjC,GACFsC,EAAiBtC,CAAa,EAEhC,MACF,CACA,GAAI,CAACoC,EACH,OAEF,MAAM3B,EAAS,IAAM6B,EAAiB,IAAI,IAAM,EAChD7B,EAAA,EACA,MAAMC,EAAQ,OAAO,YAAYD,EAAQ,GAAM,EAC/C,MAAO,IAAM,OAAO,cAAcC,CAAK,CACzC,EAAG,CAACuB,EAAYjC,EAAeoC,CAAc,CAAC,EAE9C,MAAMG,EAAmBN,GAAcjC,EACnCA,EACApG,EACE4I,EAAaJ,EACf,KAAK,IAAI,EAAGG,EAAiB,UAAYH,EAAe,QAAA,CAAS,EACjE,KACEK,EAAgBpC,EAAM,QAAQ,IAC9B8B,EACK1D,EAAqB,CAAC,EAExB+D,IAAe,KAAO/D,EAAqB+D,CAAU,EAAI,KAC/D,CAACA,EAAYL,CAAY,CAAC,EAEvBO,EAASrC,EAAM,QAAQ,IAAMkC,EAAiB,cAAe,CACjEA,CAAA,CACD,EAEKtB,EACJkB,GAAgB,CAACC,EACb,OACAH,EACA,YACA,UAEArB,EACJuB,GAAgB,CAACC,EACb,OACAH,EACAC,EACE,YACA,YACFpC,IAAW,WACX,SACA,UAEAgB,EAAQqB,EACV,GAAG,OAAArE,EAAWoD,EAAY,YAAY,EAAC,kBACvCuB,EACAzB,GACEyB,EACAxB,IAAY,YAAc,YAAc,UACxCC,CAAA,EAEF,0CAEEyB,IACJN,EAAAR,GAAA,KAAAA,EAAsBC,IAAtB,KAAAO,EAA2C,OAEvCO,GAAqBT,EACvB,oCAAoC,OAAArE,EAAWoD,EAAY,WAAY,CAAE,MAAO,EAAA,CAAM,EAAC,wBACvFK,GACEN,EACA0B,GACA1B,IAAY,YAAclB,GAAA,KAAAA,EAAkB,OAAY2C,EACxDD,GAAA,KAAAA,EAAiB,OACjBvB,CAAA,EAGA2B,GAAkB,IAAM,CAC5B,GAAIZ,GAAcjC,GAAiBD,EACjC,OAAOzC,EAAeyC,CAAc,EAEtC,GAAIkC,EACF,OACExE,EAAAA,IAAC,OAAA,CAAK,UAAW/C,EAAgB,MAAM,2BACrC,SAAA+C,EAAAA,IAAC,OAAA,CAAK,UAAU,WAAW,SAAA,YAAA,CAAU,EACvC,EAGJ,GAAI,CAAC2E,EAAgB,CACnB,MAAMU,EACJhD,IAAW,QACP,YACAA,IAAW,WACX,WACA,aACAhH,GACJgH,IAAW,QACP,GAAG,OAAAhC,EAAWoD,EAAY,YAAY,EAAC,kBACvCpB,IAAW,WACX,0CACA,0BACN,OACErC,EAAAA,IAAC,OAAA,CAAK,UAAW/C,EAAgB,MAAA5B,GAC/B,SAAA2E,EAAAA,IAAC,OAAA,CAAK,UAAU,WAAY,SAAAqF,CAAAA,CAAY,EAC1C,CAEJ,CACA,MAAMA,EAAchD,IAAW,WAAa,WAAa,aACzD,OACErC,EAAAA,IAAC,OAAA,CACC,UAAW/C,EACX,MAAO,GAAG,OAAAoD,EAAWoD,EAAY,YAAY,EAAC,qBAE9C,SAAAzD,EAAAA,IAAC,OAAA,CAAK,UAAU,WAAY,SAAAqF,CAAA,CAAY,CAAA,CAAA,CAG9C,EAEA,OACEtF,EAAAA,KAAC,MAAA,CAAI,UAAU,kCACZ,SAAA,CAAAqF,GAAA,EACDrF,EAAAA,KAAC,OAAA,CACC,UAAW,GAAG,OAAAuD,GAAqBH,CAAO,EAAC,qCAC3C,MAAOgC,GAEP,SAAA,CAAAnF,EAAAA,IAAC,OAAA,CAAK,UAAU,UAAW,SAAAqD,EAAM,EAChC2B,EACCjF,EAAAA,KAAC,OAAA,CACC,cAAW,GACX,UAAU,kDAEV,SAAA,CAAAA,EAAAA,KAAC,OAAA,CAAK,UAAU,2CACd,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,UAAU,2CACb,SAAAgF,EAAc,WACjB,QACC,OAAA,CAAK,UAAU,0DACb,SAAAzD,EAAiByD,EAAc,KAAM,CACpC,OACA,MACA,MAAA,CACD,CAAA,CACH,CAAA,EACF,EACAjF,EAAAA,KAAC,OAAA,CAAK,UAAU,2CACd,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,UAAU,2CACb,SAAAgF,EAAc,YACjB,QACC,OAAA,CAAK,UAAU,0DACb,SAAAzD,EAAiByD,EAAc,MAAO,CACrC,MACA,OACA,OAAA,CACD,CAAA,CACH,CAAA,EACF,EACAjF,EAAAA,KAAC,OAAA,CAAK,UAAU,2CACd,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,UAAU,2CACb,SAAAgF,EAAc,cACjB,QACC,OAAA,CAAK,UAAU,0DACb,SAAAzD,EAAiByD,EAAc,QAAS,CACvC,SACA,SACA,OAAA,CACD,CAAA,CACH,CAAA,CAAA,CACF,CAAA,CAAA,CAAA,EAGFhF,EAAAA,IAAC,OAAA,CAAK,UAAU,iDACb,SAAAqD,CAAA,CACH,CAAA,CAAA,CAAA,CAEJ,EACF,CAEJ,CAEA,SAAwBiC,GACtBC,EACAC,EAA0B,OACJ,CAoatB,MAnamC,CACjC,CACE,OAAQ,QACR,GAAI,SACJ,WAAaC,GAAQ,CAEnB,MAAMC,EADUhF,EAAkB+E,EAAI,KAAMD,CAAW,IAEzC,UACRC,EAAI,YAAcA,EAAI,aAAeA,EAAI,IACzCA,EAAI,aAAeA,EAAI,YAAcA,EAAI,IAC/C,OAAI,OAAOC,GAAa,SACfA,EAEqBA,GAAa,KAClC,GAEF,OAAOA,CAAQ,CACxB,EACA,KAAM,CACJ,MAAO,+BACP,SAAU,OACV,SAAU,SACV,cACE,8EACF,gBAAiB,4CAAA,EAEnB,KAAOC,GAAM,aACX,MAAMF,EAAME,EAAE,IAAI,SACZC,EAAUlF,EAAkB+E,EAAI,KAAMD,CAAW,EACjD3J,GAAS8J,EAAE,SAAA,GAAsB,IAAI,KAAA,EACrChF,EACJiF,IAAY,WACPC,GAAAjB,EAAAa,EAAI,aAAJ,KAAAb,EACAa,EAAI,cADJ,KAAAI,EAED,OAAOJ,EAAI,GAAG,GACbK,GAAAC,EAAAN,EAAI,cAAJ,KAAAM,EACAN,EAAI,aADJ,KAAAK,EAED,OAAOL,EAAI,GAAG,EACdO,EAAUnK,GAAS8E,GAAY,GAC/BsF,EAAeD,EAAQ,MAAM,KAAK,EAClCE,EAAaD,EAAeA,EAAa,CAAC,EAAID,EACpD,OACEhG,EAAAA,IAAC,OAAA,CAAK,UAAW,GAAG,OAAA7C,GAAgB,mBAAmB,MAAO6I,EAC5D,SAAAhG,EAAAA,IAAC,OAAA,CAAK,UAAU,WAAY,WAAW,EACzC,CAEJ,CAAA,EAEF,CACE,OAAQ,GAAG,OAAAK,EAAWmF,EAAa,YAAY,EAAC,WAChD,YAAa,YACb,KAAM,CACJ,MAAO,2BACP,SAAU,SACV,SAAU,QACV,cAAe,mBAAA,EAEjB,KAAM,CAAC,CAAE,IAAAC,KAAU,SACjB,MAAMU,GACHN,GAAAjB,EAAAa,EAAI,SAAS,aAAb,KAAAb,EACAa,EAAI,SAAS,YADb,KAAAI,EAEAJ,EAAI,SAAS,QACVW,EACJ,OAAOD,GAAe,SAClBA,EACA,OAAOA,GAAe,UAAYA,EAAW,KAAA,EAC7C,OAAOA,CAAU,EACjB,IACN,GAAI,CAAC,OAAO,SAASC,CAAS,EAC5B,OAAOpG,EAAAA,IAAC,OAAA,CAAK,UAAU,wBAAwB,SAAA,IAAC,EAElD,MAAMqG,EAAKD,EACLE,EAAOf,EAAMc,CAAE,EACfhD,GACHiD,GAAA,YAAAA,EAAM,QACNA,GAAA,YAAAA,EAAM,qBACNA,GAAA,YAAAA,EAAM,WACP,OAAOD,CAAE,EACLhL,EAAQgI,EAAM,KAAA,GAAU,OAAOgD,CAAE,EACvC,OACErG,EAAAA,IAACuG,EAAA,CACC,WAAYF,EACZ,gBAAe,GACf,MAAAhL,EACA,UAAW,GAAG,OAAAgC,GAAiB,KAAI,OAAAN,EAAmB,iBAEtD,eAAC,OAAA,CAAK,UAAU,WAAY,SAAAkD,EAAYoD,EAAO,EAAE,CAAA,CAAE,CAAA,CAAA,CAGzD,CAAA,EAEF,CACE,OAAQ,WACR,YAAa,QACb,KAAM,CACJ,MAAO,2BACP,SAAU,OACV,SAAU,QACV,cAAe,WAAA,EAEjB,KAAOsC,GAAM,SACX,MAAMa,EAAIb,EAAE,SAAA,GAAsB,GAC5Bc,EAAUxG,EAAYuG,EAAG,EAAE,EAC3Bf,EAAME,EAAE,IAAI,SACZzC,EAAiBd,GACrBqD,EAAI,QACJb,EAAAa,EAAI,WAAJ,KAAAb,EAAgB,QAChBiB,EAAAJ,EAAI,eAAJ,KAAAI,EAAoB,MAAA,EAEtB,OACE9F,EAAAA,KAAC,MAAA,CAAI,UAAU,kCACb,SAAA,CAAAC,EAAAA,IAAC,OAAA,CACC,MAAOwG,EACP,UAAW,GAAG,OAAApJ,GAAe,sBAE7B,SAAA4C,EAAAA,IAAC,OAAA,CACC,UAAU,sDACV,MAAO,CACL,QAAS,cACT,gBAAiB,EACjB,gBAAiB,WACjB,SAAU,QAAA,EAGX,SAAAyG,CAAA,CAAA,CACH,CAAA,EAEDvD,EACClD,EAAAA,IAAC,OAAA,CAAK,UAAWxB,GAA0B,WAAe,EACxD,IAAA,EACN,CAEJ,CAAA,EAEF,CACE,OAAQ,cACR,YAAa,YACb,KAAM,CACJ,MAAO,2BACP,SAAU,OACV,SAAU,OAAA,EAEZ,KAAM,CAAC,CAAE,IAAAiH,KAAU,CACjB,MAAMiB,EAAM,MAAM,QAAQjB,EAAI,SAAS,SAAS,EAC5CA,EAAI,SAAS,UACb,OAAOA,EAAI,SAAS,kBAAqB,SACzC,CAACA,EAAI,SAAS,gBAAgB,EAC9B,CAAA,EACJ,GAAI,CAACiB,EAAI,OACP,OAAO1G,EAAAA,IAAC,OAAA,CAAK,UAAU,wBAAwB,SAAA,IAAC,EAElD,MAAM2G,EAASD,EAAI,IAAKL,GAAA,WAAQ,OAC9B,GAAAA,EACA,QACEzB,EAAAW,EAAMc,CAAE,IAAR,YAAAzB,EAAW,SACXiB,EAAAN,EAAMc,CAAE,IAAR,YAAAR,EAAW,sBACXE,EAAAR,EAAMc,CAAE,IAAR,YAAAN,EAAW,WACX,OAAOM,CAAE,CAAA,EACX,EACIO,EAAUD,EAAO,IAAKE,GAASA,EAAK,KAAK,EAAE,KAAK,IAAI,EAC1D,OACE7G,EAAAA,IAAC,MAAA,CACC,UAAU,wDACV,MAAO4G,EAEN,WAAO,IAAI,CAAC,CAAE,GAAAP,EAAI,MAAAhD,KACjBrD,EAAAA,IAACuG,EAAA,CAEC,WAAYF,EACZ,gBAAe,GACf,UAAW,GAAG,OAAA/I,GAAkB,KAAI,OAAAP,EAAmB,iBAEvD,eAAC,OAAA,CAAK,UAAU,WAAY,SAAAkD,EAAYoD,EAAO,EAAE,CAAA,CAAE,CAAA,EAL9CgD,CAAA,CAOR,CAAA,CAAA,CAGP,CAAA,EAEF,CACE,OAAQ,SACR,YAAa,SACb,KAAM,CACJ,MAAO,6BACP,SAAU,SACV,SAAU,SACV,cAAe,mBAAA,EAEjB,KAAOV,GAAM,CACX,MAAM9J,EAAQ8J,EAAE,SAAA,GAAsB,GACtC,GAAI,CAAC9J,EACH,MAAO,GAET,MAAMiL,EAAa3I,GAAoBtC,CAAK,EAC5C,OAAKiL,EAGE9G,EAAAA,IAAC,OAAA,CAAK,UAAW8G,EAAa,SAAAjL,EAAM,EAFlCmE,EAAAA,IAAC,OAAA,CAAK,UAAWzC,EAAqB,SAAA1B,EAAM,CAGvD,CAAA,EAEF,CACE,OAAQ,YACR,YAAa,WACb,KAAM,CACJ,MAAO,+BACP,SAAU,SACV,SAAU,UACV,cAAe,mBAAA,EAEjB,KAAO8J,GAAM,CACX,MAAM9J,EAAQ8J,EAAE,SAAA,GAAsB,GACtC,GAAI,CAAC9J,EAAM,OACT,MAAO,GAET,MAAMmK,EAAU1H,GAAuBzC,CAAK,EAEtCuH,EADahF,GAAsBvC,CAAK,GACd,GAAG,OAAA0B,EAAkB,gBACrD,OACEyC,EAAAA,IAAC,OAAA,CAAK,UAAAoD,EAAsB,MAAO4C,EAChC,SAAAA,EACH,CAEJ,CAAA,EAEF,CACE,OAAQ,SACR,YAAa,aACb,KAAM,CACJ,MAAO,gCACP,SAAU,SACV,SAAU,OACV,cAAe,sCAAA,EAEjB,KAAOL,GAAM9F,EAAe8F,EAAE,UAAkB,CAAA,EAElD,CACE,OAAQ,UACR,YAAa,WACb,KAAM,CACJ,MAAO,gCACP,SAAU,QACV,SAAU,UACV,cAAe,sCAAA,EAEjB,KAAOA,GAAM,WACX,MAAMzJ,EAAWyJ,EAAE,SAAA,EACbF,EAAME,EAAE,IAAI,SACZoB,EACJ/G,EAAAA,IAAC0C,GAAA,CACC,YAAYkC,EAAAa,EAAI,aAAJ,KAAAb,EAAkB,OAC9B,UAAUiB,EAAAJ,EAAI,WAAJ,KAAAI,EAAgB,OAC1B,OAAQ3J,EACR,OAAQuJ,EAAI,OACZ,aAAaM,EAAAN,EAAI,eAAJ,KAAAM,EAAoB,MAAA,CAAA,EAGrC,GAAI,CAAC7J,EACH,OAAO6K,EAET,MAAMC,EAAWnH,EAAe3D,CAAQ,EACxC,OAAI,OAAO8K,GAAa,SACjBA,EAIHjH,EAAAA,KAAC,MAAA,CAAI,UAAU,kCACZ,SAAA,CAAAiH,EAAWhH,EAAAA,IAAC,OAAA,CAAM,SAAAgH,CAAA,CAAS,EAAU,KACrCD,CAAA,EACH,EANOA,EAUThH,EAAAA,KAAC,MAAA,CAAI,UAAU,kCACZ,SAAA,CAAAiH,EACAD,CAAA,EACH,CAEJ,CAAA,EAEF,CACE,OAAQ,mBACR,YAAa,eACb,KAAM,CACJ,MAAO,gCACP,SAAU,QACV,SAAU,UACV,cAAe,sCAAA,EAEjB,KAAOpB,GAAM,WACX,MAAMF,EAAME,EAAE,IAAI,SACZC,EAAUlF,EAAkB+E,EAAI,KAAMD,CAAW,EACvD,OACExF,EAAAA,IAACmE,GAAA,CACC,oBAAoBS,EAAAa,EAAI,iBAAJ,KAAAb,EAAsB,OAC1C,mBAAmBiB,EAAAJ,EAAI,aAAJ,KAAAI,EAAkB,OACrC,gBAAgBE,EAAAJ,EAAE,SAAA,IAAF,KAAAI,EAA+B,OAC/C,OAAQN,EAAI,OACZ,WAAYG,CAAA,CAAA,CAGlB,CAAA,EAEF,CACE,OAAQ,MACR,YAAa,YACb,KAAM,CACJ,MAAO,6BACP,SAAU,SACV,SAAU,SACV,cAAe,mBAAA,EAEjB,KAAOD,GAAM,CAEX,MAAMpH,GADQoH,EAAE,SAAA,GAAsB,IAChB,KAAA,EACtB,GAAI,CAACpH,EACH,MAAO,GAGT,MAAM6E,EADa1E,GAAkBH,CAAO,GACZ,GAAG,OAAAhB,EAAkB,gBACrD,OACEyC,EAAAA,IAAC,OAAA,CAAK,UAAAoD,EAAsB,MAAO7E,EAChC,SAAAA,EACH,CAEJ,CAAA,EAEF,CACE,OAAQ,QACR,YAAa,iBACb,KAAM,CACJ,MAAO,8BACP,SAAU,OACV,SAAU,SACV,cAAe,mBAAA,EAEjB,KAAM,CAAC,CAAE,IAAAkH,KAAU,SACjB,MAAMwB,GAAOrC,EAAAa,EAAI,SAAS,iBAAb,KAAAb,EAA+B,GACtCrG,EAAU0I,EAAK,KAAA,EACfC,EAAa3I,EAAQ,MAAM,SAAS,EAAE,OAAO,OAAO,EAAE,CAAC,GAAKA,EAC5DkI,EAAUxG,EAAYiH,EAAY,EAAE,EACpCC,GAAOtB,EAAAJ,EAAI,SAAS,sBAAb,KAAAI,EAAoC,OACjD,OAAOsB,EACLnH,EAAAA,IAAC,IAAA,CACC,KAAMmH,EACN,OAAO,SACP,IAAI,sBACJ,UAAW1J,EACX,MAAOwJ,EAEP,SAAAjH,EAAAA,IAAC,OAAA,CAAK,UAAU,WAAY,SAAAyG,CAAA,CAAQ,CAAA,CAAA,EAGtCzG,EAAAA,IAAC,OAAA,CAAK,MAAOiH,EAAM,UAAWzJ,EAC5B,SAAAwC,EAAAA,IAAC,OAAA,CAAK,UAAU,WAAY,SAAAyG,CAAA,CAAQ,EACtC,CAEJ,CAAA,EAEF,CACE,OAAQ,QACR,YAAa,eACb,KAAM,CACJ,MAAO,8BACP,SAAU,OACV,SAAU,SACV,cAAe,mBAAA,EAEjB,KAAM,CAAC,CAAE,IAAAhB,KAAU,SACjB,MAAMwB,GAAOrC,EAAAa,EAAI,SAAS,eAAb,KAAAb,EAA6B,GACpCrG,EAAU0I,EAAK,KAAA,EACfC,EAAa3I,EAAQ,MAAM,SAAS,EAAE,OAAO,OAAO,EAAE,CAAC,GAAKA,EAC5DkI,EAAUxG,EAAYiH,EAAY,EAAE,EACpCC,GAAOtB,EAAAJ,EAAI,SAAS,oBAAb,KAAAI,EAAkC,OAC/C,OAAOsB,EACLnH,EAAAA,IAAC,IAAA,CACC,KAAMmH,EACN,OAAO,SACP,IAAI,sBACJ,UAAW1J,EACX,MAAOwJ,EAEP,SAAAjH,EAAAA,IAAC,OAAA,CAAK,UAAU,WAAY,SAAAyG,CAAA,CAAQ,CAAA,CAAA,EAGtCzG,EAAAA,IAAC,OAAA,CAAK,MAAOiH,EAAM,UAAWzJ,EAC5B,SAAAwC,EAAAA,IAAC,OAAA,CAAK,UAAU,WAAY,SAAAyG,CAAA,CAAQ,EACtC,CAEJ,CAAA,EAEF,CACE,OAAQ,KACR,YAAa,oBACb,KAAM,CACJ,MAAO,+BACP,SAAU,OACV,SAAU,UACV,cAAe,6CACf,gBAAiB,0BAAA,EAEnB,KAAOd,GAAM,CACX,MAAMyB,EAAMzB,EAAE,SAAA,EACd,GAAIyB,GAAQ,MAA8B,OAAOA,GAAQ,UAAY,CAACA,EAAI,OACxE,MAAO,GAET,MAAMpB,EAAUpH,GAAoBwI,CAAG,EACvC,GAAI,CAACpB,EACH,MAAO,GAGT,MAAM5C,EADalE,GAAsBkI,CAAG,GACZ7J,EAChC,aACG,OAAA,CAAK,UAAA6F,EAAsB,MAAO,GAAG,OAAA4C,EAAO,OAC1C,SAAAA,CAAA,CACH,CAEJ,CAAA,CACF,CAGJ","x_google_ignoreList":[0]}