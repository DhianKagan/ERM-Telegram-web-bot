!function(){function t(r){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(r)}function r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,n,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function c(r,o,a,i){var c=o&&o.prototype instanceof s?o:s,l=Object.create(c.prototype);return e(l,"_invoke",function(r,e,o){var a,i,c,s=0,l=o||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(r,e){return a=r,i=0,c=t,d.n=e,u}};function p(r,e){for(i=r,c=e,n=0;!f&&s&&!o&&n<l.length;n++){var o,a=l[n],p=d.p,m=a[2];r>3?(o=m===e)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=r<2&&p<a[1])?(i=0,d.v=e,d.n=a[1]):p<m&&(o=r<3||a[0]>e||e>m)&&(a[4]=r,a[5]=e,d.n=m,i=0))}if(o||r>1)return u;throw f=!0,e}return function(o,l,m){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&p(l,m),i=l,c=m;(n=i<2?t:c)||!f;){a||(i?i<3?(i>1&&(d.n=-1),p(i,c)):d.n=c:d.v=c);try{if(s=2,a){if(i||(o="next"),n=a[o]){if(!(n=n.call(a,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,i<2&&(i=0)}else 1===i&&(n=a.return)&&n.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=t}else if((n=(f=d.n<0)?c:r.call(e,d))!==u)break}catch(n){a=t,i=1,c=n}finally{s=1}}return{value:n,done:f}}}(r,a,i),!0),l}var u={};function s(){}function l(){}function f(){}n=Object.getPrototypeOf;var d=[][a]?n(n([][a]())):(e(n={},a,function(){return this}),n),p=f.prototype=s.prototype=Object.create(d);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,e(t,i,"GeneratorFunction")),t.prototype=Object.create(p),t}return l.prototype=f,e(p,"constructor",f),e(f,"constructor",l),l.displayName="GeneratorFunction",e(f,i,"GeneratorFunction"),e(p),e(p,i,"Generator"),e(p,a,function(){return this}),e(p,"toString",function(){return"[object Generator]"}),(r=function(){return{w:c,m:m}})()}function e(t,r,n,o){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}e=function(t,r,n,o){function i(r,n){e(t,r,function(t){return this._invoke(r,n,t)})}r?a?a(t,r,{value:n,enumerable:!o,configurable:!o,writable:!o}):t[r]=n:(i("next",0),i("throw",1),i("return",2))},e(t,r,n,o)}function n(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),e.push.apply(e,n)}return e}function o(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?n(Object(e),!0).forEach(function(r){a(t,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):n(Object(e)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})}return t}function a(r,e,n){return(e=function(r){var e=function(r,e){if("object"!=t(r)||!r)return r;var n=r[Symbol.toPrimitive];if(void 0!==n){var o=n.call(r,e||"default");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(r)}(r,"string");return"symbol"==t(e)?e:e+""}(e))in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function i(t,r,e,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}function c(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,o,a,i,c=[],u=!0,s=!1;try{if(a=(e=e.call(t)).next,0===r){if(Object(e)!==e)return;u=!1}else for(;!(u=(n=a.call(e)).done)&&(c.push(n.value),c.length!==r);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=e.return&&(i=e.return(),Object(i)!==i))return}finally{if(s)throw o}}return c}}(t,r)||function(t,r){if(t){if("string"==typeof t)return u(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?u(t,r):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}System.register(["./index-legacy-Cw3EU-FN.js","./vendor-legacy-3V6tX1hl.js","./App-legacy-92jDSsGS.js","./index-legacy-D5EkVq5x.js"],function(t,e){"use strict";var n,u,s,l,f,d,p,m;return{setters:[function(t){n=t.j,u=t._},function(t){s=t.R,l=t.b},function(t){f=t.B,d=t.h,p=t.s},function(t){m=t.z}],execute:function(){function y(t){var r=t.onChange,e=c(s.useState(""),2),o=e[0],a=e[1],i=c(s.useState(""),2),u=i[0],l=i[1];return n.jsxs("form",{onSubmit:function(t){t.preventDefault(),r&&r({from:o,to:u})},className:"flex flex-wrap items-end gap-2",children:[n.jsx("input",{type:"date",id:"report-from",name:"reportFrom",value:o,onChange:function(t){return a(t.target.value)},className:"focus:border-accentPrimary focus:ring-brand-200 rounded-lg border border-gray-300 bg-gray-100 px-3 py-2 text-sm text-gray-800 focus:ring focus:outline-none"}),n.jsx("input",{type:"date",id:"report-to",name:"reportTo",value:u,onChange:function(t){return l(t.target.value)},className:"focus:border-accentPrimary focus:ring-brand-200 rounded-lg border border-gray-300 bg-gray-100 px-3 py-2 text-sm text-gray-800 focus:ring focus:outline-none"}),n.jsx(f,{type:"submit",children:"Применить"})]})}function b(t){var r=t.count,e=t.time;return n.jsxs("div",{className:"flex space-x-4",children:[n.jsxs("div",{className:"rounded border p-2",children:["Всего задач: ",r]}),n.jsxs("div",{className:"rounded border p-2",children:["Затрачено минут: ",e]})]})}t("default",function(){var t=c(s.useState({count:0,time:0}),2),e=t[0],u=t[1],l=c(s.useState({}),2),m=l[0],v=l[1],h=c(s.useState({pdf:!1,xlsx:!1}),2),x=h[0],j=h[1],w=function(t){var r=new URLSearchParams;t.from&&r.set("from",t.from),t.to&&r.set("to",t.to);var e=r.toString();return e?"?".concat(e):""},S=function(t,r){if(!t)return r;var e=t.match(/filename\*?=(?:UTF-8'')?"?([^";]+)/i);if(e&&e[1])try{return decodeURIComponent(e[1])}catch(n){return e[1]}return r},O=s.useCallback(function(){var t,e=(t=r().m(function t(e){var n,i,c,u,s,l,f,y,b;return r().w(function(t){for(;;)switch(t.p=t.n){case 0:return j(function(t){return o(o({},t),{},a({},e,!0))}),t.p=1,n=w(m),i="pdf"===e?"/api/v1/tasks/report.pdf".concat(n):"/api/v1/tasks/report.xlsx".concat(n),t.n=2,d(i,{noRedirect:!0});case 2:if((c=t.v).ok){t.n=3;break}throw new Error("HTTP ".concat(c.status));case 3:return t.n=4,c.blob();case 4:u=t.v,s=c.headers.get("Content-Disposition"),l=S(s,"pdf"===e?"tasks-report.pdf":"tasks-report.xlsx"),f=window.URL.createObjectURL(u),(y=document.createElement("a")).href=f,y.download=l,document.body.appendChild(y),y.click(),y.remove(),window.URL.revokeObjectURL(f),t.n=6;break;case 5:t.p=5,b=t.v,console.error("report download error",b),p("Не удалось скачать отчёт","error");case 6:return t.p=6,j(function(t){return o(o({},t),{},a({},e,!1))}),t.f(6);case 7:return t.a(2)}},t,null,[[1,5,6,7]])}),function(){var r=this,e=arguments;return new Promise(function(n,o){var a=t.apply(r,e);function c(t){i(a,n,o,c,u,"next",t)}function u(t){i(a,n,o,c,u,"throw",t)}c(void 0)})});return function(t){return e.apply(this,arguments)}}(),[m]),k=s.useCallback(function(t){d("/api/v1/tasks/report/summary".concat(w(t))).then(function(t){return t.ok?t.json():{count:0,time:0}}).then(u)},[]);return s.useEffect(function(){k({})},[k]),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"space-y-4 rounded-lg bg-white p-4 shadow-sm",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Отчёты"}),n.jsx(y,{onChange:function(t){var r=function(t){var r={};if(null!=t&&t.from){var e=t.from.trim();e&&(r.from=e)}if(null!=t&&t.to){var n=t.to.trim();n&&(r.to=n)}return r}(t);v(r),k(r)}}),n.jsx(b,{count:e.count,time:e.time}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx(f,{onClick:function(){return O("pdf")},disabled:x.pdf,children:x.pdf?"Формируем PDF...":"Скачать PDF"}),n.jsx(f,{variant:"outline",onClick:function(){return O("xlsx")},disabled:x.xlsx,children:x.xlsx?"Формируем Excel...":"Скачать Excel"})]})]}),n.jsxs("div",{className:"space-y-4 rounded-lg bg-white p-4 shadow-sm",children:[n.jsx("h3",{className:"text-lg font-semibold",children:"Динамика задач"}),n.jsx(g,{filters:m})]})]})});var v=s.lazy(function(){return u(function(){return e.import("./react-apexcharts.min-legacy-DAUu-INF.js").then(function(t){return t.r})},void 0)}),h=function(t){var r=new URLSearchParams;null!=t&&t.from&&r.set("from",t.from),null!=t&&t.to&&r.set("to",t.to);var e=r.toString();return e?"?".concat(e):""};function g(t){var r=t.filters,e=c(l.useState([{data:[]}]),2),o=e[0],a=e[1],i=c(l.useState([]),2),u=i[0],f=i[1],p=m().theme;l.useEffect(function(){var t=!1;return d("/api/v1/tasks/report/chart".concat(h(r))).then(function(t){return t.ok?t.json():{data:[],labels:[]}}).then(function(r){var e=r.data,n=r.labels;if(!t){var o=Array.isArray(e)?e.map(function(t){var r=Number(t);return Number.isFinite(r)?r:0}):[],i=Array.isArray(n)?n.map(function(t){return String(t)}):[];a([{data:o}]),f(i)}}).catch(function(){t||(a([{data:[]}]),f([]))}),function(){t=!0}},[null==r?void 0:r.from,null==r?void 0:r.to]);var y={chart:{height:200,type:"line",fontFamily:"Inter, sans-serif",toolbar:{show:!1},background:"dark"===p?"#24303F":void 0},colors:["#2563EB"],stroke:{width:2,curve:"smooth"},xaxis:{categories:u,labels:{style:{colors:"dark"===p?"#DEE4EE":"#6B7280"}}},yaxis:{labels:{style:{colors:"dark"===p?"#DEE4EE":"#6B7280"}}}};return n.jsx(s.Suspense,{fallback:n.jsx("div",{children:"Загрузка..."}),children:n.jsx(v,{series:o,options:y,type:"line",height:200})})}}}})}();
//# sourceMappingURL=Reports-legacy-B_d2JiCT.js.map
