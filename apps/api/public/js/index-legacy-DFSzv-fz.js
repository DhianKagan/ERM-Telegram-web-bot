!function(){var e=["title","titleId"],t=["title","titleId"],r=["title","titleId"],n=["title","titleId"],a=["title","titleId"],l=["title","titleId"],i=["title","titleId"],s=["title","titleId"],o=["title","titleId"],c=["title","titleId"],u=["title","titleId"],d=["__scopeTabs","value","onValueChange","defaultValue","orientation","dir","activationMode"],m=["__scopeTabs","loop"],f=["__scopeTabs","value","disabled"],v=["__scopeTabs","value","forceMount","children"],h=["className"],p=["className"],x=["className"],g=["className"],b=["value","displayValue","copyHint","copiedHint","onCopy","className","disabled"],y=["telegram_id"];function j(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=C(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,l=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw l}}}}function N(e,t,r,n,a,l,i){try{var s=e[l](i),o=s.value}catch(e){return void r(e)}s.done?t(o):Promise.resolve(o).then(n,a)}function k(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var l=e.apply(t,r);function i(e){N(l,n,a,i,s,"next",e)}function s(e){N(l,n,a,i,s,"throw",e)}i(void 0)})}}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,l,i,s=[],o=!0,c=!1;try{if(l=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;o=!1}else for(;!(o=(n=l.call(r)).done)&&(s.push(n.value),s.length!==t);o=!0);}catch(e){c=!0,a=e}finally{try{if(!o&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return s}}(e,t)||C(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||C(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){if(e){if("string"==typeof e)return S(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function E(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function l(r,n,a,l){var o=n&&n.prototype instanceof s?n:s,c=Object.create(o.prototype);return T(c,"_invoke",function(r,n,a){var l,s,o,c=0,u=a||[],d=!1,m={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,r){return l=t,s=0,o=e,m.n=r,i}};function f(r,n){for(s=r,o=n,t=0;!d&&c&&!a&&t<u.length;t++){var a,l=u[t],f=m.p,v=l[2];r>3?(a=v===n)&&(o=l[(s=l[4])?5:(s=3,3)],l[4]=l[5]=e):l[0]<=f&&((a=r<2&&f<l[1])?(s=0,m.v=n,m.n=l[1]):f<v&&(a=r<3||l[0]>n||n>v)&&(l[4]=r,l[5]=n,m.n=v,s=0))}if(a||r>1)return i;throw d=!0,n}return function(a,u,v){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&f(u,v),s=u,o=v;(t=s<2?e:o)||!d;){l||(s?s<3?(s>1&&(m.n=-1),f(s,o)):m.n=o:m.v=o);try{if(c=2,l){if(s||(a="next"),t=l[a]){if(!(t=t.call(l,o)))throw TypeError("iterator result is not an object");if(!t.done)return t;o=t.value,s<2&&(s=0)}else 1===s&&(t=l.return)&&t.call(l),s<2&&(o=TypeError("The iterator does not provide a '"+a+"' method"),s=1);l=e}else if((t=(d=m.n<0)?o:r.call(n,m))!==i)break}catch(t){l=e,s=1,o=t}finally{c=1}}return{value:t,done:d}}}(r,a,l),!0),c}var i={};function s(){}function o(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(T(t={},n,function(){return this}),t),d=c.prototype=s.prototype=Object.create(u);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,T(e,a,"GeneratorFunction")),e.prototype=Object.create(d),e}return o.prototype=c,T(d,"constructor",c),T(c,"constructor",o),o.displayName="GeneratorFunction",T(c,a,"GeneratorFunction"),T(d),T(d,a,"Generator"),T(d,n,function(){return this}),T(d,"toString",function(){return"[object Generator]"}),(E=function(){return{w:l,m:m}})()}function T(e,t,r,n){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}T=function(e,t,r,n){function l(t,r){T(e,t,function(e){return this._invoke(t,r,e)})}t?a?a(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(l("next",0),l("throw",1),l("return",2))},T(e,t,r,n)}function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach(function(t){O(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function O(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=I(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=I(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==I(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}System.register(["./index-legacy-Cw3EU-FN.js","./vendor-legacy-3V6tX1hl.js","./App-legacy-92jDSsGS.js","./Storage-legacy-BFy28IfG.js","./DataTable-legacy-BVxdFFVf.js","./AuthenticatedApp-legacy-BR--zcF1.js","./collections-legacy-B3aPJpmz.js","./ConfirmDialog-legacy-DGFneHEp.js","./EmployeeCardForm-legacy-BE_qHSlo.js","./fleets-legacy-Chp4n2l6.js","./input-legacy-DL0_TS5-.js","./Archive-legacy-CBnbCVeS.js","./Logs-legacy-BgthPl2J.js","./users-legacy-Cx1ejVXG.js","./EmployeeLink-legacy-Bb5L4nbd.js","./PhotoIcon-legacy-Dlb_tfgz.js","./useToast-legacy-CCtM2qzd.js"],function(N,C){"use strict";var S,T,A,D,R,L,U,K,F,H,V,P,B,z,Z,q,G,X,Y,J,Q,$,ee,te,re,ne,ae,le,ie,se,oe,ce,ue,de,me,fe,ve,he,pe,xe,ge,be,ye,je,Ne,ke,we,_e,Ce,Se,Ie,Ee,Te,Ae,We,Oe;return{setters:[function(e){S=e.j,T=e._},function(e){A=e.b,D=e.l,R=e.R,L=e.i,U=e.p,K=e.m,F=e.s},function(e){H=e.d,V=e.B,P=e.M,B=e.s,z=e.h,Z=e.b,q=e.a},function(e){G=e.F,X=e.B,Y=e.S},function(e){J=e.default},function(e){Q=e.a,$=e.b,ee=e.c,te=e.d,re=e.P,ne=e.e,ae=e.R,le=e.I,ie=e.f,se=e.g,oe=e.S,ce=e.F,ue=e.h,de=e.A,me=e.i},function(e){fe=e.f,ve=e.a,he=e.c,pe=e.u,xe=e.r},function(e){ge=e.C},function(e){be=e.f,ye=e.a,je=e.R,Ne=e.E},function(e){ke=e.l,we=e.c,_e=e.u,Ce=e.d},function(e){Se=e.I},function(e){Ie=e.default},function(e){Ee=e.default},function(e){Te=e.f,Ae=e.d,We=e.c,Oe=e.u},null,null,null],execute:function(){var Me=E().m(ut);function De(t,r){var n=t.title,a=t.titleId,l=M(t,e);return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":a},l),n?A.createElement("title",{id:a},n):null,A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75"}))}N("default",function(){var e,t,r,n,a,l,i,s,o,c,u,d,m,f=Z().t,v=w(L(),2),h=v[0],p=v[1],x=w(A.useState(function(){var e=h.get("module");return Mr(e)?e:"directories"}),2),g=x[0],b=x[1],j=w(A.useState("departments"),2),N=j[0],_=j[1],C=w(A.useState([]),2),T=C[0],D=C[1],R=w(A.useState(!1),2),U=R[0],K=R[1],F=w(A.useState(0),2),H=F[0],z=F[1],G=w(A.useState(1),2),Q=G[0],$=G[1],ee=w(A.useState(function(){return Rr()}),2),te=ee[0],re=ee[1],ne=w(A.useState(function(){return Rr()}),2),ae=ne[0],le=ne[1],ie=w(A.useState({name:"",value:""}),2),se=ie[0],ce=ie[1],me=w(A.useState(""),2),je=me[0],ke=me[1],we=w(A.useState([]),2),_e=we[0],Ce=we[1],Se=w(A.useState([]),2),Me=Se[0],De=Se[1],Re=w(A.useState([]),2),Le=Re[0],Ue=Re[1],Ke=w(A.useState([]),2),Fe=Ke[0],He=Ke[1],Ve=10,Pe=w(A.useState([]),2),Be=Pe[0],ze=Pe[1],Ze=w(A.useState(1),2),qe=Ze[0],Ge=Ze[1],Xe=w(A.useState(""),2),Ye=Xe[0],Je=Xe[1],Qe=w(A.useState(""),2),$e=Qe[0],et=Qe[1],tt=w(A.useState(!1),2),rt=tt[0],nt=tt[1],at=w(A.useState(Lr),2),lt=at[0],it=at[1],ot=w(A.useState(!1),2),ut=ot[0],dt=ot[1],mt=w(A.useState(null),2),ft=mt[0],vt=mt[1],ht=A.useRef(),pt=w(A.useState(void 0),2),xt=pt[0],gt=pt[1],bt=w(A.useState(!1),2),yt=bt[0],jt=bt[1],Nt=w(A.useState("create"),2),kt=Nt[0],wt=Nt[1],_t=w(A.useState([]),2),Ct=_t[0],St=_t[1],It=w(A.useState([]),2),Et=It[0],Tt=It[1],At=w(A.useState(!1),2),Wt=At[0],Ot=At[1],Mt=q().user,Dt=w(A.useState(!1),2),Pt=Dt[0],Bt=Dt[1],zt=w(A.useState(!1),2),Zt=zt[0],qt=zt[1],Xt=ue(null==Mt?void 0:Mt.access,de);A.useEffect(function(){return function(){ht.current&&window.clearTimeout(ht.current)}},[]),A.useEffect(function(){var e=h.get("module"),t=Mr(e)?e:"directories";t!==g&&b(t)},[h,g]);var Qt=A.useCallback(function(e){b(e);var t=new URLSearchParams(h.toString());"directories"===e?t.delete("module"):t.set("module",e),p(t,{replace:!0})},[h,p]),$t=A.useMemo(function(){var e;if(null==ft||!ft.meta||"object"!==I(ft.meta))return{readonly:!1,notice:void 0};var t=ft.meta,r=Boolean(null!==(e=t.readonly)&&void 0!==e?e:t.legacy);return{readonly:r,notice:r?"string"==typeof t.readonlyReason?t.readonlyReason:t.legacy?"Элемент перенесён из старой коллекции и доступен только для чтения.":void 0:void 0}},[ft]),er=A.useMemo(function(){return[{label:f("nav.settings"),href:"/settings"},{label:f("collections.page.title")}]},[f]),tr=null!==(e=te[N])&&void 0!==e?e:"",rr=null!==(t=ae[N])&&void 0!==t?t:"",nr="directories"===g&&"users"!==N&&"fleets"!==N&&"tasks"!==N,lr="directories"===g&&"users"===N,ir="directories"===g&&"employees"===N,sr=A.useCallback(function(e){var t=e.trim();$(1),re(function(e){return e[N]===t?e:W(W({},e),{},O({},N,t))})},[N]);A.useEffect(function(){le(function(e){return W(W({},e),{},O({},N,tr))})},[N,tr]),A.useEffect(function(){if(nr)return ht.current&&window.clearTimeout(ht.current),ht.current=window.setTimeout(function(){sr(rr)},400),function(){ht.current&&window.clearTimeout(ht.current)}},[sr,rr,nr]);var or=A.useCallback(k(E().m(function e(){var t,r,n,a;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:if("users"!==N&&"tasks"!==N){e.n=1;break}return K(!1),e.a(2);case 1:if(K(!0),e.p=2,"fleets"!==N){e.n=3;break}return D([]),z(0),ke(""),e.a(2);case 3:if("employees"!==N){e.n=5;break}return e.n=4,ve("employees");case 4:return t=e.v,D(t),z(t.length),ke(""),e.a(2);case 5:return e.n=6,fe(N,tr,Q,Ve);case 6:r=e.v,D(r.items),z(r.total),"departments"===N&&Ce(function(e){return Gr(e,r.items)}),"divisions"===N&&De(function(e){return Gr(e,r.items)}),"positions"===N&&Ue(function(e){return Gr(e,r.items)}),ke(""),e.n=8;break;case 7:e.p=7,a=e.v,n=a instanceof Error?a.message:"Не удалось загрузить элементы",D([]),z(0),ke(n);case 8:return e.p=8,K(!1),e.f(8);case 9:return e.a(2)}},e,null,[[2,7,8,9]])})),[N,tr,Q]),cr=A.useCallback(k(E().m(function e(){var t,r,n;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Te();case 1:t=e.v,ze(t),ke(function(e){return e===ln?"":e}),e.n=3;break;case 2:e.p=2,n=e.v,r=n instanceof Error?n.message:ln,ze([]),ke(r||ln);case 3:return e.a(2)}},e,null,[[0,2]])})),[]),ur=A.useCallback(k(E().m(function e(){var t,r,n,a,l,i;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:return Ot(!0),e.p=1,e.n=2,Promise.all([ve("task_fields"),ve("task_types")]);case 2:t=e.v,r=w(t,2),n=r[0],a=r[1],St(n),Tt(a),ke(function(e){return e===on?"":e}),e.n=4;break;case 3:e.p=3,i=e.v,l=i instanceof Error?i.message:on,St([]),Tt([]),ke(l||on);case 4:return e.p=4,Ot(!1),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])})),[ke]);A.useEffect(function(){"tasks"===N&&ur()},[N,ur]);var mr=A.useCallback(function(){var e=k(E().m(function e(t,r){var n,a,l,i;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=r.trim()){e.n=1;break}throw new Error("Название не может быть пустым");case 1:if(e.p=1,null===(a=t.meta)||void 0===a||!a.virtual){e.n=3;break}return e.n=2,he("task_fields",{name:t.name,value:n});case 2:e.n=4;break;case 3:return e.n=4,pe(t._id,{name:t.name,value:n},{collectionType:"task_fields"});case 4:return e.n=5,ur();case 5:e.n=7;break;case 6:throw e.p=6,i=e.v,l=i instanceof Error?i.message:cn,new Error(l||cn);case 7:return e.a(2)}},e,null,[[1,6]])}));return function(t,r){return e.apply(this,arguments)}}(),[ur]),fr=A.useCallback(function(){var e=k(E().m(function e(t){var r,n,a;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:if(null===(r=t.meta)||void 0===r||!r.virtual){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,xe(t._id);case 2:return e.n=3,ur();case 3:e.n=5;break;case 4:throw e.p=4,a=e.v,n=a instanceof Error?a.message:dn,new Error(n||dn);case 5:return e.a(2)}},e,null,[[1,4]])}));return function(t){return e.apply(this,arguments)}}(),[ur]),vr=A.useCallback(function(){var e=k(E().m(function e(t,r){var n,a,l,i,s,o,c,u,d;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=r.label.trim()){e.n=1;break}throw new Error("Название не может быть пустым");case 1:if(a=r.tg_theme_url.trim(),l=r.tg_photos_url.trim(),e.p=2,s=function(){var e={};return a&&(e.tg_theme_url=a),l&&(e.tg_photos_url=l),e},null===(i=t.meta)||void 0===i||!i.virtual){e.n=4;break}return o=s(),e.n=3,he("task_types",W({name:t.name,value:n},Object.keys(o).length?{meta:o}:{}));case 3:e.n=5;break;case 4:return c=s(),a||(c.tg_theme_url=""),l||(c.tg_photos_url=""),e.n=5,pe(t._id,{name:t.name,value:n,meta:c},{collectionType:"task_types"});case 5:return e.n=6,ur();case 6:e.n=8;break;case 7:throw e.p=7,d=e.v,u=d instanceof Error?d.message:un,new Error(u||un);case 8:return e.a(2)}},e,null,[[2,7]])}));return function(t,r){return e.apply(this,arguments)}}(),[ur]),hr=A.useCallback(function(){var e=k(E().m(function e(t){var r,n,a;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:if(null===(r=t.meta)||void 0===r||!r.virtual){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,xe(t._id);case 2:return e.n=3,ur();case 3:e.n=5;break;case 4:throw e.p=4,a=e.v,n=a instanceof Error?a.message:dn,new Error(n||dn);case 5:return e.a(2)}},e,null,[[1,4]])}));return function(t){return e.apply(this,arguments)}}(),[ur]);A.useEffect(function(){"users"!==N&&"employees"!==N||et(Ye)},[N,Ye]),A.useEffect(function(){ut&&"divisions"===(null==ft?void 0:ft.type)&&cr()},[ut,ft,cr]),A.useEffect(function(){var e=function(){var e=k(E().m(function e(){var t,r,n,a,l,i;return E().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Promise.allSettled([ve("departments"),ve("divisions"),ve("positions")]);case 1:t=e.v,r=w(t,3),n=r[0],a=r[1],l=r[2],(i=function(e,t,r){if("fulfilled"!==e.status){var n=e.reason,a=n instanceof Error&&n.message?n.message:r;ke(function(e){return e||a})}else t(e.value)})(n,Ce,"Не удалось загрузить департаменты"),i(a,De,"Не удалось загрузить отделы"),i(l,Ue,"Не удалось загрузить должности");case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();e(),ye().then(function(e){return He(e)}).catch(function(e){He([]);var t=e instanceof Error?e.message:"Не удалось загрузить роли";ke(function(e){return e||t})})},[]),A.useEffect(function(){"users"!==N&&"tasks"!==N?(or(),"fleets"!==N&&ce({name:"",value:""})):ke("")},[or,N]),A.useEffect(function(){"users"===N&&(cr(),it(Lr),gt(void 0)),"employees"===N&&(cr(),gt(void 0),wt("create"),jt(!1)),"employees"!==N&&jt(!1),"users"!==N&&"employees"!==N&&"fleets"!==N&&"tasks"!==N||dt(!1),"users"!==N&&(nt(!1),it(Lr))},[N,cr]);var pr=function(e){e?(ce({_id:e._id,name:e.name,value:e.value}),vt(e)):(ce({name:"",value:""}),vt(null)),dt(!0)},xr=function(){dt(!1),vt(null),ce({name:"",value:""})},gr=function(e){it(e?function(e){var t,r,n,a,l,i,s,o,c,u,d,m;return{telegram_id:null==e?void 0:e.telegram_id,username:null!==(t=null!==(r=null==e?void 0:e.telegram_username)&&void 0!==r?r:null==e?void 0:e.username)&&void 0!==t?t:"",name:null!==(n=null==e?void 0:e.name)&&void 0!==n?n:"",phone:null!==(a=null==e?void 0:e.phone)&&void 0!==a?a:"",mobNumber:null!==(l=null==e?void 0:e.mobNumber)&&void 0!==l?l:"",email:null!==(i=null==e?void 0:e.email)&&void 0!==i?i:"",role:null!==(s=null==e?void 0:e.role)&&void 0!==s?s:"user",access:null!==(o=null==e?void 0:e.access)&&void 0!==o?o:1,roleId:null!==(c=null==e?void 0:e.roleId)&&void 0!==c?c:"",departmentId:null!==(u=null==e?void 0:e.departmentId)&&void 0!==u?u:"",divisionId:null!==(d=null==e?void 0:e.divisionId)&&void 0!==d?d:"",positionId:null!==(m=null==e?void 0:e.positionId)&&void 0!==m?m:""}}(e):Lr),nt(!0)},br=A.useCallback(function(){nt(!1),it(Lr)},[]),yr=function(e){e?(gt(String(e.telegram_id)),wt("update")):(gt(void 0),wt("create")),jt(!0)},jr=A.useCallback(function(e){le(function(t){return W(W({},t),{},O({},N,e))})},[N]),Nr=A.useCallback(function(e){ht.current&&window.clearTimeout(ht.current),sr(null!=e?e:rr)},[sr,rr]),kr=A.useCallback(function(e){nr&&("Enter"===e.key&&(e.preventDefault(),Nr(e.currentTarget.value)),"Escape"===e.key&&(e.preventDefault(),jr(""),Nr("")))},[nr,Nr,jr]),wr=A.useCallback(function(){jr(""),Nr("")},[Nr,jr]),_r=A.useCallback(function(e){null==e||e.preventDefault(),Ge(1),Je($e.trim()),gt(void 0)},[$e]),Tr=A.useCallback(function(e){lr&&("Enter"===e.key&&(e.preventDefault(),_r()),"Escape"===e.key&&(e.preventDefault(),et(""),_r()))},[lr,_r]),Fr=A.useCallback(k(E().m(function e(){var t,r;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:if(lt.telegram_id){e.n=1;break}return Bt(!1),e.a(2);case 1:return e.p=1,e.n=2,Ae(lt.telegram_id);case 2:return B(mn,"success"),gt(function(e){return e===String(lt.telegram_id)?void 0:e}),br(),e.n=3,cr();case 3:e.n=5;break;case 4:e.p=4,r=e.v,t=r instanceof Error?r.message:fn,B(t||fn,"error");case 5:return e.p=5,Bt(!1),e.f(5);case 6:return e.a(2)}},e,null,[[1,4,5,6]])})),[lt.telegram_id,br,cr,gt]),Hr=A.useCallback(k(E().m(function e(){var t,r;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:if(xt){e.n=1;break}return qt(!1),e.a(2);case 1:return e.p=1,e.n=2,Ae(xt);case 2:return B(vn,"success"),jt(!1),gt(void 0),wt("create"),e.n=3,cr();case 3:e.n=5;break;case 4:e.p=4,r=e.v,t=r instanceof Error?r.message:hn,B(t||hn,"error");case 5:return e.p=5,qt(!1),e.f(5);case 6:return e.a(2)}},e,null,[[1,4,5,6]])})),[xt,cr]),Vr=function(){var e=k(E().m(function e(){var t,r,n,a,l,i;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:if("fleets"!==N){e.n=1;break}return e.a(2);case 1:if(t=se.name.trim()){e.n=2;break}return e.a(2);case 2:if(!se._id||!$t.readonly){e.n=3;break}return ke(null!==(r=$t.notice)&&void 0!==r?r:"Элемент перенесён из старой коллекции и доступен только для чтения."),e.a(2);case 3:if(n=se.value,"departments"!==N){e.n=4;break}n=qr(se.value).join(","),e.n=5;break;case 4:if(n=se.value.trim()){e.n=5;break}return ke("Заполните значение элемента."),e.a(2);case 5:if(e.p=5,a=null,!se._id){e.n=7;break}return e.n=6,pe(se._id,{name:t,value:n},{collectionType:N});case 6:a=e.v,e.n=9;break;case 7:return e.n=8,he(N,{name:t,value:n});case 8:a=e.v;case 9:if(a){e.n=10;break}throw new Error("Сервер не вернул сохранённый элемент");case 10:return ke(""),e.n=11,or();case 11:xr(),e.n=13;break;case 12:e.p=12,i=e.v,l=i instanceof Error?i.message:"Не удалось сохранить элемент",ke(l);case 13:return e.a(2)}},e,null,[[5,12]])}));return function(){return e.apply(this,arguments)}}(),Pr=function(){var e=k(E().m(function e(){var t,r,n;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:if(se._id){e.n=1;break}return e.a(2);case 1:if(!$t.readonly){e.n=2;break}return ke(null!==(t=$t.notice)&&void 0!==t?t:"Элемент перенесён из старой коллекции и доступен только для чтения."),e.a(2);case 2:return e.p=2,e.n=3,xe(se._id);case 3:return ke(""),e.n=4,or();case 4:xr(),e.n=6;break;case 5:e.p=5,n=e.v,r=n instanceof Error?n.message:"",ke(r);case 6:return e.a(2)}},e,null,[[2,5]])}));return function(){return e.apply(this,arguments)}}(),Zr=function(){var e=k(E().m(function e(){var t,r;return E().w(function(e){for(;;)switch(e.n){case 0:if(lt.telegram_id){e.n=1;break}return e.a(2);case 1:if(t=lt.telegram_id,Be.find(function(e){return e.telegram_id===t})){e.n=2;break}return e.n=2,We(t,lt.username,lt.roleId);case 2:return lt.telegram_id,r=M(lt,y),e.n=3,Oe(t,r);case 3:cr(),br();case 4:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),Yr=A.useMemo(function(){var e=new Map;return _e.forEach(function(t){return e.set(t._id,t.name)}),e},[_e]),Jr=A.useMemo(function(){var e=new Map;return Me.forEach(function(t){return e.set(t._id,t.name)}),e},[Me]),Qr=A.useMemo(function(){var e=new Map;return Le.forEach(function(t){return e.set(t._id,t.name)}),e},[Le]),$r=A.useMemo(function(){return en(T)},[T]),rn=A.useCallback(function(e){return tn(e,an(e,$r))},[$r]),xn=A.useMemo(function(){return Be.map(function(e){return rn(e)})},[Be,rn]),gn=A.useMemo(function(){var e=new Map;return Fe.forEach(function(t){return e.set(t._id,t.name)}),e},[Fe]),bn=A.useMemo(function(){var e=new Map,t=new Set;return _e.forEach(function(r){qr(r.value).forEach(function(n){var a=e.get(n);a&&a!==r._id?t.add(n):a||e.set(n,r._id)})}),{divisionOwners:e,duplicateDivisionIds:Array.from(t)}},[_e]),yn=bn.divisionOwners,jn=bn.duplicateDivisionIds,Nn=A.useMemo(function(){if(!jn.length)return"";var e=jn.map(function(e){var t,r,n;return null!==(t=null!==(r=Jr.get(e))&&void 0!==r?r:null===(n=Me.find(function(t){return t._id===e}))||void 0===n?void 0:n.name)&&void 0!==t?t:e}).filter(function(e){return Boolean(e)}),t=e.length?": ".concat(e.join(", "),"."):".";return"".concat(sn).concat(t)},[jn,Jr,Me]);A.useEffect(function(){ke(Nn?function(e){return e||Nn}:function(e){return e&&e.startsWith(sn)?"":e})},[Nn]);var kn=A.useCallback(function(e,t){var r;if("departments"===t){var n=qr(e.value);if(!n.length)return Gt;var a=n.map(function(e){var t,r,n;return null!==(t=null!==(r=Jr.get(e))&&void 0!==r?r:null===(n=Me.find(function(t){return t._id===e}))||void 0===n?void 0:n.name)&&void 0!==t?t:e}).filter(function(e){return Boolean(e)});return a.length?a.join("\n"):Gt}if("divisions"===t){var l,i,s,o=null!==(l=null!==(i=Yr.get(e.value))&&void 0!==i?i:null===(s=_e.find(function(t){return t._id===e.value}))||void 0===s?void 0:s.name)&&void 0!==l?l:e.value;return o?zr(o):Gt}if("positions"===t){var c,u,d,m=null!==(c=null!==(u=Jr.get(e.value))&&void 0!==u?u:null===(d=Me.find(function(t){return t._id===e.value}))||void 0===d?void 0:d.name)&&void 0!==c?c:e.value;return m?zr(m):Gt}return zr(null!==(r=e.value)&&void 0!==r?r:"")||Gt},[_e,Me,Yr,Jr]),wn=A.useCallback(function(e){return e&&Br(e)||Gt},[]),_n=f("collections.actions.copyId"),Cn=f("collections.actions.copiedId"),Sn=A.useMemo(function(){return Sr.map(function(e){if(!pn(e))return e;switch(e.accessorKey){case"name":return W(W({},e),{},{header:f("collections.table.columns.name")});case"value":return W(W({},e),{},{header:f("collections.table.columns.value")});case"displayValue":return W(W({},e),{},{header:f("collections.table.columns.relations")});case"type":return W(W({},e),{},{header:f("collections.table.columns.type")});case"_id":return W(W({},e),{},{header:f("collections.table.columns.id"),cell:function(e){var t=(0,e.getValue)(),r="string"==typeof t?t:"";return r?S.jsx(Ht,{value:r,copyHint:_n,copiedHint:Cn}):S.jsx("span",{className:"text-xs text-[color:var(--color-gray-500)] dark:text-[color:var(--color-gray-300)]",children:Gt})}});case"metaSummary":return W(W({},e),{},{header:f("collections.table.columns.meta")});default:return e}})},[Cn,_n,f]),In=f("collections.search.placeholder"),En=f("collections.search.hint"),Tn=f("collections.actions.search"),An=f("collections.actions.reset"),Wn=f("collections.actions.add"),On=f("collections.table.empty.title"),Mn=f("collections.table.empty.description"),Dn=f("collections.table.empty.action"),Rn=f("collections.users.searchPlaceholder"),Ln=f("collections.users.add"),Un=f("collections.employees.searchPlaceholder"),Kn=f("collections.employees.add"),Fn=A.useCallback(function(e){return Sn.filter(function(t){return!pn(t)||!e.includes(t.accessorKey)})},[Sn]),Hn=A.useMemo(function(){return Fn(["value","type","metaSummary"])},[Fn]),Vn=A.useMemo(function(){return Fn(["type","metaSummary"])},[Fn]),Pn=A.useMemo(function(){return Fn(["type","metaSummary"])},[Fn]),Bn=A.useCallback(function(e,t,r){var n=qr(e.value);return S.jsx("select",{multiple:!0,className:"min-h-[8rem] w-full rounded border px-3 py-2",value:n,onChange:function(r){var n=Array.from(r.target.selectedOptions).map(function(e){return e.value});t(W(W({},e),{},{value:n.join(",")}))},disabled:null==r?void 0:r.readonly,children:Me.filter(function(t){var r=yn.get(t._id);return!r||(!!n.includes(t._id)||!!e._id&&r===e._id)}).map(function(e){return S.jsx("option",{value:e._id,children:e.name},e._id)})})},[Me,yn]),zn=A.useCallback(function(e,t,r){return S.jsxs("select",{className:"h-10 w-full rounded border px-3",value:e.value,onChange:function(r){return t(W(W({},e),{},{value:r.target.value}))},required:!0,disabled:null==r?void 0:r.readonly,children:[S.jsx("option",{value:"",disabled:!0,children:"Выберите департамент"}),_e.map(function(e){return S.jsx("option",{value:e._id,children:e.name},e._id)})]})},[_e]),Zn=A.useCallback(function(e,t,r){return S.jsxs("select",{className:"h-10 w-full rounded border px-3",value:e.value,onChange:function(r){return t(W(W({},e),{},{value:r.target.value}))},required:!0,disabled:null==r?void 0:r.readonly,children:[S.jsx("option",{value:"",disabled:!0,children:"Выберите отдел"}),Me.map(function(e){return S.jsx("option",{value:e._id,children:e.name},e._id)})]})},[Me]),qn=Math.ceil(H/Ve)||1,Gn=A.useMemo(function(){var e=Ye.trim();return e?ct(xn,e,{keys:[{key:function(e){var t;return null!==(t=e.username)&&void 0!==t?t:""},threshold:st.STARTS_WITH},{key:function(e){var t;return null!==(t=e.telegram_username)&&void 0!==t?t:""},threshold:st.STARTS_WITH},{key:function(e){return void 0!==e.telegram_id&&null!==e.telegram_id?String(e.telegram_id):""},threshold:st.STARTS_WITH},{key:function(e){return nn(e)},threshold:st.CONTAINS}]}):xn},[Ye,xn]),Xn=Math.ceil(Gn.length/Ve)||1,Yn=Gn.slice((qe-1)*Ve,qe*Ve),Jn=A.useMemo(function(){return Yn.map(function(e){var t=rn(e),r="string"==typeof t.roleId?t.roleId.trim():"",n="string"==typeof t.departmentId?t.departmentId.trim():"",a="string"==typeof t.divisionId?t.divisionId.trim():"",l="string"==typeof t.positionId?t.positionId.trim():"",i=Xr(gn,r,t.roleName),s=Xr(Yr,n,t.departmentName),o=Xr(Jr,a,t.divisionName),c=Xr(Qr,l,t.positionName),u=i||(t.role?be(t.role):"");return Ar(W(W({},t),{},{roleId:r,departmentId:n,divisionId:a,positionId:l,roleName:u,departmentName:s,divisionName:o,positionName:c}))})},[Yn,gn,Yr,Jr,Qr,rn]),Qn=A.useMemo(function(){if(xt){var e=xn.find(function(e){return String(e.telegram_id)===xt});if(e)return e;var t=an(void 0,$r,xt);if(t){var r={};if("number"==typeof t.telegram_id)r.telegram_id=t.telegram_id;else{var n=Number(xt);Number.isFinite(n)&&(r.telegram_id=n)}return t.username&&(r.username=t.username),t.telegram_username&&(r.telegram_username=t.telegram_username),tn(r,t)}}},[$r,xn,xt]),$n=A.useMemo(function(){return ft&&"departments"===ft.type?qr(ft.value).map(function(e){var t,r,n;return null!==(t=null!==(r=Jr.get(e))&&void 0!==r?r:null===(n=Me.find(function(t){return t._id===e}))||void 0===n?void 0:n.name)&&void 0!==t?t:e}).filter(function(e){return Boolean(e)}):[]},[ft,Jr,Me]),ea=A.useMemo(function(){var e,t,r;if(!ft||"divisions"!==ft.type)return Gt;var n=ft.value;return n?null!==(e=null!==(t=Yr.get(n))&&void 0!==t?t:null===(r=_e.find(function(e){return e._id===n}))||void 0===r?void 0:r.name)&&void 0!==e?e:n:Gt},[ft,Yr,_e]),ta=A.useMemo(function(){return ft&&"divisions"===ft.type?Le.filter(function(e){return e.value===ft._id}).map(function(e){return e.name}).filter(function(e){return Boolean(e)}):[]},[ft,Le]),ra=A.useMemo(function(){return ft&&"divisions"===ft.type?xn.filter(function(e){return e.divisionId===ft._id}).map(function(e){return e.name&&e.name.trim()?e.name.trim():e.username&&e.username.trim()?e.username.trim():void 0!==e.telegram_id&&null!==e.telegram_id?"ID ".concat(e.telegram_id):"Без имени"}):[]},[ft,xn]),na=function(){if("directories"!==g)return null;if(lr||ir){var e=ir?Un:Rn,t=ir?Kn:Ln,r=ir?function(){return yr()}:function(){return gr()};return S.jsxs("div",{className:"flex w-full flex-col gap-2 sm:flex-row sm:items-end sm:justify-between",children:[S.jsxs("div",{className:"flex w-full flex-col gap-1 sm:w-72",children:[S.jsx("label",{htmlFor:"settings-users-search",className:"sr-only",children:Tn}),S.jsx("input",{id:"settings-users-search",className:"h-10 w-full rounded-2xl border border-[color:var(--color-gray-200)] bg-white px-3 text-sm text-[color:var(--color-gray-900)] shadow-sm outline-none transition focus:border-[color:var(--color-brand-400)] focus:ring-2 focus:ring-[color:var(--color-brand-200)] dark:border-[color:var(--color-gray-700)] dark:bg-[color:var(--color-gray-dark)] dark:text-white",value:$e,onChange:function(e){return et(e.target.value)},onKeyDown:Tr,placeholder:e}),S.jsx("span",{className:"text-[11px] text-[color:var(--color-gray-500)] dark:text-[color:var(--color-gray-300)]",children:En})]}),S.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[S.jsx(V,{size:"sm",onClick:function(){return _r()},children:Tn}),S.jsx(V,{size:"sm",variant:"outline",onClick:function(){et(""),_r()},children:An}),S.jsx(V,{size:"sm",variant:"success",onClick:r,children:t})]})]})}return nr?S.jsxs("div",{className:"flex w-full flex-col gap-2 sm:flex-row sm:items-end sm:justify-between",children:[S.jsxs("div",{className:"flex w-full flex-col gap-1 sm:w-72",children:[S.jsx("label",{htmlFor:"settings-collections-search",className:"sr-only",children:Tn}),S.jsx("input",{id:"settings-collections-search",className:"h-10 w-full rounded-2xl border border-[color:var(--color-gray-200)] bg-white px-3 text-sm text-[color:var(--color-gray-900)] shadow-sm outline-none transition focus:border-[color:var(--color-brand-400)] focus:ring-2 focus:ring-[color:var(--color-brand-200)] dark:border-[color:var(--color-gray-700)] dark:bg-[color:var(--color-gray-dark)] dark:text-white",value:rr,onChange:function(e){return jr(e.target.value)},onKeyDown:kr,placeholder:In}),S.jsx("span",{className:"text-[11px] text-[color:var(--color-gray-500)] dark:text-[color:var(--color-gray-300)]",children:En})]}),S.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[S.jsx(V,{size:"sm",onClick:function(){return Nr()},children:Tn}),S.jsx(V,{size:"sm",variant:"outline",onClick:wr,children:An}),S.jsx(V,{size:"sm",variant:"success",onClick:function(){return pr()},children:Wn})]})]}):S.jsx("div",{className:"flex flex-wrap items-center gap-2",children:S.jsx(V,{size:"sm",variant:"success",onClick:function(){return pr()},children:Wn})})}();return S.jsx("div",{className:"mx-auto flex w-full max-w-screen-2xl flex-col gap-6 px-3 pb-12 pt-4 sm:px-4 lg:px-8",children:S.jsxs(Rt,{value:g,onValueChange:function(e){return Qt(e)},className:"space-y-6",children:[S.jsx(Ft,{breadcrumbs:S.jsx(X,{items:er}),title:f("collections.page.title"),description:f("collections.page.description"),toolbar:na,children:S.jsxs("div",{className:"flex flex-col gap-3",children:[S.jsxs("div",{className:"sm:hidden",children:[S.jsx("label",{htmlFor:"settings-module-select",className:"sr-only",children:f("collections.moduleSelectLabel")}),S.jsx("select",{id:"settings-module-select",className:"h-11 w-full rounded-2xl border border-[color:var(--color-gray-200)] bg-white px-3 text-sm font-semibold text-[color:var(--color-gray-800)] shadow-sm outline-none transition focus:border-[color:var(--color-brand-400)] focus:ring-2 focus:ring-[color:var(--color-brand-200)] dark:border-[color:var(--color-gray-700)] dark:bg-[color:var(--color-gray-dark)] dark:text-white",value:g,onChange:function(e){return Qt(e.target.value)},children:Or.map(function(e){return S.jsx("option",{value:e.key,children:e.label},e.key)})})]}),S.jsx(Lt,{className:"hidden h-auto gap-2 bg-transparent p-0 sm:grid sm:gap-2 sm:p-1 sm:[grid-template-columns:repeat(5,minmax(11rem,1fr))]",children:Or.map(function(e){var t=e.icon,r="".concat(e.key,"-module-tab-label");return S.jsxs(Ut,{value:e.key,"aria-labelledby":r,className:"group flex h-full min-h-[3.4rem] w-full flex-col items-center justify-center gap-1.5 rounded-xl border border-transparent px-3 py-2 text-sm font-semibold text-[color:var(--color-gray-700)] transition-colors duration-200 ease-out hover:bg-[color:var(--color-gray-50)] focus-visible:ring-2 focus-visible:ring-[color:var(--color-brand-400)] focus-visible:ring-offset-2 dark:text-[color:var(--color-gray-200)] dark:hover:bg-[color:var(--color-gray-800)] data-[state=active]:border-[color:var(--color-gray-200)] data-[state=active]:bg-white data-[state=active]:text-[color:var(--color-brand-600)] data-[state=active]:shadow-sm dark:data-[state=active]:border-[color:var(--color-gray-700)] dark:data-[state=active]:bg-[color:var(--color-gray-dark)] dark:data-[state=active]:text-[color:var(--color-brand-300)]",children:[S.jsx(t,{className:"size-5 flex-shrink-0 text-[color:var(--color-gray-500)] transition-colors group-data-[state=active]:text-[color:var(--color-brand-600)] dark:text-[color:var(--color-gray-300)] dark:group-data-[state=active]:text-[color:var(--color-brand-300)] sm:size-6"}),S.jsx("span",{id:r,className:"truncate text-sm font-semibold leading-5 text-[color:var(--color-gray-800)] transition-colors group-data-[state=active]:text-[color:var(--color-brand-600)] dark:text-[color:var(--color-gray-100)] dark:group-data-[state=active]:text-[color:var(--color-brand-300)]",children:e.label}),e.description?S.jsx("span",{className:"hidden text-xs font-medium text-[color:var(--color-gray-500)] dark:text-[color:var(--color-gray-400)] sm:block",children:e.description}):null]},e.key)})})]})}),S.jsxs(Kt,{value:"directories",className:"mt-0 space-y-6",children:[je?S.jsx("div",{className:"rounded-2xl border border-[color:var(--color-error-200)] bg-[color:var(--color-error-25)] p-4 text-sm text-[color:var(--color-error-600)] dark:border-[color:var(--color-error-700)] dark:bg-[color:var(--color-error-900)]/40 dark:text-[color:var(--color-error-200)]",children:je}):null,S.jsxs(Rt,{value:N,onValueChange:function(e){_(e),$(1)},className:"space-y-5",children:[S.jsxs("div",{className:"sm:hidden",children:[S.jsx("label",{htmlFor:"settings-section-select",className:"sr-only",children:f("collections.directorySelectLabel")}),S.jsx("select",{id:"settings-section-select",className:"h-11 w-full rounded-2xl border border-[color:var(--color-gray-200)] bg-white px-3 text-sm font-semibold text-[color:var(--color-gray-800)] shadow-sm outline-none transition focus:border-[color:var(--color-brand-400)] focus:ring-2 focus:ring-[color:var(--color-brand-200)] dark:border-[color:var(--color-gray-700)] dark:bg-[color:var(--color-gray-dark)] dark:text-white",value:N,onChange:function(e){_(e.target.value),$(1)},children:Dr.map(function(e){return S.jsx("option",{value:e.key,children:e.label},e.key)})})]}),S.jsx(Lt,{className:"hidden gap-2 sm:grid sm:gap-2 sm:overflow-visible sm:p-1 sm:[grid-template-columns:repeat(7,minmax(9.5rem,1fr))]",children:Dr.map(function(e){var t=Ur[e.key],r="".concat(e.key,"-tab-label");return S.jsxs(Ut,{value:e.key,"aria-labelledby":r,className:"group flex h-full min-h-[3.1rem] w-full flex-col items-center justify-center gap-1.5 rounded-xl border border-transparent px-3 py-2 text-sm font-semibold text-[color:var(--color-gray-700)] transition-colors duration-200 ease-out hover:bg-[color:var(--color-gray-50)] focus-visible:ring-2 focus-visible:ring-[color:var(--color-brand-400)] focus-visible:ring-offset-2 dark:text-[color:var(--color-gray-200)] dark:hover:bg-[color:var(--color-gray-800)] data-[state=active]:border-[color:var(--color-gray-200)] data-[state=active]:bg-white data-[state=active]:text-[color:var(--color-brand-600)] data-[state=active]:shadow-sm dark:data-[state=active]:border-[color:var(--color-gray-700)] dark:data-[state=active]:bg-[color:var(--color-gray-dark)] dark:data-[state=active]:text-[color:var(--color-brand-300)]",children:[t?S.jsx(t,{className:"size-5 flex-shrink-0 text-[color:var(--color-gray-500)] transition-colors group-data-[state=active]:text-[color:var(--color-brand-600)] dark:text-[color:var(--color-gray-300)] dark:group-data-[state=active]:text-[color:var(--color-brand-300)] sm:size-6"}):null,S.jsx("span",{id:r,className:"truncate text-sm font-semibold leading-5 text-[color:var(--color-gray-800)] transition-colors group-data-[state=active]:text-[color:var(--color-brand-600)] dark:text-[color:var(--color-gray-100)] dark:group-data-[state=active]:text-[color:var(--color-brand-300)]",children:e.label}),e.description?S.jsx("span",{"aria-hidden":"true",className:"hidden text-xs font-medium text-[color:var(--color-gray-500)] dark:text-[color:var(--color-gray-400)] sm:block",children:e.description}):null]},e.key)})}),Dr.map(function(e){var t=e.key===N,r=t?T.map(function(t){return W(W({},t),{},{displayValue:kn(t,e.key),metaSummary:wn(t.meta)})}):[],n="departments"===e.key?Hn:"divisions"===e.key?Vn:"positions"===e.key?Pn:Sn;if("users"===e.key){var a=0===Yn.length;return S.jsx(Kt,{value:e.key,className:"mt-0 flex flex-col gap-4",children:a?S.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 rounded-2xl border border-[color:var(--color-gray-200)] bg-white p-8 text-center shadow-sm dark:border-[color:var(--color-gray-700)] dark:bg-[color:var(--color-gray-dark)]",children:[S.jsx("h3",{className:"text-lg font-semibold text-[color:var(--color-gray-800)] dark:text-white",children:On}),S.jsx("p",{className:"max-w-md text-sm text-[color:var(--color-gray-600)] dark:text-[color:var(--color-gray-300)]",children:Mn}),S.jsx(V,{variant:"success",onClick:function(){return gr()},children:Ln})]}):S.jsx(J,{columns:Ir,data:Yn,pageIndex:qe-1,pageSize:Ve,pageCount:Xn,onPageChange:function(e){return Ge(e+1)},showGlobalSearch:!1,showFilters:!1,onRowClick:function(e){return gr(e)},wrapCellsAsBadges:!0,badgeClassName:Yt,badgeWrapperClassName:Jt,badgeEmptyPlaceholder:Gt})},e.key)}if("employees"===e.key){var l=0===Jn.length;return S.jsx(Kt,{value:e.key,className:"mt-0 flex flex-col gap-4",children:l?S.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 rounded-2xl border border-[color:var(--color-gray-200)] bg-white p-8 text-center shadow-sm dark:border-[color:var(--color-gray-700)] dark:bg-[color:var(--color-gray-dark)]",children:[S.jsx("h3",{className:"text-lg font-semibold text-[color:var(--color-gray-800)] dark:text-white",children:On}),S.jsx("p",{className:"max-w-md text-sm text-[color:var(--color-gray-600)] dark:text-[color:var(--color-gray-300)]",children:Mn}),S.jsx(V,{variant:"success",onClick:function(){return yr()},children:Kn})]}):S.jsx(J,{columns:Er,data:Jn,pageIndex:qe-1,pageSize:Ve,pageCount:Xn,onPageChange:function(e){return Ge(e+1)},showGlobalSearch:!1,showFilters:!1,onRowClick:function(e){return yr(e)},wrapCellsAsBadges:!0,badgeClassName:Yt,badgeWrapperClassName:Jt,badgeEmptyPlaceholder:Gt})},e.key)}if("tasks"===e.key)return S.jsx(Kt,{value:e.key,className:"mt-0",children:S.jsx(dr,{fields:Ct,types:Et,loading:Wt,onSaveField:mr,onDeleteField:fr,onSaveType:vr,onDeleteType:hr})},e.key);if("fleets"===e.key)return S.jsx(Kt,{value:e.key,className:"mt-0",children:S.jsx(ar,{})},e.key);var i=0===r.length;return S.jsx(Kt,{value:e.key,className:"mt-0 flex flex-col gap-4",children:t&&U?S.jsx("div",{className:"flex min-h-[12rem] items-center justify-center rounded-2xl border border-[color:var(--color-gray-200)] bg-white shadow-sm dark:border-[color:var(--color-gray-700)] dark:bg-[color:var(--color-gray-dark)]",children:S.jsx(oe,{className:"h-6 w-6 text-[color:var(--color-brand-500)]"})}):i?S.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 rounded-2xl border border-[color:var(--color-gray-200)] bg-white p-8 text-center shadow-sm dark:border-[color:var(--color-gray-700)] dark:bg-[color:var(--color-gray-dark)]",children:[S.jsx("h3",{className:"text-lg font-semibold text-[color:var(--color-gray-800)] dark:text-white",children:On}),S.jsx("p",{className:"max-w-md text-sm text-[color:var(--color-gray-600)] dark:text-[color:var(--color-gray-300)]",children:Mn}),S.jsx(V,{variant:"success",onClick:function(){return pr()},children:Dn})]}):S.jsx(J,{columns:n,data:r,pageIndex:Q-1,pageSize:Ve,pageCount:qn,onPageChange:function(e){return $(e+1)},showGlobalSearch:!1,showFilters:!1,onRowClick:function(e){return pr(e)},wrapCellsAsBadges:!0,badgeClassName:Yt,badgeWrapperClassName:Jt,badgeEmptyPlaceholder:Gt})},e.key)})]})]}),S.jsx(P,{open:ut,onClose:xr,children:S.jsxs("div",{className:"space-y-4",children:[ft?S.jsx("article",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4 shadow-sm",children:"departments"===ft.type?S.jsxs(S.Fragment,{children:[S.jsx("h3",{className:"text-base font-semibold",children:"Информация о департаменте"}),S.jsxs("dl",{className:"mt-2 space-y-3 text-sm",children:[S.jsxs("div",{className:"flex justify-between gap-4",children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"ID"}),S.jsx("dd",{className:"text-right text-slate-900",children:ft._id})]}),S.jsxs("div",{className:"flex justify-between gap-4",children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Название"}),S.jsx("dd",{className:"text-right text-slate-900",children:ft.name})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Отделы департамента"}),S.jsx("dd",{className:"mt-2",children:Kr($n)})]})]})]}):"divisions"===ft.type?S.jsxs(S.Fragment,{children:[S.jsx("h3",{className:"text-base font-semibold",children:"Информация о департаменте"}),S.jsxs("dl",{className:"mt-2 space-y-3 text-sm",children:[S.jsxs("div",{className:"flex justify-between gap-4",children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"ID"}),S.jsx("dd",{className:"text-right text-slate-900",children:ft._id})]}),S.jsxs("div",{className:"flex justify-between gap-4",children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Название"}),S.jsx("dd",{className:"text-right text-slate-900",children:ft.name})]}),S.jsxs("div",{className:"flex justify-between gap-4",children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Департамент"}),S.jsx("dd",{className:"text-right text-slate-900",children:ea||"—"})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Должности отдела"}),S.jsx("dd",{className:"mt-2",children:Kr(ta)})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Сотрудники отдела"}),S.jsx("dd",{className:"mt-2",children:Kr(ra)})]})]})]}):S.jsxs(S.Fragment,{children:[S.jsx("h3",{className:"text-base font-semibold",children:"Карточка элемента"}),S.jsxs("dl",{className:"mt-2 space-y-1 text-sm",children:[S.jsxs("div",{className:"flex justify-between gap-4",children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"ID"}),S.jsx("dd",{className:"text-right text-slate-900",children:ft._id})]}),S.jsxs("div",{className:"flex justify-between gap-4",children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Название"}),S.jsx("dd",{className:"text-right text-slate-900",children:ft.name})]}),S.jsxs("div",{className:"flex justify-between gap-4",children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Тип"}),S.jsx("dd",{className:"text-right text-slate-900",children:ft.type})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Значение"}),S.jsx("dd",{className:"mt-1 rounded bg-white p-2 font-mono text-xs text-slate-900",children:ft.value||"—"})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Meta"}),S.jsx("dd",{className:"mt-1",children:S.jsx("pre",{className:"max-h-48 overflow-auto rounded bg-white p-2 text-xs text-slate-800",children:ft.meta?JSON.stringify(ft.meta,null,2):"{}"})})]})]})]})}):null,S.jsx(Vt,{form:se,onChange:ce,onSubmit:Vr,onDelete:Pr,onReset:function(){return ce({name:"",value:""})},valueLabel:"departments"===N?"Отделы":"divisions"===N?"Департамент":"positions"===N?"Отдел":void 0,renderValueField:"departments"===N?Bn:"divisions"===N?zn:"positions"===N?Zn:void 0,readonly:$t.readonly,readonlyNotice:$t.notice})]})}),S.jsx(P,{open:rt,onClose:br,children:S.jsxs("div",{className:"space-y-4",children:[S.jsxs("article",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4 shadow-sm",children:[S.jsxs("header",{className:"flex items-start justify-between gap-3",children:[S.jsxs("div",{children:[S.jsx("h3",{className:"text-base font-semibold",children:"Карточка пользователя"}),S.jsxs("p",{className:"text-sm text-slate-500",children:["Telegram ID: ",null!==(r=lt.telegram_id)&&void 0!==r?r:"—"]})]}),Xt&&lt.telegram_id?S.jsx(V,{type:"button",variant:"destructive",className:"h-9 px-3 text-sm",onClick:function(){return Bt(!0)},children:"Удалить"}):null]}),S.jsxs("dl",{className:"mt-2 grid grid-cols-1 gap-2 text-sm sm:grid-cols-2",children:[S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Логин"}),S.jsx("dd",{className:"text-slate-900",children:lt.username||"—"})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Имя"}),S.jsx("dd",{className:"text-slate-900",children:lt.name||"—"})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Телефон"}),S.jsx("dd",{className:"text-slate-900",children:lt.phone||"—"})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Мобильный"}),S.jsx("dd",{className:"text-slate-900",children:lt.mobNumber||"—"})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Email"}),S.jsx("dd",{className:"text-slate-900",children:lt.email||"—"})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Роль"}),S.jsx("dd",{className:"text-slate-900",children:be(lt.role)})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Доступ"}),S.jsx("dd",{className:"text-slate-900",children:lt.access})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Роль ID"}),S.jsx("dd",{className:"text-slate-900",children:lt.roleId?be(null!==(n=gn.get(lt.roleId))&&void 0!==n?n:lt.roleId):"—"})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Департамент"}),S.jsx("dd",{className:"text-slate-900",children:lt.departmentId?null!==(a=Yr.get(lt.departmentId))&&void 0!==a?a:lt.departmentId:"—"})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Отдел"}),S.jsx("dd",{className:"text-slate-900",children:lt.divisionId?null!==(l=Jr.get(lt.divisionId))&&void 0!==l?l:lt.divisionId:"—"})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Должность"}),S.jsx("dd",{className:"text-slate-900",children:lt.positionId?null!==(i=Qr.get(lt.positionId))&&void 0!==i?i:lt.positionId:"—"})]})]})]}),S.jsx(Wr,{form:lt,onChange:it,onSubmit:Zr,onReset:function(){return it(Lr)}})]})}),S.jsx(P,{open:yt,onClose:function(){return jt(!1)},children:S.jsxs("div",{className:"space-y-4",children:[Qn?S.jsxs("article",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4 shadow-sm",children:[S.jsxs("header",{className:"flex items-start justify-between gap-3",children:[S.jsxs("div",{children:[S.jsx("h3",{className:"text-base font-semibold",children:"Карточка сотрудника"}),S.jsxs("p",{className:"text-sm text-slate-500",children:["ID: ",null!==(s=Qn.telegram_id)&&void 0!==s?s:"—"]})]}),Xt&&Qn.telegram_id?S.jsx(V,{type:"button",variant:"destructive",className:"h-9 px-3 text-sm",onClick:function(){return qt(!0)},children:"Удалить"}):null]}),S.jsxs("dl",{className:"mt-2 grid grid-cols-1 gap-2 text-sm sm:grid-cols-2",children:[S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Telegram ID"}),S.jsx("dd",{className:"text-slate-900",children:Qn.telegram_id})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Логин"}),S.jsx("dd",{className:"text-slate-900",children:Qn.username||"—"})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Имя"}),S.jsx("dd",{className:"text-slate-900",children:Qn.name||"—"})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Телефон"}),S.jsx("dd",{className:"text-slate-900",children:Qn.phone||"—"})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Мобильный"}),S.jsx("dd",{className:"text-slate-900",children:Qn.mobNumber||"—"})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Email"}),S.jsx("dd",{className:"text-slate-900",children:Qn.email||"—"})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Роль"}),S.jsx("dd",{className:"text-slate-900",children:be(Qn.role)})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Доступ"}),S.jsx("dd",{className:"text-slate-900",children:null!==(o=Qn.access)&&void 0!==o?o:"—"})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Роль ID"}),S.jsx("dd",{className:"text-slate-900",children:Qn.roleId?be(null!==(c=gn.get(Qn.roleId))&&void 0!==c?c:Qn.roleId):"—"})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Департамент"}),S.jsx("dd",{className:"text-slate-900",children:Qn.departmentId?null!==(u=Yr.get(Qn.departmentId))&&void 0!==u?u:Qn.departmentId:"—"})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Отдел"}),S.jsx("dd",{className:"text-slate-900",children:Qn.divisionId?null!==(d=Jr.get(Qn.divisionId))&&void 0!==d?d:Qn.divisionId:"—"})]}),S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:"Должность"}),S.jsx("dd",{className:"text-slate-900",children:Qn.positionId?null!==(m=Qr.get(Qn.positionId))&&void 0!==m?m:Qn.positionId:"—"})]})]})]}):null,S.jsx(Ne,{telegramId:"update"===kt?xt:void 0,mode:kt,onSaved:function(e){cr(),void 0!==e.telegram_id&&(gt(String(e.telegram_id)),wt("update"))}})]})}),S.jsx(ge,{open:Pt,message:"Удалить пользователя? Это действие нельзя отменить.",onConfirm:Fr,onCancel:function(){return Bt(!1)},confirmText:"Удалить"}),S.jsx(ge,{open:Zt,message:"Удалить сотрудника? Это действие нельзя отменить.",onConfirm:Hr,onCancel:function(){return qt(!1)},confirmText:"Удалить"}),S.jsx(Kt,{value:"reports",className:"mt-0",children:S.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm dark:border-slate-700 dark:bg-slate-900",children:S.jsx(Cr,{})})}),S.jsx(Kt,{value:"archive",className:"mt-0",children:S.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm dark:border-slate-700 dark:bg-slate-900",children:S.jsx(Ie,{})})}),S.jsx(Kt,{value:"logs",className:"mt-0",children:S.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm dark:border-slate-700 dark:bg-slate-900",children:S.jsx(Ee,{})})}),S.jsx(Kt,{value:"storage",className:"mt-0",children:S.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm dark:border-slate-700 dark:bg-slate-900",children:S.jsx(Y,{})})})]})})});var Re=A.forwardRef(De);function Le(e,r){var n=e.title,a=e.titleId,l=M(e,t);return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":a},l),n?A.createElement("title",{id:a},n):null,A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"}))}var Ue=A.forwardRef(Le);function Ke(e,t){var n=e.title,a=e.titleId,l=M(e,r);return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},l),n?A.createElement("title",{id:a},n):null,A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 21h19.5m-18-18v18m10.5-18v18m6-13.5V21M6.75 6.75h.75m-.75 3h.75m-.75 3h.75m3-6h.75m-.75 3h.75m-.75 3h.75M6.75 21v-3.375c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21M3 3h12m-.75 4.5H21m-3.75 3.75h.008v.008h-.008v-.008Zm0 3h.008v.008h-.008v-.008Zm0 3h.008v.008h-.008v-.008Z"}))}var Fe=A.forwardRef(Ke);function He(e,t){var r=e.title,a=e.titleId,l=M(e,n);return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},l),r?A.createElement("title",{id:a},r):null,A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}var Ve=A.forwardRef(He);function Pe(e,t){var r=e.title,n=e.titleId,l=M(e,a);return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},l),r?A.createElement("title",{id:n},r):null,A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"}))}var Be=A.forwardRef(Pe);function ze(e,t){var r=e.title,n=e.titleId,a=M(e,l);return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},a),r?A.createElement("title",{id:n},r):null,A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 9h3.75M15 12h3.75M15 15h3.75M4.5 19.5h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Zm6-10.125a1.875 1.875 0 1 1-3.75 0 1.875 1.875 0 0 1 3.75 0Zm1.294 6.336a6.721 6.721 0 0 1-3.17.789 6.721 6.721 0 0 1-3.168-.789 3.376 3.376 0 0 1 6.338 0Z"}))}var Ze=A.forwardRef(ze);function qe(e,t){var r=e.title,n=e.titleId,a=M(e,i);return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},a),r?A.createElement("title",{id:n},r):null,A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"}))}var Ge=A.forwardRef(qe);function Xe(e,t){var r=e.title,n=e.titleId,a=M(e,s);return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},a),r?A.createElement("title",{id:n},r):null,A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6.878V6a2.25 2.25 0 0 1 2.25-2.25h7.5A2.25 2.25 0 0 1 18 6v.878m-12 0c.235-.083.487-.128.75-.128h10.5c.263 0 .515.045.75.128m-12 0A2.25 2.25 0 0 0 4.5 9v.878m13.5-3A2.25 2.25 0 0 1 19.5 9v.878m0 0a2.246 2.246 0 0 0-.75-.128H5.25c-.263 0-.515.045-.75.128m15 0A2.25 2.25 0 0 1 21 12v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6c0-.98.626-1.813 1.5-2.122"}))}var Ye=A.forwardRef(Xe);function Je(e,t){var r=e.title,n=e.titleId,a=M(e,o);return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},a),r?A.createElement("title",{id:n},r):null,A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6a2.25 2.25 0 0 1-2.25-2.25V6ZM3.75 15.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25V18a2.25 2.25 0 0 1-2.25 2.25H6A2.25 2.25 0 0 1 3.75 18v-2.25ZM13.5 6a2.25 2.25 0 0 1 2.25-2.25H18A2.25 2.25 0 0 1 20.25 6v2.25A2.25 2.25 0 0 1 18 10.5h-2.25a2.25 2.25 0 0 1-2.25-2.25V6ZM13.5 15.75a2.25 2.25 0 0 1 2.25-2.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-2.25A2.25 2.25 0 0 1 13.5 18v-2.25Z"}))}var Qe=A.forwardRef(Je);function $e(e,t){var r=e.title,n=e.titleId,a=M(e,c);return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},a),r?A.createElement("title",{id:n},r):null,A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 0 0-3.213-9.193 2.056 2.056 0 0 0-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 0 0-10.026 0 1.106 1.106 0 0 0-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12"}))}var et=A.forwardRef($e);function tt(e,t){var r=e.title,n=e.titleId,a=M(e,u);return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},a),r?A.createElement("title",{id:n},r):null,A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}var rt,nt=A.forwardRef(tt),at={exports:{}};var lt=function(){if(rt)return at.exports;rt=1;var e={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Ấ":"A","Ắ":"A","Ẳ":"A","Ẵ":"A","Ặ":"A","Æ":"AE","Ầ":"A","Ằ":"A","Ȃ":"A","Ả":"A","Ạ":"A","Ẩ":"A","Ẫ":"A","Ậ":"A","Ç":"C","Ḉ":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ế":"E","Ḗ":"E","Ề":"E","Ḕ":"E","Ḝ":"E","Ȇ":"E","Ẻ":"E","Ẽ":"E","Ẹ":"E","Ể":"E","Ễ":"E","Ệ":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ḯ":"I","Ȋ":"I","Ỉ":"I","Ị":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","Ố":"O","Ṍ":"O","Ṓ":"O","Ȏ":"O","Ỏ":"O","Ọ":"O","Ổ":"O","Ỗ":"O","Ộ":"O","Ờ":"O","Ở":"O","Ỡ":"O","Ớ":"O","Ợ":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ủ":"U","Ụ":"U","Ử":"U","Ữ":"U","Ự":"U","Ý":"Y","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","ấ":"a","ắ":"a","ẳ":"a","ẵ":"a","ặ":"a","æ":"ae","ầ":"a","ằ":"a","ȃ":"a","ả":"a","ạ":"a","ẩ":"a","ẫ":"a","ậ":"a","ç":"c","ḉ":"c","è":"e","é":"e","ê":"e","ë":"e","ế":"e","ḗ":"e","ề":"e","ḕ":"e","ḝ":"e","ȇ":"e","ẻ":"e","ẽ":"e","ẹ":"e","ể":"e","ễ":"e","ệ":"e","ì":"i","í":"i","î":"i","ï":"i","ḯ":"i","ȋ":"i","ỉ":"i","ị":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","ố":"o","ṍ":"o","ṓ":"o","ȏ":"o","ỏ":"o","ọ":"o","ổ":"o","ỗ":"o","ộ":"o","ờ":"o","ở":"o","ỡ":"o","ớ":"o","ợ":"o","ù":"u","ú":"u","û":"u","ü":"u","ủ":"u","ụ":"u","ử":"u","ữ":"u","ự":"u","ý":"y","ÿ":"y","Ā":"A","ā":"a","Ă":"A","ă":"a","Ą":"A","ą":"a","Ć":"C","ć":"c","Ĉ":"C","ĉ":"c","Ċ":"C","ċ":"c","Č":"C","č":"c","C̆":"C","c̆":"c","Ď":"D","ď":"d","Đ":"D","đ":"d","Ē":"E","ē":"e","Ĕ":"E","ĕ":"e","Ė":"E","ė":"e","Ę":"E","ę":"e","Ě":"E","ě":"e","Ĝ":"G","Ǵ":"G","ĝ":"g","ǵ":"g","Ğ":"G","ğ":"g","Ġ":"G","ġ":"g","Ģ":"G","ģ":"g","Ĥ":"H","ĥ":"h","Ħ":"H","ħ":"h","Ḫ":"H","ḫ":"h","Ĩ":"I","ĩ":"i","Ī":"I","ī":"i","Ĭ":"I","ĭ":"i","Į":"I","į":"i","İ":"I","ı":"i","Ĳ":"IJ","ĳ":"ij","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","Ḱ":"K","ḱ":"k","K̆":"K","k̆":"k","Ĺ":"L","ĺ":"l","Ļ":"L","ļ":"l","Ľ":"L","ľ":"l","Ŀ":"L","ŀ":"l","Ł":"l","ł":"l","Ḿ":"M","ḿ":"m","M̆":"M","m̆":"m","Ń":"N","ń":"n","Ņ":"N","ņ":"n","Ň":"N","ň":"n","ŉ":"n","N̆":"N","n̆":"n","Ō":"O","ō":"o","Ŏ":"O","ŏ":"o","Ő":"O","ő":"o","Œ":"OE","œ":"oe","P̆":"P","p̆":"p","Ŕ":"R","ŕ":"r","Ŗ":"R","ŗ":"r","Ř":"R","ř":"r","R̆":"R","r̆":"r","Ȓ":"R","ȓ":"r","Ś":"S","ś":"s","Ŝ":"S","ŝ":"s","Ş":"S","Ș":"S","ș":"s","ş":"s","Š":"S","š":"s","Ţ":"T","ţ":"t","ț":"t","Ț":"T","Ť":"T","ť":"t","Ŧ":"T","ŧ":"t","T̆":"T","t̆":"t","Ũ":"U","ũ":"u","Ū":"U","ū":"u","Ŭ":"U","ŭ":"u","Ů":"U","ů":"u","Ű":"U","ű":"u","Ų":"U","ų":"u","Ȗ":"U","ȗ":"u","V̆":"V","v̆":"v","Ŵ":"W","ŵ":"w","Ẃ":"W","ẃ":"w","X̆":"X","x̆":"x","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Y̆":"Y","y̆":"y","Ź":"Z","ź":"z","Ż":"Z","ż":"z","Ž":"Z","ž":"z","ſ":"s","ƒ":"f","Ơ":"O","ơ":"o","Ư":"U","ư":"u","Ǎ":"A","ǎ":"a","Ǐ":"I","ǐ":"i","Ǒ":"O","ǒ":"o","Ǔ":"U","ǔ":"u","Ǖ":"U","ǖ":"u","Ǘ":"U","ǘ":"u","Ǚ":"U","ǚ":"u","Ǜ":"U","ǜ":"u","Ứ":"U","ứ":"u","Ṹ":"U","ṹ":"u","Ǻ":"A","ǻ":"a","Ǽ":"AE","ǽ":"ae","Ǿ":"O","ǿ":"o","Þ":"TH","þ":"th","Ṕ":"P","ṕ":"p","Ṥ":"S","ṥ":"s","X́":"X","x́":"x","Ѓ":"Г","ѓ":"г","Ќ":"К","ќ":"к","A̋":"A","a̋":"a","E̋":"E","e̋":"e","I̋":"I","i̋":"i","Ǹ":"N","ǹ":"n","Ồ":"O","ồ":"o","Ṑ":"O","ṑ":"o","Ừ":"U","ừ":"u","Ẁ":"W","ẁ":"w","Ỳ":"Y","ỳ":"y","Ȁ":"A","ȁ":"a","Ȅ":"E","ȅ":"e","Ȉ":"I","ȉ":"i","Ȍ":"O","ȍ":"o","Ȑ":"R","ȑ":"r","Ȕ":"U","ȕ":"u","B̌":"B","b̌":"b","Č̣":"C","č̣":"c","Ê̌":"E","ê̌":"e","F̌":"F","f̌":"f","Ǧ":"G","ǧ":"g","Ȟ":"H","ȟ":"h","J̌":"J","ǰ":"j","Ǩ":"K","ǩ":"k","M̌":"M","m̌":"m","P̌":"P","p̌":"p","Q̌":"Q","q̌":"q","Ř̩":"R","ř̩":"r","Ṧ":"S","ṧ":"s","V̌":"V","v̌":"v","W̌":"W","w̌":"w","X̌":"X","x̌":"x","Y̌":"Y","y̌":"y","A̧":"A","a̧":"a","B̧":"B","b̧":"b","Ḑ":"D","ḑ":"d","Ȩ":"E","ȩ":"e","Ɛ̧":"E","ɛ̧":"e","Ḩ":"H","ḩ":"h","I̧":"I","i̧":"i","Ɨ̧":"I","ɨ̧":"i","M̧":"M","m̧":"m","O̧":"O","o̧":"o","Q̧":"Q","q̧":"q","U̧":"U","u̧":"u","X̧":"X","x̧":"x","Z̧":"Z","z̧":"z","й":"и","Й":"И","ё":"е","Ё":"Е"},t=Object.keys(e).join("|"),r=new RegExp(t,"g"),n=new RegExp(t,"");function a(t){return e[t]}var l=function(e){return e.replace(r,a)};return at.exports=l,at.exports.has=function(e){return!!e.match(n)},at.exports.remove=l,at.exports}(),it=D(lt),st={CASE_SENSITIVE_EQUAL:7,EQUAL:6,STARTS_WITH:5,WORD_STARTS_WITH:4,CONTAINS:3,ACRONYM:2,MATCHES:1,NO_MATCH:0},ot=function(e,t){return String(e.rankedValue).localeCompare(String(t.rankedValue))};function ct(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.keys,a=r.threshold,l=void 0===a?st.MATCHES:a,i=r.baseSort,s=void 0===i?ot:i,o=r.sorter,c=void 0===o?function(e){return e.sort(function(e,t){return function(e,t,r){var n=-1,a=1,l=e.rank,i=e.keyIndex,s=t.rank,o=t.keyIndex;return l===s?i===o?r(e,t):i<o?n:a:l>s?n:a}(e,t,s)})}:o,u=e.reduce(function(e,a,i){var s=function(e,t,r,n){if(!t){return{rankedValue:e,rank:dt(e,r,n),keyIndex:-1,keyThreshold:n.threshold}}var a=function(e,t){for(var r=[],n=0,a=t.length;n<a;n++)for(var l=t[n],i=ht(l),s=ft(e,l),o=0,c=s.length;o<c;o++)r.push({itemValue:s[o],attributes:i});return r}(e,t);return a.reduce(function(e,t,a){var l=e.rank,i=e.rankedValue,s=e.keyIndex,o=e.keyThreshold,c=t.itemValue,u=t.attributes,d=dt(c,r,n),m=i,f=u.minRanking,v=u.maxRanking,h=u.threshold;return d<f&&d>=st.MATCHES?d=f:d>v&&(d=v),d>l&&(l=d,s=a,o=h,m=c),{rankedValue:m,rank:l,keyIndex:s,keyThreshold:o}},{rankedValue:e,rank:st.NO_MATCH,keyIndex:-1,keyThreshold:n.threshold})}(a,n,t,r),o=s.rank,c=s.keyThreshold;o>=(void 0===c?l:c)&&e.push(W(W({},s),{},{item:a,index:i}));return e},[]);return c(u).map(function(e){return e.item})}function ut(e,t){var r;return E().w(function(n){for(;;)switch(n.n){case 0:r=-1;case 1:if(!((r=e.indexOf(t,r+1))>-1)){n.n=3;break}return n.n=2,r;case 2:n.n=1;break;case 3:return n.a(2,-1)}},Me)}function dt(e,t,r){if(e=mt(e,r),(t=mt(t,r)).length>e.length)return st.NO_MATCH;if(e===t)return st.CASE_SENSITIVE_EQUAL;var n=ut(e=e.toLowerCase(),t=t.toLowerCase()),a=n.next(),l=a.value;if(e.length===t.length&&0===l)return st.EQUAL;if(0===l)return st.STARTS_WITH;for(var i=a;!i.done;){if(i.value>0&&" "===e[i.value-1])return st.WORD_STARTS_WITH;i=n.next()}return l>0?st.CONTAINS:1===t.length?st.NO_MATCH:function(e){for(var t="",r=" ",n=0;n<e.length;n++){var a=e.charAt(n);(" "===r||"-"===r)&&!(" "===a||"-"===a)&&(t+=a),r=a}return t}(e).includes(t)?st.ACRONYM:function(e,t){var r=0,n=0;function a(e,t,n){for(var a=n,l=t.length;a<l;a++){if(t[a]===e)return r+=1,a+1}return-1}function l(e){var n=1/e,a=r/t.length;return st.MATCHES+a*n}var i=a(t[0],e,0);if(i<0)return st.NO_MATCH;n=i;for(var s=1,o=t.length;s<o;s++){if(!((n=a(t[s],e,n))>-1))return st.NO_MATCH}return l(n-i)}(e,t)}function mt(e,t){var r=t.keepDiacritics;return e="".concat(e),r||(e=it(e)),e}function ft(e,t){var r;if("object"===I(t)&&(t=t.key),"function"==typeof t)r=t(e);else if(null==e)r=null;else if(Object.hasOwnProperty.call(e,t))r=e[t];else{if(t.includes("."))return function(e,t){for(var r=e.split("."),n=[t],a=0,l=r.length;a<l;a++){for(var i=r[a],s=[],o=0,c=n.length;o<c;o++){var u=n[o];if(null!=u)if(Object.hasOwnProperty.call(u,i)){var d=u[i];null!=d&&s.push(d)}else"*"===i&&(s=s.concat(u))}n=s}if(Array.isArray(n[0])){var m=[];return m.concat.apply(m,_(n))}return n}(t,e);r=null}return null==r?[]:Array.isArray(r)?r:[String(r)]}ct.rankings=st;var vt={maxRanking:1/0,minRanking:-1/0};function ht(e){return"string"==typeof e?vt:W(W({},vt),e)}var pt="Tabs",xt=w(ee(pt,[ne]),2),gt=xt[0],bt=(xt[1],ne()),yt=w(gt(pt),2),jt=yt[0],Nt=yt[1],kt=A.forwardRef(function(e,t){var r=e.__scopeTabs,n=e.value,a=e.onValueChange,l=e.defaultValue,i=e.orientation,s=void 0===i?"horizontal":i,o=e.dir,c=e.activationMode,u=void 0===c?"automatic":c,m=M(e,d),f=Q(o),v=w($({prop:n,onChange:a,defaultProp:null!=l?l:"",caller:pt}),2),h=v[0],p=v[1];return S.jsx(jt,{scope:r,baseId:te(),value:h,onValueChange:p,orientation:s,dir:f,activationMode:u,children:S.jsx(re.div,W(W({dir:f,"data-orientation":s},m),{},{ref:t}))})});kt.displayName=pt;var wt="TabsList",_t=A.forwardRef(function(e,t){var r=e.__scopeTabs,n=e.loop,a=void 0===n||n,l=M(e,m),i=Nt(wt,r),s=bt(r);return S.jsx(ae,W(W({asChild:!0},s),{},{orientation:i.orientation,dir:i.dir,loop:a,children:S.jsx(re.div,W(W({role:"tablist","aria-orientation":i.orientation},l),{},{ref:t}))}))});_t.displayName=wt;var Ct="TabsTrigger",St=A.forwardRef(function(e,t){var r=e.__scopeTabs,n=e.value,a=e.disabled,l=void 0!==a&&a,i=M(e,f),s=Nt(Ct,r),o=bt(r),c=Tt(s.baseId,n),u=At(s.baseId,n),d=n===s.value;return S.jsx(le,W(W({asChild:!0},o),{},{focusable:!l,active:d,children:S.jsx(re.button,W(W({type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":l?"":void 0,disabled:l,id:c},i),{},{ref:t,onMouseDown:ie(e.onMouseDown,function(e){l||0!==e.button||!1!==e.ctrlKey?e.preventDefault():s.onValueChange(n)}),onKeyDown:ie(e.onKeyDown,function(e){[" ","Enter"].includes(e.key)&&s.onValueChange(n)}),onFocus:ie(e.onFocus,function(){var e="manual"!==s.activationMode;d||l||!e||s.onValueChange(n)})}))}))});St.displayName=Ct;var It="TabsContent",Et=A.forwardRef(function(e,t){var r=e.__scopeTabs,n=e.value,a=e.forceMount,l=e.children,i=M(e,v),s=Nt(It,r),o=Tt(s.baseId,n),c=At(s.baseId,n),u=n===s.value,d=A.useRef(u);return A.useEffect(function(){var e=requestAnimationFrame(function(){return d.current=!1});return function(){return cancelAnimationFrame(e)}},[]),S.jsx(se,{present:a||u,children:function(r){var n=r.present;return S.jsx(re.div,W(W({"data-state":u?"active":"inactive","data-orientation":s.orientation,role:"tabpanel","aria-labelledby":o,hidden:!n,id:c,tabIndex:0},i),{},{ref:t,style:W(W({},e.style),{},{animationDuration:d.current?"0s":void 0}),children:n&&l}))}})});function Tt(e,t){return"".concat(e,"-trigger-").concat(t)}function At(e,t){return"".concat(e,"-content-").concat(t)}Et.displayName=It;var Wt=kt,Ot=_t,Mt=St,Dt=Et;function Rt(e){var t=e.className,r=M(e,h);return S.jsx(Wt,W({"data-slot":"tabs",className:H("flex flex-col gap-2",t)},r))}function Lt(e){var t=e.className,r=M(e,p);return S.jsx(Ot,W({"data-slot":"tabs-list",className:H("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",t)},r))}function Ut(e){var t=e.className,r=M(e,x);return S.jsx(Mt,W({"data-slot":"tabs-trigger",className:H("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t)},r))}function Kt(e){var t=e.className,r=M(e,g);return S.jsx(Dt,W({"data-slot":"tabs-content",className:H("flex-1 outline-none",t)},r))}function Ft(e){var t=e.breadcrumbs,r=e.title,n=e.description,a=e.toolbar,l=e.children,i=e.className;return S.jsxs("section",{className:H("flex flex-col gap-3 rounded-3xl border border-[color:var(--color-gray-200)]","bg-[color:var(--color-gray-25)] p-4 shadow-[var(--shadow-theme-sm)] sm:p-6","dark:border-[color:var(--color-gray-700)] dark:bg-[color:var(--color-gray-dark)]",i),children:[t?S.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-[color:var(--color-gray-500)] dark:text-[color:var(--color-gray-300)]",children:t}):null,r||n||a?S.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[S.jsxs("div",{className:"min-w-0 space-y-1",children:[r?S.jsx("h1",{className:"text-lg font-semibold text-[color:var(--color-gray-900)] dark:text-white sm:text-xl",children:r}):null,n?S.jsx("p",{className:"text-sm text-[color:var(--color-gray-600)] dark:text-[color:var(--color-gray-300)]",children:n}):null]}),a?S.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:a}):null]}):null,l?S.jsx("div",{className:"space-y-3 sm:space-y-4",children:l}):null]})}function Ht(e){var t=e.value,r=e.displayValue,n=e.copyHint,a=e.copiedHint,l=e.onCopy,i=e.className,s=e.disabled,o=M(e,b),c=w(R.useState(!1),2),u=c[0],d=c[1],m=R.useRef(),f=null!=r?r:t,v=null!=n?n:"Copy",h=null!=a?a:"Copied";R.useEffect(function(){return function(){m.current&&window.clearTimeout(m.current)}},[]),R.useEffect(function(){if(u)return m.current=window.setTimeout(function(){return d(!1)},1600),function(){m.current&&window.clearTimeout(m.current)}},[u]);var p=function(){var e=k(E().m(function e(){var r;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t&&!s){e.n=1;break}return e.a(2);case 1:return r=function(){var e=k(E().m(function e(){var r,n,a;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:if("undefined"==typeof navigator||null===(r=navigator.clipboard)||void 0===r||!r.writeText){e.n=2;break}return e.n=1,navigator.clipboard.writeText(t);case 1:return e.a(2,!0);case 2:if("undefined"!=typeof document){e.n=3;break}return e.a(2,!1);case 3:return(n=document.createElement("textarea")).value=t,n.setAttribute("readonly",""),n.style.position="absolute",n.style.left="-9999px",document.body.appendChild(n),n.select(),e.p=4,a=document.execCommand("copy"),e.a(2,a);case 5:return e.p=5,e.v,e.a(2,!1);case 6:return e.p=6,document.body.removeChild(n),e.f(6);case 7:return e.a(2)}},e,null,[[4,5,6,7]])}));return function(){return e.apply(this,arguments)}}(),e.p=2,e.n=3,r();case 3:e.v&&d(!0);case 4:return e.p=4,null==l||l({value:t}),e.f(4);case 5:return e.a(2)}},e,null,[[2,,4,5]])}));return function(){return e.apply(this,arguments)}}();return S.jsxs("button",W(W({type:"button",className:H("inline-flex items-center gap-1.5 rounded-full border border-[color:var(--color-gray-300)]","bg-[color:var(--color-gray-25)] px-3 py-1 text-[11px] font-semibold tracking-wide text-[color:var(--color-gray-700)]","transition-colors duration-150 ease-out hover:border-[color:var(--color-brand-400)] hover:bg-[color:var(--color-brand-50)]","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[color:var(--color-brand-500)] focus-visible:ring-offset-2","disabled:cursor-not-allowed disabled:border-[color:var(--color-gray-200)] disabled:text-[color:var(--color-gray-400)]","dark:border-[color:var(--color-gray-700)] dark:bg-[color:var(--color-gray-dark)] dark:text-[color:var(--color-gray-100)]","dark:hover:border-[color:var(--color-brand-400)] dark:hover:bg-[color:var(--color-gray-800)]",i),onClick:p,title:u?h:v,"aria-pressed":u,"aria-live":"polite",disabled:s},o),{},{children:[S.jsxs("span",{className:"inline-flex items-center gap-1",children:[u?S.jsx(Ve,{className:"h-4 w-4 text-[color:var(--color-brand-500)] dark:text-[color:var(--color-brand-400)]","aria-hidden":"true"}):S.jsx(Be,{className:"h-4 w-4 text-[color:var(--color-gray-500)] dark:text-[color:var(--color-gray-300)]","aria-hidden":"true"}),S.jsx("span",{className:"truncate text-left",children:f})]}),S.jsx("span",{className:"sr-only",children:u?h:v})]}))}function Vt(e){var t=e.form,r=e.onChange,n=e.onSubmit,a=e.onDelete,l=e.onReset,i=e.valueLabel,s=void 0===i?"Значение":i,o=e.renderValueField,c=e.readonly,u=void 0!==c&&c,d=e.readonlyNotice,m=w(R.useState(!1),2),f=m[0],v=m[1],h=w(R.useState(!1),2),p=h[0],x=h[1];return S.jsxs("form",{onSubmit:function(e){e.preventDefault(),u||x(!0)},className:"space-y-2",children:[S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium",children:"Имя"}),S.jsx("input",{id:"collection-form-name",name:"collectionName",className:"h-10 w-full rounded border px-3",value:t.name,onChange:function(e){return r(W(W({},t),{},{name:e.target.value}))},required:!0,disabled:u})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium",children:s}),o?o(t,u?function(){}:r,{readonly:u}):S.jsx("input",{id:"collection-form-value",name:"collectionValue",className:"h-10 w-full rounded border px-3",value:t.value,onChange:function(e){return r(W(W({},t),{},{value:e.target.value}))},required:!0,disabled:u})]}),u?S.jsx("p",{className:"rounded border border-amber-200 bg-amber-50 p-2 text-sm text-amber-900",children:null!=d?d:"Элемент доступен только для чтения."}):null,S.jsxs("div",{className:"flex gap-2",children:[S.jsx(V,{type:"submit",disabled:u,children:"Сохранить"}),t._id?S.jsx(V,{type:"button",variant:"destructive",disabled:u,onClick:function(){u||v(!0)},children:"Удалить"}):S.jsx(V,{type:"button",variant:"outline",onClick:l,disabled:u,children:"Очистить"})]}),S.jsx(ge,{open:p,message:"Сохранить изменения?",onConfirm:function(){x(!1),n()},onCancel:function(){return x(!1)},confirmText:"Сохранить"}),S.jsx(ge,{open:f,message:"Удалить элемент?",onConfirm:function(){v(!1),a()},onCancel:function(){return v(!1)}})]})}var Pt={name:"",registrationNumber:"",odometerInitial:"0",odometerCurrent:"0",mileageTotal:"0",transportType:"Легковой",fuelType:"Бензин",fuelRefilled:"0",fuelAverageConsumption:"0",fuelSpentTotal:"0",currentTasks:""},Bt=function(e){return e.split(/[\n,]/).map(function(e){return e.trim()}).filter(Boolean)};function zt(e){var t=e.open,r=e.mode,n=e.vehicle,a=e.saving,l=e.onSubmit,i=e.onDelete,s=e.onClose,o=w(A.useState(Pt),2),c=o[0],u=o[1],d=w(A.useState(null),2),m=d[0],f=d[1],v=w(A.useState(!1),2),h=v[0],p=v[1],x=w(A.useState(!1),2),g=x[0],b=x[1];A.useEffect(function(){if(t&&n){var e=Array.isArray(n.currentTasks)?n.currentTasks.filter(Boolean):[];return u({name:n.name,registrationNumber:n.registrationNumber,odometerInitial:String(n.odometerInitial),odometerCurrent:String(n.odometerCurrent),mileageTotal:String(n.mileageTotal),transportType:n.transportType,fuelType:n.fuelType,fuelRefilled:String(n.fuelRefilled),fuelAverageConsumption:String(n.fuelAverageConsumption),fuelSpentTotal:String(n.fuelSpentTotal),currentTasks:e.join("\n")}),f(null),p(!1),void b(!1)}t&&"create"===r&&(u(Pt),f(null),p(!1),b(!1)),t||(u(Pt),f(null),p(!1),b(!1))},[t,r,n]);var y="update"===r&&n,j=A.useMemo(function(){return{name:c.name.trim(),registrationNumber:c.registrationNumber.trim().toUpperCase(),odometerInitial:Number(c.odometerInitial||"0"),odometerCurrent:Number(c.odometerCurrent||"0"),mileageTotal:Number(c.mileageTotal||"0"),transportType:c.transportType,fuelType:c.fuelType,fuelRefilled:Number(c.fuelRefilled||"0"),fuelAverageConsumption:Number(c.fuelAverageConsumption||"0"),fuelSpentTotal:Number(c.fuelSpentTotal||"0"),currentTasks:Bt(c.currentTasks)}},[c]),N=function(){var e=k(E().m(function e(){var t,r;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,l(j,null==n?void 0:n.id);case 1:p(!1),s(),e.n=3;break;case 2:e.p=2,r=e.v,t=r instanceof Error?r.message:"Не удалось сохранить транспорт",f(t),p(!1);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}(),_=function(){var e=k(E().m(function e(){var t,r;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n&&i){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,i(n.id);case 2:b(!1),s(),e.n=4;break;case 3:e.p=3,r=e.v,t=r instanceof Error?r.message:"Не удалось удалить транспорт",f(t),b(!1);case 4:return e.a(2)}},e,null,[[1,3]])}));return function(){return e.apply(this,arguments)}}();return S.jsxs("form",{onSubmit:function(e){e.preventDefault(),c.name.trim()?/^[A-Z\u0404\u0406\u0407\u0410-\u042F]{2} [0-9]{4} [A-Z\u0404\u0406\u0407\u0410-\u042F]{2}$/.test(j.registrationNumber)?(f(null),p(!0)):f("Регистрационный номер должен быть в формате XX 0000 XX"):f("Название обязательно")},className:"space-y-3",children:[S.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[S.jsxs("label",{className:"flex flex-col gap-1",children:[S.jsx("span",{className:"text-sm font-medium",children:"Название"}),S.jsx("input",{id:"fleet-vehicle-name",name:"name",className:"h-10 w-full rounded border px-3",value:c.name,onChange:function(e){return u(function(t){return W(W({},t),{},{name:e.target.value})})},disabled:a,required:!0})]}),S.jsxs("label",{className:"flex flex-col gap-1",children:[S.jsx("span",{className:"text-sm font-medium",children:"Регистрационный номер"}),S.jsx("input",{id:"fleet-vehicle-registration",name:"registrationNumber",className:"h-10 w-full rounded border px-3 uppercase",value:c.registrationNumber,onChange:function(e){return u(function(t){return W(W({},t),{},{registrationNumber:e.target.value})})},disabled:a,required:!0,placeholder:"AA 1234 BB"})]}),S.jsxs("label",{className:"flex flex-col gap-1",children:[S.jsx("span",{className:"text-sm font-medium",children:"Тип транспорта"}),S.jsxs("select",{id:"fleet-vehicle-transport-type",name:"transportType",className:"h-10 w-full rounded border px-3",value:c.transportType,onChange:function(e){return u(function(t){return W(W({},t),{},{transportType:e.target.value})})},disabled:a,required:!0,children:[S.jsx("option",{value:"Легковой",children:"Легковой"}),S.jsx("option",{value:"Грузовой",children:"Грузовой"})]})]}),S.jsxs("label",{className:"flex flex-col gap-1",children:[S.jsx("span",{className:"text-sm font-medium",children:"Одометр начальный, км"}),S.jsx("input",{type:"number",min:"0",id:"fleet-vehicle-odometer-initial",name:"odometerInitial",className:"h-10 w-full rounded border px-3",value:c.odometerInitial,onChange:function(e){return u(function(t){return W(W({},t),{},{odometerInitial:e.target.value})})},disabled:a,required:!0})]}),S.jsxs("label",{className:"flex flex-col gap-1",children:[S.jsx("span",{className:"text-sm font-medium",children:"Одометр текущий, км"}),S.jsx("input",{type:"number",min:"0",id:"fleet-vehicle-odometer-current",name:"odometerCurrent",className:"h-10 w-full rounded border px-3",value:c.odometerCurrent,onChange:function(e){return u(function(t){return W(W({},t),{},{odometerCurrent:e.target.value})})},disabled:a,required:!0})]}),S.jsxs("label",{className:"flex flex-col gap-1",children:[S.jsx("span",{className:"text-sm font-medium",children:"Пробег общий, км"}),S.jsx("input",{type:"number",min:"0",id:"fleet-vehicle-mileage-total",name:"mileageTotal",className:"h-10 w-full rounded border px-3",value:c.mileageTotal,onChange:function(e){return u(function(t){return W(W({},t),{},{mileageTotal:e.target.value})})},disabled:a,required:!0})]}),S.jsxs("label",{className:"flex flex-col gap-1",children:[S.jsx("span",{className:"text-sm font-medium",children:"Вид топлива"}),S.jsxs("select",{id:"fleet-vehicle-fuel-type",name:"fuelType",className:"h-10 w-full rounded border px-3",value:c.fuelType,onChange:function(e){return u(function(t){return W(W({},t),{},{fuelType:e.target.value})})},disabled:a,children:[S.jsx("option",{value:"Бензин",children:"Бензин"}),S.jsx("option",{value:"Дизель",children:"Дизель"}),S.jsx("option",{value:"Газ",children:"Газ"})]})]}),S.jsxs("label",{className:"flex flex-col gap-1",children:[S.jsx("span",{className:"text-sm font-medium",children:"Топлива заправлено"}),S.jsx("input",{type:"number",min:"0",id:"fleet-vehicle-fuel-refilled",name:"fuelRefilled",className:"h-10 w-full rounded border px-3",value:c.fuelRefilled,onChange:function(e){return u(function(t){return W(W({},t),{},{fuelRefilled:e.target.value})})},disabled:a,required:!0})]}),S.jsxs("label",{className:"flex flex-col gap-1",children:[S.jsx("span",{className:"text-sm font-medium",children:"Расход средний, л/км"}),S.jsx("input",{type:"number",min:"0",step:"0.01",id:"fleet-vehicle-fuel-average",name:"fuelAverageConsumption",className:"h-10 w-full rounded border px-3",value:c.fuelAverageConsumption,onChange:function(e){return u(function(t){return W(W({},t),{},{fuelAverageConsumption:e.target.value})})},disabled:a,required:!0})]}),S.jsxs("label",{className:"flex flex-col gap-1",children:[S.jsx("span",{className:"text-sm font-medium",children:"Затрачено топлива всего, л"}),S.jsx("input",{type:"number",min:"0",id:"fleet-vehicle-fuel-spent",name:"fuelSpentTotal",className:"h-10 w-full rounded border px-3",value:c.fuelSpentTotal,onChange:function(e){return u(function(t){return W(W({},t),{},{fuelSpentTotal:e.target.value})})},disabled:a,required:!0})]})]}),S.jsxs("label",{className:"flex flex-col gap-1",children:[S.jsx("span",{className:"text-sm font-medium",children:"Текущие задачи (ID через запятую или перенос строки)"}),S.jsx("textarea",{id:"fleet-vehicle-current-tasks",name:"currentTasks",className:"min-h-[5rem] w-full rounded border px-3 py-2",value:c.currentTasks,onChange:function(e){return u(function(t){return W(W({},t),{},{currentTasks:e.target.value})})},disabled:a})]}),m?S.jsx("p",{className:"text-sm text-red-600",children:m}):null,S.jsxs("div",{className:"flex flex-wrap gap-2",children:[S.jsx(V,{type:"submit",disabled:a,children:"Сохранить"}),S.jsx(V,{type:"button",variant:"outline",onClick:s,disabled:a,children:"Отмена"}),y&&i?S.jsx(V,{type:"button",variant:"destructive",onClick:function(){return b(!0)},disabled:a,children:"Удалить"}):null]}),S.jsx(ge,{open:h,message:"Сохранить транспорт?",confirmText:"Сохранить",onConfirm:N,onCancel:function(){return p(!1)}}),S.jsx(ge,{open:g,message:"Удалить транспорт?",confirmText:"Удалить",status:"danger",onConfirm:_,onCancel:function(){return b(!1)}})]})}var Zt=function(e){if(null==e)return"";if(Array.isArray(e))return e.length?e.join(", "):"";if("object"===I(e))try{return JSON.stringify(e)}catch(t){return String(e)}return String(e)},qt=[{accessorKey:"name",header:"Название",meta:{minWidth:"8rem",maxWidth:"16rem"}},{accessorKey:"registrationNumber",header:"Рег. номер",meta:{minWidth:"8rem",maxWidth:"16rem"}},{accessorKey:"odometerInitial",header:"Одометр начальный",meta:{minWidth:"8rem",maxWidth:"14rem"}},{accessorKey:"odometerCurrent",header:"Одометр текущий",meta:{minWidth:"8rem",maxWidth:"14rem"}},{accessorKey:"mileageTotal",header:"Пробег",meta:{minWidth:"6rem",maxWidth:"12rem"}},{accessorKey:"transportType",header:"Тип транспорта",meta:{minWidth:"8rem",maxWidth:"14rem"}},{accessorKey:"fuelType",header:"Тип топлива",meta:{minWidth:"6rem",maxWidth:"12rem"}},{accessorKey:"fuelRefilled",header:"Заправлено",meta:{minWidth:"6rem",maxWidth:"10rem"}},{accessorKey:"fuelAverageConsumption",header:"Расход",meta:{minWidth:"6rem",maxWidth:"10rem"}},{accessorKey:"fuelSpentTotal",header:"Израсходовано",meta:{minWidth:"6rem",maxWidth:"10rem"}},{accessorKey:"currentTasks",header:"Текущие задачи",cell:function(e){var t=e.getValue;return Zt(t())},meta:{minWidth:"10rem",maxWidth:"24rem"}},{accessorKey:"transportHistoryInfo",header:"История задач",cell:function(e){var t=e.getValue;return Zt(t())},meta:{minWidth:"12rem",maxWidth:"28rem"}},{accessorKey:"createdAt",header:"Создан",meta:{minWidth:"10rem",maxWidth:"16rem"}},{accessorKey:"updatedAt",header:"Обновлён",meta:{minWidth:"10rem",maxWidth:"16rem"}},{accessorKey:"unitId",header:"Устройство",meta:{minWidth:"8rem",maxWidth:"12rem"}},{accessorKey:"remoteName",header:"Удалённое имя",meta:{minWidth:"8rem",maxWidth:"16rem"}},{accessorKey:"notes",header:"Примечания",meta:{minWidth:"10rem",maxWidth:"20rem"}}],Gt="Нет данных",Xt=["inline-flex min-h-[1.65rem] min-w-0 max-w-full items-center justify-start gap-1","rounded-full px-2.5 py-0.5 text-[0.72rem] font-semibold leading-tight text-slate-900","ring-1 ring-slate-300/80 bg-slate-100/95 shadow-xs","dark:text-slate-100 dark:ring-slate-600/60 dark:bg-slate-800/80","truncate"].join(" "),Yt="".concat(Xt),Jt="flex flex-wrap items-center gap-1.5",Qt=10,$t=new Intl.DateTimeFormat("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),er=function(e){if(!e)return"";var t=new Date(e);return Number.isNaN(t.getTime())?"":$t.format(t)},tr=function(e){var t=er(e.assignedAt),r=er(e.removedAt),n=e.taskTitle&&e.taskTitle.trim().length?e.taskTitle.trim():e.taskId;return t&&r?"".concat(t," — ").concat(n," (до ").concat(r,")"):t?"".concat(t," — ").concat(n):r?"".concat(n," (до ").concat(r,")"):n},rr=function(e){return null!=e&&e.length?e.map(tr).join("; "):""},nr=[{id:"id",label:"ID",render:function(e){return e.id}},{id:"name",label:"Название",render:function(e){return e.name}},{id:"registrationNumber",label:"Регистрационный номер",render:function(e){return e.registrationNumber}},{id:"odometerInitial",label:"Одометр начальный",render:function(e){return e.odometerInitial}},{id:"odometerCurrent",label:"Одометр текущий",render:function(e){return e.odometerCurrent}},{id:"mileageTotal",label:"Пробег",render:function(e){return e.mileageTotal}},{id:"transportType",label:"Тип транспорта",render:function(e){return e.transportType}},{id:"fuelType",label:"Тип топлива",render:function(e){return e.fuelType}},{id:"fuelRefilled",label:"Заправлено",render:function(e){return e.fuelRefilled}},{id:"fuelAverageConsumption",label:"Расход",render:function(e){return e.fuelAverageConsumption}},{id:"fuelSpentTotal",label:"Израсходовано",render:function(e){return e.fuelSpentTotal}},{id:"currentTasks",label:"Задачи",render:function(e){return e.currentTasks.length?e.currentTasks.join(", "):"—"}},{id:"transportHistory",label:"История задач",render:function(e){var t;return null!==(t=e.transportHistory)&&void 0!==t&&t.length?S.jsx("ul",{className:"space-y-1 text-sm",children:e.transportHistory.map(function(e){return S.jsx("li",{className:"leading-snug",children:tr(e)},"".concat(e.taskId,"-").concat(e.assignedAt))})}):"—"}},{id:"createdAt",label:"Создан",render:function(e){return e.createdAt||"—"}},{id:"updatedAt",label:"Обновлён",render:function(e){return e.updatedAt||"—"}},{id:"unitId",label:"Устройство",render:function(e){return void 0!==e.unitId&&null!==e.unitId?e.unitId:"—"}},{id:"remoteName",label:"Удалённое имя",render:function(e){return e.remoteName||"—"}},{id:"notes",label:"Примечания",render:function(e){return e.notes||"—"}}];function ar(){var e=w(A.useState([]),2),t=e[0],r=e[1],n=w(A.useState(0),2),a=n[0],l=n[1],i=w(A.useState(1),2),s=i[0],o=i[1],c=w(A.useState(""),2),u=c[0],d=c[1],m=w(A.useState(""),2),f=m[0],v=m[1],h=w(A.useState(!1),2),p=h[0],x=h[1],g=w(A.useState(""),2),b=g[0],y=g[1],j=w(A.useState(!1),2),N=j[0],_=j[1],C=w(A.useState("create"),2),I=C[0],T=C[1],O=w(A.useState(!1),2),M=O[0],D=O[1],R=w(A.useState(null),2),L=R[0],U=R[1],K=A.useMemo(function(){return Math.max(1,Math.ceil(a/Qt))},[a]),F=A.useMemo(function(){return t.map(function(e){return W(W({},e),{},{transportHistoryInfo:rr(e.transportHistory)})})},[t]),H=A.useMemo(function(){return"".concat(Yt," whitespace-nowrap sm:text-sm")},[]),z=A.useMemo(function(){return"".concat(Jt," justify-start")},[]),Z=A.useCallback(k(E().m(function e(){var t,n,a;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:return x(!0),y(""),e.p=1,e.n=2,ke(f,s,Qt);case 2:t=e.v,r(t.items),l(t.total),e.n=4;break;case 3:e.p=3,a=e.v,n=a instanceof Error?a.message:"Не удалось загрузить транспорт",y(n),r([]),l(0);case 4:return e.p=4,x(!1),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])})),[f,s]);A.useEffect(function(){Z()},[Z]);var q=function(){M||(_(!1),U(null))},G=function(){var e=k(E().m(function e(t,r){return E().w(function(e){for(;;)switch(e.p=e.n){case 0:if(D(!0),e.p=1,"create"!==I&&r){e.n=3;break}return e.n=2,we(t);case 2:B("Транспорт создан","success"),e.n=5;break;case 3:return e.n=4,_e(r,t);case 4:B("Транспорт обновлён","success");case 5:return e.n=6,Z();case 6:U(null),_(!1);case 7:return e.p=7,D(!1),e.f(7);case 8:return e.a(2)}},e,null,[[1,,7,8]])}));return function(t,r){return e.apply(this,arguments)}}(),X=function(){var e=k(E().m(function e(t){return E().w(function(e){for(;;)switch(e.p=e.n){case 0:return D(!0),e.p=1,e.n=2,Ce(t);case 2:return B("Транспорт удалён","success"),e.n=3,Z();case 3:U(null),_(!1);case 4:return e.p=4,D(!1),e.f(4);case 5:return e.a(2)}},e,null,[[1,,4,5]])}));return function(t){return e.apply(this,arguments)}}();return S.jsxs("section",{className:"space-y-4",children:[S.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:flex-wrap sm:items-start sm:gap-3 lg:items-center lg:gap-3",children:[S.jsxs("form",{onSubmit:function(e){e.preventDefault(),o(1),v(u.trim())},className:"mt-2 flex w-full flex-col gap-2 sm:flex-row sm:flex-wrap sm:items-center sm:gap-2 lg:grid lg:flex-1 lg:grid-cols-[minmax(0,18rem)_auto] lg:items-center lg:gap-3",children:[S.jsxs("label",{className:"flex w-full flex-col gap-1 sm:w-64 lg:w-full lg:min-w-0",children:[S.jsx("span",{className:"text-sm font-medium",children:"Поиск"}),S.jsx("input",{id:"fleet-vehicles-search",name:"fleetVehicleSearch",className:"h-10 w-full rounded border px-3 text-sm lg:h-9 lg:text-xs",value:u,onChange:function(e){return d(e.target.value)},placeholder:"Название или номер"})]}),S.jsx(V,{type:"submit",className:"h-10 w-full max-w-[11rem] px-3 text-sm font-semibold sm:h-10 sm:w-auto sm:px-3 lg:h-8 lg:text-xs",children:"Искать"})]}),S.jsx(V,{type:"button",variant:"success",className:"h-10 w-full max-w-[11rem] px-3 text-sm font-semibold sm:w-auto lg:h-8 lg:text-xs",onClick:function(){T("create"),U(null),_(!0)},children:"Добавить"})]}),p?S.jsx("p",{className:"text-sm text-gray-500",children:"Загрузка транспорта…"}):null,b?S.jsx("p",{className:"rounded border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:b}):null,p||b||t.length?null:S.jsx("p",{className:"text-sm text-gray-500",children:"Транспорт не найден."}),S.jsx(J,{columns:qt,data:F,pageIndex:s-1,pageSize:Qt,pageCount:K,onPageChange:function(e){var t;(t=e+1)<1||t>K||o(t)},showGlobalSearch:!1,showFilters:!1,onRowClick:function(e){return t=e,T("update"),U(t),void _(!0);var t},wrapCellsAsBadges:!0,badgeClassName:H,badgeWrapperClassName:z,badgeEmptyPlaceholder:Gt}),S.jsx(P,{open:N,onClose:q,children:S.jsxs("div",{className:"space-y-4",children:[L?S.jsxs("article",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4 shadow-sm",children:[S.jsx("h3",{className:"text-base font-semibold",children:"Карточка транспорта"}),S.jsx("dl",{className:"mt-2 grid grid-cols-1 gap-2 text-sm sm:grid-cols-2",children:nr.map(function(e){var t=e.id,r=e.label,n=e.render;return S.jsxs("div",{children:[S.jsx("dt",{className:"font-medium text-slate-500",children:r}),S.jsx("dd",{className:"text-slate-900",children:n(L)})]},t)})})]}):null,S.jsx(zt,{open:N,mode:I,vehicle:L,saving:M,onSubmit:G,onDelete:"update"===I?X:void 0,onClose:q})]})})]})}var lr="rounded-lg border border-slate-200 bg-white p-4 shadow-sm dark:border-slate-700 dark:bg-slate-900",ir="space-y-4",sr=function(e){var t,r,n,a,l,i,s=e.item,o=e.value,c=e.onChange,u=e.onSave,d=e.onReset,m=e.onDelete,f=e.saving,v=e.deleting,h=e.error,p=w(R.useState(h),2),x=p[0],g=p[1];R.useEffect(function(){g(h)},[h]);var b=null!==(t=null===(r=s.meta)||void 0===r?void 0:r.defaultLabel)&&void 0!==t?t:s.name,y=(null===(n=s.value)||void 0===n?void 0:n.trim())||b,j=o.trim(),N=j!==y,_=function(){var e=k(E().m(function e(){var t,r;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:return g(void 0),e.p=1,e.n=2,u();case 2:e.n=4;break;case 3:e.p=3,r=e.v,t=r instanceof Error?r.message:String(r),g(t);case 4:return e.a(2)}},e,null,[[1,3]])}));return function(){return e.apply(this,arguments)}}(),C=function(){var e=k(E().m(function e(){var t,r;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:if(m){e.n=1;break}return e.a(2);case 1:return g(void 0),e.p=2,e.n=3,m();case 3:e.n=5;break;case 4:e.p=4,r=e.v,t=r instanceof Error?r.message:String(r),g(t);case 5:return e.a(2)}},e,null,[[2,4]])}));return function(){return e.apply(this,arguments)}}();return S.jsx("article",{className:lr,children:S.jsxs("div",{className:"flex flex-col gap-2",children:[S.jsx("div",{className:"flex flex-wrap items-center justify-between gap-2",children:S.jsxs("div",{children:[S.jsxs("h4",{className:"text-base font-semibold text-slate-900 dark:text-slate-100",children:[b,null!==(a=s.meta)&&void 0!==a&&a.required?" *":""]}),S.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Поле: ",S.jsx("span",{className:"font-mono",children:s.name}),null!==(l=s.meta)&&void 0!==l&&l.fieldType?" • Тип: ".concat(s.meta.fieldType):""]})]})}),S.jsxs("label",{className:"flex flex-col gap-1",children:[S.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Отображаемое название"}),S.jsx(Se,{value:o,onChange:function(e){return c(e.target.value)},placeholder:b,"aria-label":"Название поля ".concat(b)})]}),x?S.jsx("p",{className:"text-sm text-rose-600",role:"alert",children:x}):null,S.jsxs("div",{className:"flex flex-wrap gap-2",children:[S.jsx(V,{type:"button",size:"sm",onClick:_,disabled:f||v||!N||!j,children:f?S.jsx(oe,{}):"Сохранить"}),S.jsx(V,{type:"button",size:"sm",variant:"outline",onClick:function(){g(void 0),d()},disabled:f||v,children:"Сбросить"}),!m||null!==(i=s.meta)&&void 0!==i&&i.virtual?null:S.jsx(V,{type:"button",size:"sm",variant:"destructive",onClick:C,disabled:f||v,children:v?S.jsx(oe,{}):"Удалить"})]})]})})},or=function(e){var t,r,n,a,l,i,s,o,c,u,d=e.item,m=e.label,f=e.url,v=e.photosUrl,h=e.onChangeLabel,p=e.onChangeUrl,x=e.onChangePhotosUrl,g=e.onSave,b=e.onReset,y=e.onDelete,j=e.saving,N=e.deleting,_=e.error,C=w(R.useState(_),2),I=C[0],T=C[1];R.useEffect(function(){T(_)},[_]);var A=null!==(t=null===(r=d.meta)||void 0===r?void 0:r.defaultLabel)&&void 0!==t?t:d.name,W=(null===(n=d.value)||void 0===n?void 0:n.trim())||A,O="string"==typeof(null===(a=d.meta)||void 0===a?void 0:a.tg_theme_url)?d.meta.tg_theme_url:"",M="string"==typeof(null===(l=d.meta)||void 0===l?void 0:l.tg_photos_url)?d.meta.tg_photos_url:"",D=m.trim(),L=f.trim(),U=v.trim(),K=D!==W||L!==(O||"")||U!==(M||""),F=function(){var e=k(E().m(function e(){var t,r;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:return T(void 0),e.p=1,e.n=2,g();case 2:e.n=4;break;case 3:e.p=3,r=e.v,t=r instanceof Error?r.message:String(r),T(t);case 4:return e.a(2)}},e,null,[[1,3]])}));return function(){return e.apply(this,arguments)}}(),H=function(){var e=k(E().m(function e(){var t,r;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:if(y){e.n=1;break}return e.a(2);case 1:return T(void 0),e.p=2,e.n=3,y();case 3:e.n=5;break;case 4:e.p=4,r=e.v,t=r instanceof Error?r.message:String(r),T(t);case 5:return e.a(2)}},e,null,[[2,4]])}));return function(){return e.apply(this,arguments)}}();return S.jsx("article",{className:lr,children:S.jsxs("div",{className:"flex flex-col gap-2",children:[S.jsx("div",{className:"flex flex-wrap items-center justify-between gap-2",children:S.jsxs("div",{children:[S.jsx("h4",{className:"text-base font-semibold text-slate-900 dark:text-slate-100",children:A}),S.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Тип задачи: ",S.jsx("span",{className:"font-mono",children:d.name})]})]})}),S.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[S.jsxs("label",{className:"flex flex-col gap-1",children:[S.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Отображаемое название"}),S.jsx(Se,{value:m,onChange:function(e){return h(e.target.value)},placeholder:A,"aria-label":"Название типа ".concat(A)})]}),S.jsxs("label",{className:"flex flex-col gap-1",children:[S.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Ссылка на тему Telegram"}),S.jsx(Se,{value:f,onChange:function(e){return p(e.target.value)},placeholder:"https://t.me/c/...","aria-label":"Ссылка темы для типа ".concat(A)})]}),S.jsxs("label",{className:"flex flex-col gap-1",children:[S.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Тема для фото"}),S.jsx(Se,{value:v,onChange:function(e){return x(e.target.value)},placeholder:"https://t.me/c/...","aria-label":"Ссылка темы для фото ".concat(A)})]})]}),null!==(i=d.meta)&&void 0!==i&&i.tg_chat_id?S.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Чат: ",d.meta.tg_chat_id]}):null,null!==(s=d.meta)&&void 0!==s&&s.tg_topic_id?S.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Тема: ",d.meta.tg_topic_id]}):null,null!==(o=d.meta)&&void 0!==o&&o.tg_photos_chat_id?S.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Чат фото: ",d.meta.tg_photos_chat_id]}):null,null!==(c=d.meta)&&void 0!==c&&c.tg_photos_topic_id?S.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Тема фото: ",d.meta.tg_photos_topic_id]}):null,I?S.jsx("p",{className:"text-sm text-rose-600",role:"alert",children:I}):null,S.jsxs("div",{className:"flex flex-wrap gap-2",children:[S.jsx(V,{type:"button",size:"sm",onClick:F,disabled:j||N||!D||!K,children:j?S.jsx(oe,{}):"Сохранить"}),S.jsx(V,{type:"button",size:"sm",variant:"outline",onClick:function(){T(void 0),b()},disabled:j||N,children:"Сбросить"}),!y||null!==(u=d.meta)&&void 0!==u&&u.virtual?null:S.jsx(V,{type:"button",size:"sm",variant:"destructive",onClick:H,disabled:j||N,children:N?S.jsx(oe,{}):"Удалить"})]})]})})},cr=function(e){return _(e).sort(function(e,t){var r,n;return("number"==typeof(null===(r=e.meta)||void 0===r?void 0:r.order)?e.meta.order:0)-("number"==typeof(null===(n=t.meta)||void 0===n?void 0:n.order)?t.meta.order:0)})},ur=function(e,t){var r=w(R.useState({}),2),n=r[0],a=r[1];return R.useEffect(function(){a(function(r){var n=!1,a=W({},r),l=new Set(e.map(function(e){return e.name}));return e.forEach(function(e){var l=e.name;l in r||(a[l]=t(e),n=!0)}),Object.keys(r).forEach(function(e){l.has(e)||(delete a[e],n=!0)}),n?a:r})},[e,t]),[n,a]},dr=function(e){var t=e.fields,r=e.types,n=e.loading,a=e.onSaveField,l=e.onDeleteField,i=e.onSaveType,s=e.onDeleteType,o=R.useCallback(function(e){var t,r;return(null===(t=e.value)||void 0===t?void 0:t.trim())||(null===(r=e.meta)||void 0===r?void 0:r.defaultLabel)||e.name},[]),c=R.useCallback(function(e){var t,r,n,a;return{label:(null===(t=e.value)||void 0===t?void 0:t.trim())||(null===(r=e.meta)||void 0===r?void 0:r.defaultLabel)||e.name,url:"string"==typeof(null===(n=e.meta)||void 0===n?void 0:n.tg_theme_url)?e.meta.tg_theme_url:"",photosUrl:"string"==typeof(null===(a=e.meta)||void 0===a?void 0:a.tg_photos_url)?e.meta.tg_photos_url:""}},[]),u=w(ur(t,o),2),d=u[0],m=u[1],f=w(ur(r,c),2),v=f[0],h=f[1],p=w(R.useState(null),2),x=p[0],g=p[1],b=w(R.useState(null),2),y=b[0],j=b[1],N=w(R.useState(null),2),_=N[0],C=N[1],I=w(R.useState(null),2),T=I[0],A=I[1],M=w(R.useState({}),2),D=M[0],L=M[1],U=w(R.useState({}),2),K=U[0],F=U[1],H=R.useMemo(function(){return cr(t)},[t]),V=R.useMemo(function(){return cr(r)},[r]),P=function(e,t){h(function(r){var n,a,l,i,s,o;return W(W({},r),{},O({},e,W({label:null!==(n=null===(a=r[e])||void 0===a?void 0:a.label)&&void 0!==n?n:"",url:null!==(l=null===(i=r[e])||void 0===i?void 0:i.url)&&void 0!==l?l:"",photosUrl:null!==(s=null===(o=r[e])||void 0===o?void 0:o.photosUrl)&&void 0!==s?s:""},t)))}),F(function(t){return W(W({},t),{},O({},e,""))})},B=function(){var e=k(E().m(function e(t){var r,n,l,i;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=null!==(r=d[t.name])&&void 0!==r?r:"",g(t.name),L(function(e){return W(W({},e),{},O({},t.name,""))}),e.p=1,e.n=2,a(t,n);case 2:m(function(e){return W(W({},e),{},O({},t.name,n))}),e.n=4;break;case 3:throw e.p=3,i=e.v,l=i instanceof Error?i.message:String(i),L(function(e){return W(W({},e),{},O({},t.name,l))}),i;case 4:return e.p=4,g(function(e){return e===t.name?null:e}),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=k(E().m(function e(t){var r,n,a;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:if(null===(r=t.meta)||void 0===r||!r.virtual){e.n=1;break}return e.a(2);case 1:return C(t.name),L(function(e){return W(W({},e),{},O({},t.name,""))}),e.p=2,e.n=3,l(t);case 3:e.n=5;break;case 4:throw e.p=4,a=e.v,n=a instanceof Error?a.message:String(a),L(function(e){return W(W({},e),{},O({},t.name,n))}),a;case 5:return e.p=5,C(function(e){return e===t.name?null:e}),e.f(5);case 6:return e.a(2)}},e,null,[[2,4,5,6]])}));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=k(E().m(function e(t){var r,n,a,l;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=null!==(r=v[t.name])&&void 0!==r?r:{label:"",url:"",photosUrl:""},j(t.name),F(function(e){return W(W({},e),{},O({},t.name,""))}),e.p=1,e.n=2,i(t,{label:n.label,tg_theme_url:n.url,tg_photos_url:n.photosUrl});case 2:h(function(e){return W(W({},e),{},O({},t.name,{label:n.label,url:n.url,photosUrl:n.photosUrl}))}),e.n=4;break;case 3:throw e.p=3,l=e.v,a=l instanceof Error?l.message:String(l),F(function(e){return W(W({},e),{},O({},t.name,a))}),l;case 4:return e.p=4,j(function(e){return e===t.name?null:e}),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=k(E().m(function e(t){var r,n,a;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:if(null===(r=t.meta)||void 0===r||!r.virtual){e.n=1;break}return e.a(2);case 1:return A(t.name),F(function(e){return W(W({},e),{},O({},t.name,""))}),e.p=2,e.n=3,s(t);case 3:e.n=5;break;case 4:throw e.p=4,a=e.v,n=a instanceof Error?a.message:String(a),F(function(e){return W(W({},e),{},O({},t.name,n))}),a;case 5:return e.p=5,A(function(e){return e===t.name?null:e}),e.f(5);case 6:return e.a(2)}},e,null,[[2,4,5,6]])}));return function(t){return e.apply(this,arguments)}}();return S.jsxs("div",{className:"space-y-6",children:[S.jsxs("section",{className:ir,children:[S.jsxs("header",{className:"space-y-1",children:[S.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Поля задачи"}),S.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Настройте названия полей, которые видят пользователи в карточке задачи."})]}),n&&!H.length?S.jsx("div",{className:"flex items-center justify-center py-6",children:S.jsx(oe,{})}):S.jsx("div",{className:"grid gap-4 lg:grid-cols-2",children:H.map(function(e){var t,r;return S.jsx(sr,{item:e,value:null!==(t=d[e.name])&&void 0!==t?t:"",onChange:function(t){return function(e,t){m(function(r){return W(W({},r),{},O({},e,t))}),L(function(t){return W(W({},t),{},O({},e,""))})}(e.name,t)},onSave:function(){return B(e)},onReset:function(){return function(e){m(function(t){return W(W({},t),{},O({},e.name,o(e)))}),L(function(t){return W(W({},t),{},O({},e.name,""))})}(e)},onDelete:null!==(r=e.meta)&&void 0!==r&&r.virtual?void 0:function(){return z(e)},saving:x===e.name,deleting:_===e.name,error:D[e.name]},e._id)})})]}),S.jsxs("section",{className:ir,children:[S.jsxs("header",{className:"space-y-1",children:[S.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Типы задач и темы Telegram"}),S.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Для каждого типа задачи можно задать отображаемое название, основную тему чата Telegram и отдельную тему для альбома фото."})]}),n&&!V.length?S.jsx("div",{className:"flex items-center justify-center py-6",children:S.jsx(oe,{})}):S.jsx("div",{className:"grid gap-4 lg:grid-cols-2",children:V.map(function(e){var t,r,n,a,l,i,s;return S.jsx(or,{item:e,label:null!==(t=null===(r=v[e.name])||void 0===r?void 0:r.label)&&void 0!==t?t:"",url:null!==(n=null===(a=v[e.name])||void 0===a?void 0:a.url)&&void 0!==n?n:"",photosUrl:null!==(l=null===(i=v[e.name])||void 0===i?void 0:i.photosUrl)&&void 0!==l?l:"",onChangeLabel:function(t){return P(e.name,{label:t})},onChangeUrl:function(t){return P(e.name,{url:t})},onChangePhotosUrl:function(t){return P(e.name,{photosUrl:t})},onSave:function(){return Z(e)},onReset:function(){return function(e){h(function(t){return W(W({},t),{},O({},e.name,c(e)))}),F(function(t){return W(W({},t),{},O({},e.name,""))})}(e)},onDelete:null!==(s=e.meta)&&void 0!==s&&s.virtual?void 0:function(){return q(e)},saving:y===e.name,deleting:T===e.name,error:K[e.name]},e._id)})})]})]})};function mr(){return fr.apply(this,arguments)}function fr(){return fr=k(E().m(function e(){var t,r,n,a,l=arguments;return E().w(function(e){for(;;)switch(e.n){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},r=new URLSearchParams,t.from&&r.set("from",t.from),t.to&&r.set("to",t.to),t.status&&r.set("status",t.status),n=r.toString(),e.n=1,z("/api/v1/analytics/route-plans/summary".concat(n?"?".concat(n):""));case 1:if((a=e.v).ok){e.n=2;break}throw new Error("Не удалось получить аналитику маршрутных планов");case 2:return e.n=3,a.json();case 3:return e.a(2,e.v)}},e)})),fr.apply(this,arguments)}var vr=R.lazy(function(){return T(function(){return C.import("./react-apexcharts.min-legacy-DAUu-INF.js").then(function(e){return e.r})},void 0)}),hr=function(e){return new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().slice(0,10)},pr=hr(new Date),xr=hr(new Date(Date.now()-25056e5)),gr=[{value:"all",label:"Все статусы"},{value:"draft",label:"Черновики"},{value:"approved",label:"Утверждённые"},{value:"completed",label:"Завершённые"}],br=new Intl.NumberFormat("ru-RU",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:1}),yr=new Intl.NumberFormat("ru-RU",{minimumFractionDigits:0,maximumFractionDigits:1}),jr=new Intl.NumberFormat("ru-RU",{minimumFractionDigits:0,maximumFractionDigits:2}),Nr=function(e){var t={};return e.from&&(t.from=e.from),e.to&&(t.to=e.to),"all"!==e.status&&(t.status=e.status),t},kr=function(e){var t;return null!==(t=null==e?void 0:e.mileage.byPeriod.map(function(e){return{x:e.date,y:"number"==typeof e.value?e.value:0}}))&&void 0!==t?t:[]},wr=function(e){var t;return null!==(t=null==e?void 0:e.load.byPeriod.map(function(e){return{x:e.date,y:"number"==typeof e.value?e.value:null}}))&&void 0!==t?t:[]},_r=function(e){var t;return null!==(t=null==e?void 0:e.sla.byPeriod.map(function(e){return{x:e.date,y:"number"==typeof e.rate?Number((100*e.rate).toFixed(2)):null}}))&&void 0!==t?t:[]};function Cr(){var e,t,r,n=Z().t,a=w(R.useState({from:xr,to:pr,status:"completed"}),2),l=a[0],i=a[1],s=w(R.useState(!1),2),o=s[0],c=s[1],u=w(R.useState(null),2),d=u[0],m=u[1],f=w(R.useState(null),2),v=f[0],h=f[1],p=R.useCallback(function(){var e=k(E().m(function e(t){var r,a;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:return c(!0),m(null),e.p=1,e.n=2,mr(Nr(t));case 2:r=e.v,h(r),e.n=4;break;case 3:e.p=3,a=e.v,console.error("Не удалось загрузить аналитику маршрутных планов",a),m(n("analytics.loadError"));case 4:return e.p=4,c(!1),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(t){return e.apply(this,arguments)}}(),[n]);R.useEffect(function(){p(l)},[l,p]);var x=R.useMemo(function(){return kr(v)},[v]),g=R.useMemo(function(){return wr(v)},[v]),b=R.useMemo(function(){return _r(v)},[v]);return S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{className:"space-y-3",children:[S.jsx("h1",{className:"text-2xl font-semibold",children:n("analytics.title")}),S.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:n("analytics.description")})]}),S.jsxs("form",{onSubmit:function(e){e.preventDefault();var t=new FormData(e.currentTarget),r={from:String(t.get("from")||""),to:String(t.get("to")||""),status:t.get("status")||"all"};i(r)},className:"flex flex-wrap items-end gap-3 rounded-lg bg-white p-4 shadow-sm dark:bg-slate-900",children:[S.jsxs("label",{className:"flex flex-col text-sm text-slate-700 dark:text-slate-200",children:[n("analytics.filters.from"),S.jsx(Se,{type:"date",name:"from",defaultValue:l.from})]}),S.jsxs("label",{className:"flex flex-col text-sm text-slate-700 dark:text-slate-200",children:[n("analytics.filters.to"),S.jsx(Se,{type:"date",name:"to",defaultValue:l.to})]}),S.jsxs("label",{className:"flex flex-col text-sm text-slate-700 dark:text-slate-200",children:[n("analytics.filters.status"),S.jsx("select",{name:"status",defaultValue:l.status,className:"mt-1 w-48 rounded-md border border-slate-300 bg-white px-3 py-2 text-sm focus:border-slate-400 focus:outline-none focus:ring-2 focus:ring-primary/60 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-100",children:gr.map(function(e){return S.jsx("option",{value:e.value,children:n("analytics.status.".concat(e.value))},e.value)})})]}),S.jsxs("div",{className:"flex flex-wrap gap-2",children:[S.jsx(V,{type:"submit",disabled:o,children:n(o?"analytics.loading":"analytics.apply")}),S.jsx(V,{type:"button",variant:"outline",onClick:function(){i({from:xr,to:pr,status:"completed"})},children:n("analytics.reset")})]})]}),d?S.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4 text-sm text-red-600 dark:border-red-800 dark:bg-red-900/30 dark:text-red-200",children:d}):null,S.jsxs("section",{className:"grid gap-4 md:grid-cols-3",children:[S.jsxs("article",{className:"rounded-lg bg-white p-4 shadow-sm dark:bg-slate-900",children:[S.jsx("h2",{className:"text-sm font-medium text-slate-500 dark:text-slate-300",children:n("analytics.cards.mileage")}),S.jsxs("p",{className:"mt-2 text-2xl font-semibold",children:[yr.format(null!==(e=null==v?void 0:v.mileage.total)&&void 0!==e?e:0)," км"]}),S.jsx("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:n("analytics.cards.period",{from:null!==(t=null==v?void 0:v.period.from)&&void 0!==t?t:l.from,to:null!==(r=null==v?void 0:v.period.to)&&void 0!==r?r:l.to})})]}),S.jsxs("article",{className:"rounded-lg bg-white p-4 shadow-sm dark:bg-slate-900",children:[S.jsx("h2",{className:"text-sm font-medium text-slate-500 dark:text-slate-300",children:n("analytics.cards.load")}),S.jsx("p",{className:"mt-2 text-2xl font-semibold",children:"number"==typeof(null==v?void 0:v.load.average)?"".concat(jr.format(v.load.average)," кг"):n("analytics.noData")}),S.jsx("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:n("analytics.cards.loadHint")})]}),S.jsxs("article",{className:"rounded-lg bg-white p-4 shadow-sm dark:bg-slate-900",children:[S.jsx("h2",{className:"text-sm font-medium text-slate-500 dark:text-slate-300",children:"SLA"}),S.jsx("p",{className:"mt-2 text-2xl font-semibold",children:"number"==typeof(null==v?void 0:v.sla.average)?br.format(v.sla.average):n("analytics.noData")}),S.jsx("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:n("analytics.cards.slaHint")})]})]}),S.jsxs("section",{className:"grid gap-4 lg:grid-cols-3",children:[S.jsxs("div",{className:"space-y-2 rounded-lg bg-white p-4 shadow-sm dark:bg-slate-900 lg:col-span-3",children:[S.jsx("h3",{className:"text-base font-semibold text-slate-700 dark:text-slate-200",children:n("analytics.charts.mileage")}),S.jsx(R.Suspense,{fallback:S.jsx("div",{children:n("analytics.loading")}),children:S.jsx(vr,{type:"area",height:280,series:[{name:n("analytics.cards.mileage"),data:x}],options:{chart:{id:"analytics-mileage",animations:{enabled:!1}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},xaxis:{type:"category"},yaxis:{labels:{formatter:function(e){return yr.format(e)}}},tooltip:{y:{formatter:function(e){return"".concat(yr.format(e)," км")}}}}})})]}),S.jsxs("div",{className:"space-y-2 rounded-lg bg-white p-4 shadow-sm dark:bg-slate-900",children:[S.jsx("h3",{className:"text-base font-semibold text-slate-700 dark:text-slate-200",children:n("analytics.charts.load")}),S.jsx(R.Suspense,{fallback:S.jsx("div",{children:n("analytics.loading")}),children:S.jsx(vr,{type:"bar",height:280,series:[{name:n("analytics.cards.load"),data:g}],options:{chart:{id:"analytics-load",animations:{enabled:!1}},dataLabels:{enabled:!1},xaxis:{type:"category"},yaxis:{labels:{formatter:function(e){return"".concat(jr.format(e)," кг")}}},tooltip:{y:{formatter:function(e){return"".concat(jr.format(e)," кг")}}}}})})]}),S.jsxs("div",{className:"space-y-2 rounded-lg bg-white p-4 shadow-sm dark:bg-slate-900",children:[S.jsx("h3",{className:"text-base font-semibold text-slate-700 dark:text-slate-200",children:n("analytics.charts.sla")}),S.jsx(R.Suspense,{fallback:S.jsx("div",{children:n("analytics.loading")}),children:S.jsx(vr,{type:"line",height:280,series:[{name:"SLA",data:b}],options:{chart:{id:"analytics-sla",animations:{enabled:!1}},dataLabels:{enabled:!1},stroke:{curve:"straight",width:2},markers:{size:4},xaxis:{type:"category"},yaxis:{min:0,max:100,tickAmount:5,labels:{formatter:function(e){return br.format(e/100)}}},tooltip:{y:{formatter:function(e){return br.format(e/100)}}}}})})]})]})]})}var Sr=[{accessorKey:"name",header:"Название",meta:{minWidth:"8rem",maxWidth:"16rem"}},{accessorKey:"value",header:"Значение",meta:{minWidth:"8rem",maxWidth:"20rem"}},{accessorKey:"displayValue",header:"Связанные данные",meta:{minWidth:"10rem",maxWidth:"24rem"}},{accessorKey:"type",header:"Тип",meta:{minWidth:"6rem",maxWidth:"12rem"}},{accessorKey:"_id",header:"Идентификатор",meta:{minWidth:"10rem",maxWidth:"16rem"}},{accessorKey:"metaSummary",header:"Доп. сведения",meta:{minWidth:"10rem",maxWidth:"24rem"}}],Ir=[{accessorKey:"telegram_id",header:"Telegram ID",meta:{minWidth:"8rem"}},{accessorKey:"username",header:"Логин",cell:function(e){var t,r,n=e.row;return null!==(t=null!==(r=n.original.telegram_username)&&void 0!==r?r:n.original.username)&&void 0!==t?t:""},meta:{minWidth:"8rem",maxWidth:"16rem"}},{accessorKey:"name",header:"Имя",meta:{minWidth:"8rem",maxWidth:"16rem"}},{accessorKey:"phone",header:"Телефон",meta:{minWidth:"8rem",maxWidth:"16rem"}},{accessorKey:"mobNumber",header:"Моб. номер",meta:{minWidth:"8rem",maxWidth:"16rem"}},{accessorKey:"email",header:"E-mail",meta:{minWidth:"10rem",maxWidth:"20rem"}},{accessorKey:"role",header:"Роль",cell:function(e){var t=e.getValue;return be(t())},meta:{minWidth:"6rem",maxWidth:"12rem"}},{accessorKey:"access",header:"Доступ",cell:function(e){var t,r=e.getValue;return String(null!==(t=r())&&void 0!==t?t:"")},meta:{minWidth:"6rem",maxWidth:"10rem"}},{accessorKey:"roleId",header:"Роль ID",meta:{minWidth:"8rem",maxWidth:"16rem"}},{accessorKey:"departmentId",header:"Департамент",meta:{minWidth:"8rem",maxWidth:"16rem"}},{accessorKey:"divisionId",header:"Отдел",meta:{minWidth:"8rem",maxWidth:"16rem"}},{accessorKey:"positionId",header:"Должность",meta:{minWidth:"8rem",maxWidth:"16rem"}}],Er=[{accessorKey:"telegram_id",header:"Telegram ID",meta:{minWidth:"8rem"}},{accessorKey:"username",header:"Логин",cell:function(e){var t,r,n=e.row;return null!==(t=null!==(r=n.original.telegram_username)&&void 0!==r?r:n.original.username)&&void 0!==t?t:""},meta:{minWidth:"8rem",maxWidth:"16rem"}},{accessorKey:"name",header:"Имя",meta:{minWidth:"8rem",maxWidth:"16rem"}},{accessorKey:"phone",header:"Телефон",meta:{minWidth:"8rem",maxWidth:"16rem"}},{accessorKey:"mobNumber",header:"Моб. номер",meta:{minWidth:"8rem",maxWidth:"16rem"}},{accessorKey:"email",header:"E-mail",meta:{minWidth:"10rem",maxWidth:"20rem"}},{accessorKey:"role",header:"Роль",cell:function(e){var t=e.getValue;return be(t())},meta:{minWidth:"6rem",maxWidth:"12rem"}},{accessorKey:"access",header:"Доступ",cell:function(e){var t,r=e.getValue;return null==(t=r())?"":String(t)},meta:{minWidth:"6rem",maxWidth:"10rem"}},{accessorKey:"roleId",header:"Роль ID",cell:function(e){var t=e.row;return be(t.original.roleName)},meta:{minWidth:"8rem",maxWidth:"16rem"}},{accessorKey:"departmentId",header:"Департамент",cell:function(e){return e.row.original.departmentName||"—"},meta:{minWidth:"8rem",maxWidth:"16rem"}},{accessorKey:"divisionId",header:"Отдел",cell:function(e){return e.row.original.divisionName||"—"},meta:{minWidth:"8rem",maxWidth:"16rem"}},{accessorKey:"positionId",header:"Должность",cell:function(e){return e.row.original.positionName||"—"},meta:{minWidth:"8rem",maxWidth:"16rem"}}],Tr=function(e){if("string"==typeof e){var t=e.trim();return t.length?t:void 0}},Ar=function(e){var t,r,n,a,l={roleName:null!==(t=Tr(e.roleName))&&void 0!==t?t:"",departmentName:null!==(r=Tr(e.departmentName))&&void 0!==r?r:"",divisionName:null!==(n=Tr(e.divisionName))&&void 0!==n?n:"",positionName:null!==(a=Tr(e.positionName))&&void 0!==a?a:""},i=function(e,t){var r=Tr(t);void 0!==r&&(l[e]=r)},s=function(e,t){var r,n="number"==typeof(r=t)&&Number.isFinite(r)?r:void 0;void 0!==n&&(l[e]=n)};i("id",e.id),s("telegram_id",e.telegram_id),i("telegram_username",e.telegram_username),i("username",e.username),i("name",e.name),i("phone",e.phone),i("mobNumber",e.mobNumber),i("email",e.email),i("role",e.role),s("access",e.access);var o=function(e){if(Array.isArray(e))return e.filter(function(e){return"string"==typeof e}).map(function(e){return e.trim()}).filter(function(e){return e.length>0})}(e.permissions);return void 0!==o&&(l.permissions=o),i("roleId",e.roleId),i("roleName",l.roleName),i("departmentId",e.departmentId),i("departmentName",l.departmentName),i("divisionId",e.divisionId),i("divisionName",l.divisionName),i("positionId",e.positionId),i("positionName",l.positionName),l};function Wr(e){var t,r=e.form,n=e.onChange,a=e.onSubmit,l=e.onReset,i=w(R.useState(!1),2),s=i[0],o=i[1],c=w(R.useState([]),2),u=c[0],d=c[1],m=w(R.useState([]),2),f=m[0],v=m[1],h=w(R.useState([]),2),p=h[0],x=h[1],g=w(R.useState([]),2),b=g[0],y=g[1];R.useEffect(function(){fe("departments","",1,100).then(function(e){return d(e.items)}).catch(function(){return d([])}),fe("divisions","",1,100).then(function(e){return v(e.items)}).catch(function(){return v([])}),fe("positions","",1,100).then(function(e){return x(e.items)}).catch(function(){return x([])}),ye().then(function(e){return y(e)})},[]);return S.jsxs("form",{onSubmit:function(e){e.preventDefault(),o(!0)},className:"space-y-2",children:[S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium",children:"ID"}),S.jsx("input",{id:"settings-user-telegram-id",name:"telegramId",className:"h-10 w-full rounded border px-3",value:null!==(t=r.telegram_id)&&void 0!==t?t:"",onChange:function(e){return n(W(W({},r),{},{telegram_id:e.target.value?Number(e.target.value):void 0}))},readOnly:!!r.telegram_id,required:!0})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium",children:"Username"}),S.jsx("input",{id:"settings-user-username",name:"username",className:"h-10 w-full rounded border px-3",value:r.username||"",onChange:function(e){return n(W(W({},r),{},{username:e.target.value}))},readOnly:!!r.telegram_id})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium",children:"Имя"}),S.jsx("input",{id:"settings-user-name",name:"name",className:"h-10 w-full rounded border px-3",value:r.name||"",onChange:function(e){return n(W(W({},r),{},{name:e.target.value}))}})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium",children:"Телефон"}),S.jsx("input",{id:"settings-user-phone",name:"phone",className:"h-10 w-full rounded border px-3",value:r.phone||"",onChange:function(e){return n(W(W({},r),{},{phone:e.target.value}))}})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium",children:"Доп. телефон"}),S.jsx("input",{id:"settings-user-mob",name:"mobNumber",className:"h-10 w-full rounded border px-3",value:r.mobNumber||"",onChange:function(e){return n(W(W({},r),{},{mobNumber:e.target.value}))}})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium",children:"Email"}),S.jsx("input",{id:"settings-user-email",name:"email",className:"h-10 w-full rounded border px-3",value:r.email||"",onChange:function(e){return n(W(W({},r),{},{email:e.target.value}))}})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium",children:"Роль"}),S.jsx("select",{className:"h-10 w-full rounded border px-3",value:r.role||"user",onChange:function(e){return t=e.target.value,l=b.find(function(e){return e.name===t}),void n(W(W({},r),{},{role:t,roleId:null==l?void 0:l._id,access:null!==(a=null==l?void 0:l.access)&&void 0!==a?a:1}));var t,a,l},children:je.map(function(e){return S.jsx("option",{value:e.value,children:e.label},e.value)})})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium",children:"Департамент"}),S.jsxs("select",{className:"h-10 w-full rounded border px-3",value:r.departmentId||"",onChange:function(e){return n(W(W({},r),{},{departmentId:e.target.value}))},children:[S.jsx("option",{value:""}),u.map(function(e){return S.jsx("option",{value:e._id,children:e.name},e._id)})]})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium",children:"Отдел"}),S.jsxs("select",{className:"h-10 w-full rounded border px-3",value:r.divisionId||"",onChange:function(e){return n(W(W({},r),{},{divisionId:e.target.value}))},children:[S.jsx("option",{value:""}),f.map(function(e){return S.jsx("option",{value:e._id,children:e.name},e._id)})]})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium",children:"Должность"}),S.jsxs("select",{className:"h-10 w-full rounded border px-3",value:r.positionId||"",onChange:function(e){return n(W(W({},r),{},{positionId:e.target.value}))},children:[S.jsx("option",{value:""}),p.map(function(e){return S.jsx("option",{value:e._id,children:e.name},e._id)})]})]}),S.jsxs("div",{className:"flex gap-2",children:[S.jsx(V,{type:"submit",children:"Сохранить"}),S.jsx(V,{type:"button",variant:"outline",onClick:l,children:"Очистить"})]}),S.jsx(ge,{open:s,message:"Сохранить изменения?",onConfirm:function(){o(!1),a()},onCancel:function(){return o(!1)},confirmText:"Сохранить"})]})}var Or=[{key:"directories",label:"Справочники",description:"Структура компании и доступы",icon:Re},{key:"reports",label:"Отчёты",description:"Аналитика процессов и KPI",icon:ce},{key:"archive",label:"Архив",description:"История задач и записей",icon:Ue},{key:"logs",label:"Логи",description:"Журнал действий и событий",icon:G},{key:"storage",label:"Файлы",description:"Управление вложениями",icon:Ye}],Mr=function(e){return Or.some(function(t){return t.key===e})},Dr=[{key:"departments",label:"Департамент",description:"Структура компании и направления"},{key:"divisions",label:"Отдел",description:"Команды внутри департаментов"},{key:"positions",label:"Должность",description:"Роли и рабочие позиции"},{key:"employees",label:"Сотрудник",description:"Карточки и доступы сотрудников"},{key:"fleets",label:"Автопарк",description:"Транспорт и связанный состав"},{key:"users",label:"Пользователь",description:"Учётные записи в системе"},{key:"tasks",label:"Задачи",description:"Поля формы и темы публикаций"}],Rr=function(){return Dr.reduce(function(e,t){return e[t.key]="",e},{})},Lr={telegram_id:void 0,username:"",name:"",phone:"",mobNumber:"",email:"",role:"user",access:1,roleId:"",departmentId:"",divisionId:"",positionId:""},Ur={departments:Fe,divisions:Qe,positions:Ze,employees:nt,fleets:et,users:Ge,tasks:me},Kr=function(e){return e.length?S.jsx("div",{className:Jt,children:e.map(function(e,t){return S.jsx("span",{className:Yt,title:e,children:e},"".concat(e,"-").concat(t))})}):S.jsx("span",{className:Yt,title:Gt,children:Gt})},Fr=function(e){if("string"==typeof e)return[e];if(Array.isArray(e))return e.flatMap(Fr);if(e&&"object"===I(e)){var t=[];return Object.entries(e).forEach(function(e){var r=w(e,2),n=r[0],a=r[1];if(Array.isArray(a)||a&&"object"===I(a))t.push.apply(t,_(Fr(a)));else if("string"!=typeof a)"boolean"!=typeof a&&"number"!=typeof a||a&&t.push(n);else{var l=a.trim();if(!l)return;!n.toLowerCase().includes("id")&&/\s/.test(l)||t.push(l)}}),t}return[]},Hr={telegram_id:"Telegram ID",telegram_username:"Логин Telegram",username:"Логин",name:"Имя",phone:"Телефон",mobNumber:"Моб. номер",email:"E-mail",role:"Роль",access:"Доступ",roleId:"Роль ID",departmentId:"Департамент",departmentName:"Департамент",divisionId:"Отдел",divisionName:"Отдел",positionId:"Должность",positionName:"Должность",permissions:"Права",fleetId:"Автопарк",source:"Источник",sourceId:"ID источника",readonly:"Только чтение",readonlyReason:"Причина ограничения",invalid:"Некорректен",invalidReason:"Причина ошибки",invalidCode:"Код ошибки",invalidAt:"Ошибка от",syncPending:"Ожидает синхронизации",syncWarning:"Предупреждение",syncError:"Ошибка синхронизации",syncFailedAt:"Сбой синхронизации",defaultLabel:"Название по умолчанию",fieldType:"Тип поля",required:"Обязательное",order:"Порядок",virtual:"Системный элемент",tg_theme_url:"Тема Telegram",tg_chat_id:"ID чата",tg_topic_id:"ID темы",tg_photos_url:"Тема для фото",tg_photos_chat_id:"ID чата фото",tg_photos_topic_id:"ID темы фото"},Vr=function(e){var t=Hr[e];if(t)return t;var r=e.replace(/[_-]+/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").trim();return r?r.charAt(0).toUpperCase()+r.slice(1):e},Pr=function(e){if(null==e)return"";if("boolean"==typeof e)return e?"Да":"Нет";if("number"==typeof e)return Number.isFinite(e)?String(e):"";if("string"==typeof e)return e.trim();if(Array.isArray(e))return e.map(function(e){return Pr(e)}).filter(Boolean).join(", ");if(e instanceof Date)return e.toISOString();if("object"===I(e)){var t=Object.entries(e).map(function(e){var t=w(e,2),r=t[0],n=t[1],a=Pr(n);return a?"".concat(Vr(r),"=").concat(a):""}).filter(Boolean);return t.join("; ")}return""},Br=function(e){return e?Object.entries(e).map(function(e){var t=w(e,2),r=t[0],n=t[1],a=Pr(n);return a?"".concat(Vr(r),": ").concat(a):""}).filter(Boolean).join("\n"):""},zr=function(e){var t=e.trim();if(!t)return"";var r=t.startsWith("{")||t.startsWith("[")?function(e){try{return JSON.parse(e)}catch(t){return}}(t):void 0;if(Array.isArray(r)){var n=r.map(function(e){return Pr(e)}).filter(Boolean);if(n.length)return n.join("\n")}else if(r&&"object"===I(r)){var a=Br(r);if(a)return a}if(t.includes(",")){var l=t.split(",").map(function(e){return e.trim()}).filter(Boolean);if(l.length>1)return l.join("\n")}return t},Zr=U(function(e){if(null==e)return[];if("string"==typeof e){var t=e.trim();if(!t)return[];if(t.startsWith("{")||t.startsWith("["))try{var r=JSON.parse(t);return Fr(r)}catch(n){}return t.split(",").map(function(e){return e.trim()}).filter(Boolean)}return Array.isArray(e)||e&&"object"===I(e)?Fr(e):[String(e)]},K(F())).transform(function(e){var t=e.map(function(e){return function(e){var t=e.trim();return t?t.replace(/^['"]+|['"]+$/g,"").replace(/^\[+|\]+$/g,"").replace(/^[{}]+|[{}]+$/g,"").replace(/,+$/g,"").trim():""}(String(e))}).filter(function(e){return e.length>0});return Array.from(new Set(t))}),qr=function(e){var t=Zr.safeParse(e);return t.success?t.data:[]},Gr=function(e,t){if(!t.length)return e;var r=e.slice(),n=new Map;r.forEach(function(e,t){n.set(e._id,t)});var a=!1;return t.forEach(function(e){var t=n.get(e._id);"number"!=typeof t?(n.set(e._id,r.length),r.push(e),a=!0):r[t]!==e&&(r[t]=e,a=!0)}),a?r:e},Xr=function(e,t,r){var n,a="string"==typeof r&&r.trim().length?r.trim():"";if(a)return a;if("string"!=typeof t)return"";var l=t.trim();return l?null!==(n=e.get(l))&&void 0!==n?n:l:""},Yr=function(e,t){var r,n=j(t);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a in e)return e[a]}}catch(c){n.e(c)}finally{n.f()}var l={};Object.entries(e).forEach(function(e){var t=w(e,2),r=t[0],n=t[1];l[r.toLowerCase()]=n});var i,s=j(t);try{for(s.s();!(i=s.n()).done;){var o=i.value.toLowerCase();if(o in l)return l[o]}}catch(c){s.e(c)}finally{s.f()}},Jr=function(e,t,r){var n=Yr(e,t);if("string"==typeof n){var a=n.trim();if(a.length)return a}if("number"==typeof n&&Number.isFinite(n))return String(n);if("string"==typeof r){var l=r.trim();if(l.length)return l}},Qr=function(e,t){var r=Yr(e,t);if("number"==typeof r&&Number.isFinite(r))return r;if("string"==typeof r){var n=r.trim();if(!n)return;var a=Number(n);if(Number.isFinite(a))return a}},$r=function(e){if("employees"===e.type){var t=[];e.meta&&"object"===I(e.meta)&&t.push(e.meta);var r=e.value;if("string"==typeof r){var n=r.trim();if(n)try{var a=JSON.parse(n);a&&"object"===I(a)&&!Array.isArray(a)&&t.push(a)}catch(O){}}else r&&"object"===I(r)&&!Array.isArray(r)&&t.push(r);if(!t.length){var l,i=null===(l=e.name)||void 0===l?void 0:l.trim();return i?{name:i}:void 0}var s=t.reduce(function(e,t){return W(W({},e),t)},{}),o={},c=Qr(s,["telegram_id","telegramId","id"]);"number"==typeof c&&(o.telegram_id=c);var u=Jr(s,["telegram_username","telegramUsername","telegram_login","telegramLogin"]);u&&(o.telegram_username=u);var d=Jr(s,["username","login"]);d&&(o.username=d);var m=Jr(s,["name","fullName"],e.name),f=Jr(s,["firstName","first_name"]),v=Jr(s,["lastName","last_name","surname","familyName"]),h=Jr(s,["middleName","middle_name","patronymic"]);if(m)o.name=m;else{var p=[v,f,h].filter(function(e){return"string"==typeof e&&e.trim().length>0});p.length&&(o.name=p.join(" "))}var x=Jr(s,["phone","phone_number","phoneNumber"]);x&&(o.phone=x);var g=Jr(s,["mobNumber","mobile","mobile_phone","mobilePhone"]);g&&(o.mobNumber=g);var b=Jr(s,["email","mail"]);b&&(o.email=b);var y=Jr(s,["role","roleName"]);y&&(o.role=y);var j=Qr(s,["access","access_level","accessLevel"]);"number"==typeof j&&(o.access=j);var N=Jr(s,["roleId","role_id"]);N&&(o.roleId=N);var k=Jr(s,["roleName"]);k&&(o.roleName=k);var w=Jr(s,["departmentId","department_id"]);w&&(o.departmentId=w);var _=Jr(s,["departmentName"]);_&&(o.departmentName=_);var C=Jr(s,["divisionId","division_id"]);C&&(o.divisionId=C);var S=Jr(s,["divisionName"]);S&&(o.divisionName=S);var E=Jr(s,["positionId","position_id"]);E&&(o.positionId=E);var T=Jr(s,["positionName"]);T&&(o.positionName=T);var A=function(e,t){var r=Yr(e,t);if(Array.isArray(r)){var n=r.filter(function(e){return"string"==typeof e}).map(function(e){return e.trim()}).filter(function(e){return e.length>0});return n.length?n:void 0}}(s,["permissions"]);return A&&(o.permissions=A),Object.keys(o).length?o:void 0}},en=function(e){var t={byId:new Map,byTelegramUsername:new Map,byUsername:new Map};return e.forEach(function(e){var r=$r(e);r&&("number"==typeof r.telegram_id&&t.byId.set(String(r.telegram_id),r),"string"==typeof r.telegram_username&&t.byTelegramUsername.set(r.telegram_username.toLowerCase(),r),"string"==typeof r.username&&t.byUsername.set(r.username.toLowerCase(),r))}),t},tn=function(e,t){if(!t)return e;var r=W({},e),n=function(e){var n=t[e];if("number"==typeof n&&Number.isFinite(n)){var a=r[e];"number"==typeof a&&Number.isFinite(a)||(r[e]=n)}},a=function(e){var n=t[e];if(null!=n){var a="string"==typeof n?n.trim():"number"==typeof n&&Number.isFinite(n)?String(n):"";if(a){var l=r[e];(null==l||"string"==typeof l&&!l.trim())&&(r[e]=a)}}};return n("telegram_id"),a("telegram_username"),a("username"),a("name"),a("phone"),a("mobNumber"),a("email"),a("role"),n("access"),a("roleId"),a("roleName"),a("departmentId"),a("departmentName"),a("divisionId"),a("divisionName"),a("positionId"),a("positionName"),r.permissions&&r.permissions.length||!Array.isArray(t.permissions)||!t.permissions.length||(r.permissions=t.permissions.slice()),r},rn=/[\t-\r ,-\/:;\\_\|\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+/,nn=function(e){var t,r,n,a,l,i,s,o,c,u,d,m,f=new Set,v=function(e){if(null!=e){var t;if("number"==typeof e){if(!Number.isFinite(e))return;t=String(e)}else{if("string"!=typeof e)return;t=e.trim()}t&&(f.add(t),t.split(rn).map(function(e){return e.trim()}).filter(function(e){return e.length>0}).forEach(function(e){return f.add(e)}))}};return v(null!==(t=e.username)&&void 0!==t?t:void 0),v(null!==(r=e.telegram_username)&&void 0!==r?r:void 0),v(null!==(n=e.telegram_id)&&void 0!==n?n:void 0),v(null!==(a=e.name)&&void 0!==a?a:void 0),v(null!==(l=e.phone)&&void 0!==l?l:void 0),v(null!==(i=e.mobNumber)&&void 0!==i?i:void 0),v(null!==(s=e.email)&&void 0!==s?s:void 0),v(null!==(o=e.role)&&void 0!==o?o:void 0),v(null!==(c=e.roleName)&&void 0!==c?c:void 0),v(null!==(u=e.departmentName)&&void 0!==u?u:void 0),v(null!==(d=e.divisionName)&&void 0!==d?d:void 0),v(null!==(m=e.positionName)&&void 0!==m?m:void 0),Array.isArray(e.permissions)&&e.permissions.forEach(function(e){return v(e)}),Array.from(f)},an=function(e,t,r){var n=r?r.trim():"number"==typeof(null==e?void 0:e.telegram_id)?String(e.telegram_id):void 0;if(n){var a=t.byId.get(n);if(a)return a}var l="string"==typeof(null==e?void 0:e.telegram_username)?e.telegram_username.trim().toLowerCase():void 0;if(l){var i=t.byTelegramUsername.get(l);if(i)return i}var s="string"==typeof(null==e?void 0:e.username)?e.username.trim().toLowerCase():void 0;if(s){var o=t.byUsername.get(s);if(o)return o}},ln="Не удалось загрузить пользователей",sn="Обнаружены дублирующиеся отделы",on="Не удалось загрузить настройки задач",cn="Не удалось сохранить поле задачи",un="Не удалось сохранить тип задачи",dn="Не удалось удалить настройку задачи",mn="Пользователь удалён",fn="Не удалось удалить пользователя",vn="Сотрудник удалён",hn="Не удалось удалить сотрудника",pn=function(e){return"string"==typeof e.accessorKey}}}})}();
//# sourceMappingURL=index-legacy-DFSzv-fz.js.map
