!function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,r,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.toStringTag||"@@toStringTag";function l(n,a,o,i){var l=a&&a.prototype instanceof u?a:u,c=Object.create(l.prototype);return t(c,"_invoke",function(n,t,a){var o,i,l,u=0,c=a||[],m=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(n,t){return o=n,i=0,l=e,d.n=t,s}};function f(n,t){for(i=n,l=t,r=0;!m&&u&&!a&&r<c.length;r++){var a,o=c[r],f=d.p,p=o[2];n>3?(a=p===t)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((a=n<2&&f<o[1])?(i=0,d.v=t,d.n=o[1]):f<p&&(a=n<3||o[0]>t||t>p)&&(o[4]=n,o[5]=t,d.n=p,i=0))}if(a||n>1)return s;throw m=!0,t}return function(a,c,p){if(u>1)throw TypeError("Generator is already running");for(m&&1===c&&f(c,p),i=c,l=p;(r=i<2?e:l)||!m;){o||(i?i<3?(i>1&&(d.n=-1),f(i,l)):d.n=l:d.v=l);try{if(u=2,o){if(i||(a="next"),r=o[a]){if(!(r=r.call(o,l)))throw TypeError("iterator result is not an object");if(!r.done)return r;l=r.value,i<2&&(i=0)}else 1===i&&(r=o.return)&&r.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=e}else if((r=(m=d.n<0)?l:n.call(t,d))!==s)break}catch(r){o=e,i=1,l=r}finally{u=1}}return{value:r,done:m}}}(n,o,i),!0),c}var s={};function u(){}function c(){}function m(){}r=Object.getPrototypeOf;var d=[][o]?r(r([][o]())):(t(r={},o,function(){return this}),r),f=m.prototype=u.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,t(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=m,t(f,"constructor",m),t(m,"constructor",c),c.displayName="GeneratorFunction",t(m,i,"GeneratorFunction"),t(f),t(f,i,"Generator"),t(f,o,function(){return this}),t(f,"toString",function(){return"[object Generator]"}),(n=function(){return{w:l,m:p}})()}function t(e,n,r,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}t=function(e,n,r,a){function i(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?o?o(e,n,{value:r,enumerable:!a,configurable:!a,writable:!a}):e[n]=r:(i("next",0),i("throw",1),i("return",2))},t(e,n,r,a)}function r(e,n,t,r,a,o,i){try{var l=e[o](i),s=l.value}catch(e){return void t(e)}l.done?n(s):Promise.resolve(s).then(r,a)}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach(function(n){i(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function i(n,t,r){return(t=function(n){var t=function(n,t){if("object"!=e(n)||!n)return n;var r=n[Symbol.toPrimitive];if(void 0!==r){var a=r.call(n,t||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"==e(t)?t:t+""}(t))in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function l(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o,i,l=[],s=!0,u=!1;try{if(o=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(r=o.call(t)).done)&&(l.push(r.value),l.length!==n);s=!0);}catch(e){u=!0,a=e}finally{try{if(!s&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}(e,n)||function(e,n){if(e){if("string"==typeof e)return s(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?s(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}System.register(["./index-legacy-wk8xCH9w.js","./vendor-legacy-3V6tX1hl.js","./App-legacy-BLQphYZ4.js","./collections-legacy-BFjdodlx.js"],function(e,t){"use strict";var a,s,u,c,m,d,f;return{setters:[function(e){a=e.j},function(e){s=e.b},function(e){u=e.a,c=e.B,m=e.l,d=e.s},function(e){f=e.f}],execute:function(){e("default",function(){var e=u(),b=e.user,v=e.setUser,h=e.loading,g=l(s.useState(o({},p)),2),x=g[0],j=g[1],N=l(s.useState(o({},p)),2),O=N[0],w=N[1],S=l(s.useState([]),2),P=S[0],k=S[1],I=l(s.useState([]),2),E=I[0],_=I[1],M=l(s.useState([]),2),T=M[0],A=M[1],D=l(s.useState(!1),2),G=D[0],C=D[1],U=l(s.useState(null),2),F=U[0],q=U[1];s.useEffect(function(){f("departments","",1,200).then(function(e){return k(e.items)}).catch(function(){return k([])}),f("divisions","",1,200).then(function(e){return _(e.items)}).catch(function(){return _([])}),f("positions","",1,200).then(function(e){return A(e.items)}).catch(function(){return A([])})},[]),s.useEffect(function(){if(b){var e={name:b.name||b.telegram_username||"",phone:b.phone||"",email:b.email||""};j(e),w(e),q(null)}},[b]);var B=s.useMemo(function(){return y(P)},[P]),$=s.useMemo(function(){return y(E)},[E]),z=s.useMemo(function(){return y(T)},[T]),H=s.useMemo(function(){var e="string"==typeof(null==b?void 0:b.departmentName)?b.departmentName.trim():"";if(e)return e;var n="string"==typeof(null==b?void 0:b.departmentId)?b.departmentId.trim():"";return n?B.get(n)||n:""},[B,null==b?void 0:b.departmentId,null==b?void 0:b.departmentName]),J=s.useMemo(function(){var e="string"==typeof(null==b?void 0:b.divisionName)?b.divisionName.trim():"";if(e)return e;var n="string"==typeof(null==b?void 0:b.divisionId)?b.divisionId.trim():"";return n?$.get(n)||n:""},[$,null==b?void 0:b.divisionId,null==b?void 0:b.divisionName]),K=s.useMemo(function(){var e="string"==typeof(null==b?void 0:b.positionName)?b.positionName.trim():"";if(e)return e;var n="string"==typeof(null==b?void 0:b.positionId)?b.positionId.trim():"";return n?z.get(n)||n:""},[z,null==b?void 0:b.positionId,null==b?void 0:b.positionName]),L=function(e,n){j(function(t){return o(o({},t),{},i({},e,n))})},Q=s.useMemo(function(){return x.name!==O.name||x.phone!==O.phone||x.email!==O.email},[x,O]),R=function(){var e,t=(e=n().m(function e(t){var r,a,o,i,l,s,u;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t.preventDefault(),b&&Q&&!G){e.n=1;break}return e.a(2);case 1:return r=x.name.trim(),a=x.phone.trim(),o=x.email.trim(),C(!0),q(null),e.p=2,e.n=3,m({name:r,phone:a||void 0,email:o});case 3:i=e.v,v(i),l={name:i.name||i.telegram_username||"",phone:i.phone||"",email:i.email||""},j(l),w(l),d("Профиль обновлён","success"),e.n=5;break;case 4:e.p=4,u=e.v,s=u instanceof Error?u.message:"Не удалось обновить профиль",q(s),d(s,"error");case 5:return e.p=5,C(!1),e.f(5);case 6:return e.a(2)}},e,null,[[2,4,5,6]])}),function(){var n=this,t=arguments;return new Promise(function(a,o){var i=e.apply(n,t);function l(e){r(i,a,o,l,s,"next",e)}function s(e){r(i,a,o,l,s,"throw",e)}l(void 0)})});return function(e){return t.apply(this,arguments)}}();if(h)return a.jsx("div",{children:"Загрузка..."});if(!b)return a.jsx("div",{children:"Профиль недоступен"});var V=b.role?t[b.role]||b.role:"—",W=b.telegram_id?String(b.telegram_id):b.id||"",X=b.telegram_username||"—",Y=b.mobNumber||"—";return a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{className:"mx-auto max-w-4xl space-y-4",children:[F&&a.jsx("div",{className:"rounded border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:F}),a.jsxs("form",{onSubmit:R,className:"space-y-4 rounded bg-white p-8 shadow",children:[a.jsx("h2",{className:"text-2xl",children:"Личный кабинет"}),a.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[a.jsxs("label",{className:"space-y-1 md:col-span-2",children:[a.jsx("span",{className:"block text-sm font-medium",children:"ФИО"}),a.jsx("input",{name:"fullName",className:"h-10 w-full rounded border px-3",value:x.name,onChange:function(e){return L("name",e.target.value)},required:!0})]}),a.jsxs("label",{className:"space-y-1",children:[a.jsx("span",{className:"block text-sm font-medium",children:"Телефон"}),a.jsx("input",{name:"phone",className:"h-10 w-full rounded border px-3",value:x.phone,onChange:function(e){return L("phone",e.target.value)},type:"tel",placeholder:""})]}),a.jsxs("label",{className:"space-y-1",children:[a.jsx("span",{className:"block text-sm font-medium",children:"Email"}),a.jsx("input",{name:"email",className:"h-10 w-full rounded border px-3",value:x.email,onChange:function(e){return L("email",e.target.value)},type:"email",required:!0})]}),a.jsxs("label",{className:"space-y-1",children:[a.jsx("span",{className:"block text-sm font-medium",children:"Доп. телефон"}),a.jsx("input",{name:"additionalPhone",className:"h-10 w-full rounded border bg-gray-100 px-3 text-gray-600",value:Y,readOnly:!0,disabled:!0})]}),a.jsxs("label",{className:"space-y-1",children:[a.jsx("span",{className:"block text-sm font-medium",children:"Telegram ID"}),a.jsx("input",{name:"telegramId",className:"h-10 w-full rounded border bg-gray-100 px-3 text-gray-600",value:W,readOnly:!0,disabled:!0})]}),a.jsxs("label",{className:"space-y-1",children:[a.jsx("span",{className:"block text-sm font-medium",children:"Username"}),a.jsx("input",{name:"telegramUsername",className:"h-10 w-full rounded border bg-gray-100 px-3 text-gray-600",value:X,readOnly:!0,disabled:!0})]}),a.jsxs("label",{className:"space-y-1",children:[a.jsx("span",{className:"block text-sm font-medium",children:"Роль"}),a.jsx("input",{name:"role",className:"h-10 w-full rounded border bg-gray-100 px-3 text-gray-600",value:V,readOnly:!0,disabled:!0})]}),a.jsxs("label",{className:"space-y-1",children:[a.jsx("span",{className:"block text-sm font-medium",children:"Департамент"}),a.jsx("input",{name:"department",className:"h-10 w-full rounded border bg-gray-100 px-3 text-gray-600",value:H||"—",readOnly:!0,disabled:!0})]}),a.jsxs("label",{className:"space-y-1",children:[a.jsx("span",{className:"block text-sm font-medium",children:"Отдел"}),a.jsx("input",{name:"division",className:"h-10 w-full rounded border bg-gray-100 px-3 text-gray-600",value:J||"—",readOnly:!0,disabled:!0})]}),a.jsxs("label",{className:"space-y-1",children:[a.jsx("span",{className:"block text-sm font-medium",children:"Должность"}),a.jsx("input",{name:"position",className:"h-10 w-full rounded border bg-gray-100 px-3 text-gray-600",value:K||"—",readOnly:!0,disabled:!0})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx(c,{type:"submit",disabled:!Q||G,children:G?"Сохранение...":"Сохранить"}),a.jsx(c,{type:"button",variant:"outline",onClick:function(){j(O),q(null)},disabled:!Q||G,children:"Отменить"})]})]})]})})});var t={admin:"Администратор",manager:"Менеджер",user:"Пользователь"},p={name:"",phone:"",email:""},y=function(e){var n=new Map;return e.forEach(function(e){n.set(e._id,e.name)}),n}}}})}();
//# sourceMappingURL=Profile-legacy-Dq4Qsf4F.js.map
