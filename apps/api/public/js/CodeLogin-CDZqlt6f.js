import{j as a}from"./index-CiBvN1ph.js";import{b as r,i as h}from"./vendor-DBLHOZWC.js";import{u as x}from"./useToast-D14QlpPZ.js";import{h as l}from"./App-CBKZhWa-.js";function j(){const[o,d]=r.useState(""),[n,c]=r.useState(""),[s,m]=r.useState(!1),{addToast:t}=x(),[p]=h(),i=p.get("expired");r.useEffect(()=>{i&&t("Сессия истекла, войдите снова","error")},[i,t]);async function u(e){e==null||e.preventDefault(),(await l("/api/v1/auth/send_code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({telegramId:Number(o)})})).ok?(m(!0),t("Код отправлен")):t("Не удалось отправить код","error")}async function f(e){e==null||e.preventDefault(),(await l("/api/v1/auth/verify_code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({telegramId:Number(o),code:n})})).ok?window.location.href="/":t("Неверный код","error")}return a.jsxs("form",{className:"flex flex-col gap-2 p-4",onSubmit:s?f:u,children:[a.jsx("input",{id:"code-login-telegram-id",name:"telegramId",className:"border p-2",placeholder:"Telegram ID",value:o,onChange:e=>d(e.target.value)}),a.jsx("a",{className:"text-primary underline",href:"https://telegram.me/userinfobot",target:"_blank",rel:"noopener",children:"Узнать свой ID через @userinfobot"}),s&&a.jsx("input",{id:"code-login-code",name:"verificationCode",className:"border p-2",placeholder:"Код",value:n,onChange:e=>c(e.target.value)}),a.jsx("button",{type:"submit",className:"bg-primary p-2 text-white",children:s?"Войти по коду":"Отправить код"})]})}export{j as default};
//# sourceMappingURL=CodeLogin-CDZqlt6f.js.map
