{"version":3,"file":"DataTable-legacy-DnnK-37s.js","sources":["../../../../node_modules/.pnpm/@heroicons+react@2.2.0_react@18.2.0/node_modules/@heroicons/react/24/outline/esm/MagnifyingGlassIcon.js","../../../web/src/components/DataTable.tsx","../../../web/src/components/GlobalSearch.tsx","../../../web/src/components/SearchFilters.tsx","../../../web/src/components/TableToolbar.tsx"],"sourcesContent":["import * as React from \"react\";\nfunction MagnifyingGlassIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(MagnifyingGlassIcon);\nexport default ForwardRef;","// Назначение файла: универсальная таблица на React Table с виртуализацией строк\n// Основные модули: React, @tanstack/react-table, TableToolbar\n\nimport React from 'react';\nimport {\n  ColumnDef,\n  flexRender,\n  getCoreRowModel,\n  useReactTable,\n  Table as TableType,\n} from '@tanstack/react-table';\n\nimport TableToolbar from './TableToolbar';\n\ninterface DataTableProps<T> {\n  columns: ColumnDef<T, unknown>[];\n  data: T[];\n  pageIndex: number;\n  pageSize: number;\n  pageCount?: number;\n  onPageChange: (page: number) => void;\n  onPageSizeChange?: (size: number) => void;\n  onRowClick?: (row: T) => void;\n  toolbarChildren?: React.ReactNode;\n  showGlobalSearch?: boolean;\n  showFilters?: boolean;\n  wrapCellsAsBadges?: boolean;\n  badgeClassName?: string;\n  badgeWrapperClassName?: string;\n  badgeEmptyPlaceholder?: string;\n  enableVirtualization?: boolean;\n  virtualizationOverscan?: number;\n  virtualizationThreshold?: number;\n  rowHeight?: number;\n  maxBodyHeight?: number;\n}\n\ninterface ColumnMeta {\n  minWidth?: string;\n  maxWidth?: string;\n  width?: string;\n  cellClassName?: string;\n  headerClassName?: string;\n  renderAsBadges?: boolean;\n}\n\nexport const defaultBadgeClassName = [\n  'inline-flex min-h-[1.65rem] max-w-full items-center justify-start gap-1',\n  'rounded-full px-2.5 py-0.5 text-[0.72rem] font-semibold leading-tight text-slate-900',\n  'ring-1 ring-slate-300/80 bg-slate-100/90 shadow-xs',\n  'dark:text-slate-100 dark:ring-slate-600/60 dark:bg-slate-800/80',\n  'truncate',\n].join(' ');\nexport const defaultBadgeWrapperClassName =\n  'flex flex-wrap items-center gap-1.5';\n\nconst sanitizeHtml = (html: string): string =>\n  html\n    .replace(/<[^>]+>/g, ' ')\n    .replace(/\\s+/g, ' ')\n    .trim();\n\nconst normalizeToText = (value: unknown): string => {\n  if (value === null || value === undefined) return '';\n  if (typeof value === 'string') {\n    return sanitizeHtml(value);\n  }\n  if (typeof value === 'number' || typeof value === 'boolean') {\n    return String(value).trim();\n  }\n  return '';\n};\n\nconst extractBadgeItems = (value: React.ReactNode): string[] => {\n  const items: string[] = [];\n  const pushItem = (text: string) => {\n    if (!text) return;\n    if (items.includes(text)) return;\n    items.push(text);\n  };\n  const visit = (node: React.ReactNode) => {\n    if (node === null || node === undefined || node === false) return;\n    if (typeof node === 'string' || typeof node === 'number') {\n      const text = String(node).trim();\n      if (!text) return;\n      const parts = text\n        .split(/[,\\n;]/)\n        .map((part) => part.trim())\n        .filter(Boolean);\n      if (parts.length) {\n        items.push(...parts);\n      } else {\n        items.push(text);\n      }\n      return;\n    }\n    if (Array.isArray(node)) {\n      node.forEach(visit);\n      return;\n    }\n    if (React.isValidElement(node)) {\n      const element = node as React.ReactElement<Record<string, unknown>>;\n      const beforeLength = items.length;\n      visit(element.props.children as React.ReactNode);\n      if (items.length === beforeLength) {\n        const props = element.props || {};\n        const fallbackCandidates: unknown[] = [\n          props['data-badge-label'],\n          props['data-label'],\n          props['aria-label'],\n          props.title,\n        ];\n        fallbackCandidates.forEach((candidate) => {\n          if (candidate === null || candidate === undefined) return;\n          const text = String(candidate).trim();\n          pushItem(text);\n        });\n        const html = props.dangerouslySetInnerHTML as\n          | { __html?: unknown }\n          | undefined;\n        const rawHtml =\n          html && typeof html.__html === 'string'\n            ? sanitizeHtml(html.__html)\n            : '';\n        if (rawHtml) {\n          pushItem(rawHtml);\n        }\n        const renderValue = props.renderValue;\n        if (typeof renderValue === 'function') {\n          const rendered = normalizeToText(renderValue());\n          pushItem(rendered);\n        }\n        const getValue = props.getValue;\n        if (typeof getValue === 'function') {\n          const rawValue = normalizeToText(getValue());\n          pushItem(rawValue);\n        }\n      }\n      return;\n    }\n    const fallback = String(node).trim();\n    pushItem(fallback);\n  };\n  visit(value);\n  return items;\n};\n\nconst renderBadgeContent = (\n  content: React.ReactNode,\n  badgeClassName: string,\n  wrapperClassName: string,\n  emptyPlaceholder: string,\n) => {\n  const items = extractBadgeItems(content);\n  if (!items.length) {\n    return (\n      <span className={badgeClassName} title={emptyPlaceholder}>\n        {emptyPlaceholder}\n      </span>\n    );\n  }\n  if (items.length === 1) {\n    return (\n      <span className={badgeClassName} title={items[0]}>\n        {items[0]}\n      </span>\n    );\n  }\n  return (\n    <div className={wrapperClassName}>\n      {items.map((item, index) => (\n        <span key={`${item}-${index}`} className={badgeClassName} title={item}>\n          {item}\n        </span>\n      ))}\n    </div>\n  );\n};\n\nconst containerClasses = [\n  // Важно: отдельно скроллим по X, отдельно по Y — таблица перестаёт “ломать” сетку на узких экранах\n  'relative w-full overflow-x-auto overflow-y-auto rounded-xl border border-border/70',\n  'bg-background shadow-sm dark:border-border/60',\n].join(' ');\n\nconst tableClasses = [\n  // w-max + min-w-full → на широких экранах заполняет контейнер,\n  // а на узких не “сжимает” колонки до нечитаемого состояния (включается горизонтальный скролл).\n  'w-max min-w-full table-fixed caption-bottom font-ui text-[12px] leading-tight',\n  'text-foreground dark:text-foreground sm:text-[13px]',\n].join(' ');\n\nconst headerCellClasses = [\n  // Sticky header: удобно в админке при скролле списка.\n  'sticky top-0 z-10 border-b border-border/70 px-1.5 py-2 text-left align-middle font-semibold',\n  'bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/70',\n  'text-[11px] leading-snug text-foreground sm:px-2 sm:text-[13px]',\n  // Ключевая часть “наведения порядка”: больше не рвём строки в заголовках.\n  'whitespace-nowrap',\n].join(' ');\n\nconst bodyCellClasses = [\n  'relative z-[1] px-1.5 py-2 align-top text-[12px] leading-snug',\n  'text-foreground sm:px-2 sm:text-sm',\n  // Ключевая часть: строки становятся компактными, а “длиннота” уходит в горизонтальный скролл.\n  'whitespace-nowrap',\n].join(' ');\n\nconst bodyRowClasses = [\n  'group relative isolate min-h-[2.5rem] cursor-pointer select-none',\n  'odd:bg-sky-50/70 even:bg-emerald-50/70 odd:text-slate-900 even:text-slate-900',\n  'hover:odd:bg-sky-100/80 hover:even:bg-emerald-100/80',\n  'dark:odd:bg-slate-800/70 dark:even:bg-slate-700/70 dark:text-slate-100',\n  'dark:hover:odd:bg-slate-700 dark:hover:even:bg-slate-600',\n].join(' ');\n\nconst headerRowClasses = ['text-foreground'].join(' ');\n\nexport default function DataTable<T>({\n  columns,\n  data,\n  pageIndex,\n  pageSize,\n  pageCount,\n  onPageChange,\n  onPageSizeChange,\n  onRowClick,\n  toolbarChildren,\n  showGlobalSearch = true,\n  showFilters = true,\n  wrapCellsAsBadges = false,\n  badgeClassName = defaultBadgeClassName,\n  badgeWrapperClassName = defaultBadgeWrapperClassName,\n  badgeEmptyPlaceholder = '—',\n  enableVirtualization = true,\n  virtualizationOverscan = 6,\n  virtualizationThreshold = 40,\n  rowHeight = 52,\n  maxBodyHeight = 520,\n}: DataTableProps<T>) {\n  const [columnVisibility, setColumnVisibility] = React.useState({});\n  const [columnOrder, setColumnOrder] = React.useState<string[]>([]);\n\n  const table = useReactTable({\n    data,\n    columns,\n    state: {\n      columnVisibility,\n      columnOrder,\n      pagination: { pageIndex, pageSize },\n    },\n    onColumnVisibilityChange: setColumnVisibility,\n    onColumnOrderChange: setColumnOrder,\n    getCoreRowModel: getCoreRowModel(),\n    manualPagination: true,\n    pageCount,\n  });\n\n  const rows = table.getRowModel().rows;\n  const virtualizationContainerRef = React.useRef<HTMLDivElement>(null);\n  const [scrollTop, setScrollTop] = React.useState(0);\n  const [viewportHeight, setViewportHeight] = React.useState(maxBodyHeight);\n\n  const virtualizationActive =\n    enableVirtualization && rows.length > virtualizationThreshold;\n\n  React.useLayoutEffect(() => {\n    if (!virtualizationActive) return;\n    const element = virtualizationContainerRef.current;\n    if (!element) return;\n    const updateHeight = () => {\n      setViewportHeight(element.clientHeight || maxBodyHeight);\n    };\n    updateHeight();\n    if (typeof ResizeObserver !== 'undefined') {\n      const observer = new ResizeObserver(updateHeight);\n      observer.observe(element);\n      return () => observer.disconnect();\n    }\n    return undefined;\n  }, [virtualizationActive, maxBodyHeight]);\n\n  React.useEffect(() => {\n    if (!virtualizationContainerRef.current) return;\n    virtualizationContainerRef.current.scrollTop = 0;\n    setScrollTop(0);\n  }, [rows.length, virtualizationActive]);\n\n  const handleScroll = React.useCallback(\n    (event: React.UIEvent<HTMLDivElement>) => {\n      if (!virtualizationActive) return;\n      setScrollTop(event.currentTarget.scrollTop);\n    },\n    [virtualizationActive],\n  );\n\n  const totalHeight = rows.length * rowHeight;\n  const effectiveViewport = virtualizationActive\n    ? viewportHeight\n    : rows.length * rowHeight;\n  const startIndex = virtualizationActive\n    ? Math.max(0, Math.floor(scrollTop / rowHeight) - virtualizationOverscan)\n    : 0;\n  const endIndex = virtualizationActive\n    ? Math.min(\n        rows.length,\n        Math.ceil((scrollTop + effectiveViewport) / rowHeight) +\n          virtualizationOverscan,\n      )\n    : rows.length;\n\n  const visibleRows = virtualizationActive\n    ? rows.slice(startIndex, endIndex)\n    : rows;\n  const paddingTop = virtualizationActive ? startIndex * rowHeight : 0;\n  const paddingBottom = virtualizationActive\n    ? Math.max(totalHeight - endIndex * rowHeight, 0)\n    : 0;\n\n  const columnCount = Math.max(table.getVisibleLeafColumns().length, 1);\n\n  return (\n    <div className=\"w-full space-y-3 px-0 font-ui text-[13px] sm:px-1.5 sm:text-sm\">\n      <TableToolbar\n        table={table as TableType<T>}\n        showGlobalSearch={showGlobalSearch}\n        showFilters={showFilters}\n      >\n        {toolbarChildren}\n      </TableToolbar>\n      <div\n        ref={virtualizationContainerRef}\n        className={containerClasses}\n        style={{ maxHeight: virtualizationActive ? maxBodyHeight : undefined }}\n        onScroll={handleScroll}\n      >\n        <table className={tableClasses}>\n          <thead>\n            {table.getHeaderGroups().map((hg) => (\n              <tr key={hg.id} className={headerRowClasses}>\n                {hg.headers.map((header) => {\n                  const meta =\n                    (header.column.columnDef.meta as ColumnMeta | undefined) ||\n                    {};\n                  const baseSize = header.getSize();\n                  const computedWidth =\n                    typeof meta.width === 'string'\n                      ? meta.width\n                      : Number.isFinite(baseSize)\n                        ? `${baseSize}px`\n                        : undefined;\n                  const headerClassName = [headerCellClasses, meta.headerClassName]\n                    .filter(Boolean)\n                    .join(' ');\n                  return (\n                    <th\n                      key={header.id}\n                      style={{\n                        width: computedWidth,\n                        minWidth: meta.minWidth ?? '4rem',\n                        maxWidth: meta.maxWidth ?? '24rem',\n                      }}\n                      className={headerClassName}\n                    >\n                      {header.isPlaceholder\n                        ? null\n                        : flexRender(\n                            header.column.columnDef.header,\n                            header.getContext(),\n                          )}\n                    </th>\n                  );\n                })}\n              </tr>\n            ))}\n          </thead>\n          <tbody>\n            {paddingTop > 0 ? (\n              <tr aria-hidden style={{ height: paddingTop }}>\n                <td colSpan={columnCount} />\n              </tr>\n            ) : null}\n            {visibleRows.map((row) => (\n              <tr\n                key={row.id}\n                onClick={() => onRowClick?.(row.original)}\n                className={\n                  onRowClick\n                    ? bodyRowClasses\n                    : bodyRowClasses.replace('cursor-pointer', 'cursor-default')\n                }\n              >\n                {row.getVisibleCells().map((cell) => {\n                  const meta =\n                    (cell.column.columnDef.meta as ColumnMeta | undefined) || {};\n                  const baseSize = cell.column.getSize();\n                  const computedWidth =\n                    typeof meta.width === 'string'\n                      ? meta.width\n                      : Number.isFinite(baseSize)\n                        ? `${baseSize}px`\n                        : undefined;\n                  const cellClassName = [bodyCellClasses, meta.cellClassName]\n                    .filter(Boolean)\n                    .join(' ');\n                  const cellContent = flexRender(\n                    cell.column.columnDef.cell,\n                    cell.getContext(),\n                  );\n                  const shouldWrapWithBadges =\n                    wrapCellsAsBadges && meta.renderAsBadges !== false;\n                  return (\n                    <td\n                      key={cell.id}\n                      style={{\n                        width: computedWidth,\n                        minWidth: meta.minWidth ?? '4rem',\n                        maxWidth: meta.maxWidth ?? '24rem',\n                      }}\n                      className={cellClassName}\n                    >\n                      {shouldWrapWithBadges\n                        ? renderBadgeContent(\n                            cellContent,\n                            badgeClassName,\n                            badgeWrapperClassName,\n                            badgeEmptyPlaceholder,\n                          )\n                        : cellContent}\n                    </td>\n                  );\n                })}\n              </tr>\n            ))}\n            {paddingBottom > 0 ? (\n              <tr aria-hidden style={{ height: paddingBottom }}>\n                <td colSpan={columnCount} />\n              </tr>\n            ) : null}\n            {!rows.length ? (\n              <tr>\n                <td\n                  colSpan={columnCount}\n                  className=\"px-4 py-6 text-center text-sm text-muted-foreground\"\n                >\n                  Нет данных для отображения\n                </td>\n              </tr>\n            ) : null}\n          </tbody>\n        </table>\n      </div>\n      <div className=\"flex flex-col gap-2 text-xs sm:flex-row sm:items-center sm:justify-between sm:text-sm\">\n        <div className=\"flex flex-wrap items-center gap-1\">\n          <button\n            onClick={() => onPageChange(Math.max(0, pageIndex - 1))}\n            disabled={pageIndex === 0}\n            className=\"rounded border border-[color:var(--color-gray-300)] px-2 py-1 font-medium text-[color:var(--color-gray-700)] transition hover:bg-[color:var(--color-gray-50)] disabled:cursor-not-allowed disabled:opacity-50 dark:border-[color:var(--color-gray-700)] dark:text-[color:var(--color-gray-200)] dark:hover:bg-[color:var(--color-gray-800)]\"\n          >\n            Назад\n          </button>\n          <span className=\"px-1 text-[color:var(--color-gray-600)] dark:text-[color:var(--color-gray-300)]\">\n            Стр. {pageIndex + 1}\n            {pageCount ? ` / ${pageCount}` : ''}\n          </span>\n          <button\n            onClick={() =>\n              onPageChange(\n                pageCount\n                  ? Math.min(pageCount - 1, pageIndex + 1)\n                  : pageIndex + 1,\n              )\n            }\n            disabled={pageCount ? pageIndex + 1 >= pageCount : false}\n            className=\"rounded border border-[color:var(--color-gray-300)] px-2 py-1 font-medium text-[color:var(--color-gray-700)] transition hover:bg-[color:var(--color-gray-50)] disabled:cursor-not-allowed disabled:opacity-50 dark:border-[color:var(--color-gray-700)] dark:text-[color:var(--color-gray-200)] dark:hover:bg-[color:var(--color-gray-800)]\"\n          >\n            Вперёд\n          </button>\n        </div>\n        {onPageSizeChange ? (\n          <select\n            value={pageSize}\n            onChange={(event) => onPageSizeChange(Number(event.target.value))}\n            className=\"h-8 min-w-[4rem] rounded border border-[color:var(--color-gray-300)] bg-white px-1.5 text-xs text-[color:var(--color-gray-700)] shadow-sm transition focus:border-[color:var(--color-brand-400)] focus:outline-none focus:ring-2 focus:ring-[color:var(--color-brand-200)] dark:border-[color:var(--color-gray-700)] dark:bg-[color:var(--color-gray-dark)] dark:text-[color:var(--color-gray-100)]\"\n          >\n            {[10, 25, 50].map((size) => (\n              <option key={size} value={size}>\n                {size}\n              </option>\n            ))}\n          </select>\n        ) : null}\n      </div>\n    </div>\n  );\n}\n","// Глобальный модуль поиска\n// Модули: React, heroicons, i18next, ui\nimport React from 'react';\nimport { MagnifyingGlassIcon, XMarkIcon } from '@heroicons/react/24/outline';\nimport { useTranslation } from 'react-i18next';\nimport { Input } from '@/components/ui/input';\nimport useTasks from '../context/useTasks';\n\nexport default function GlobalSearch() {\n  const { query, setQuery } = useTasks();\n  const { t } = useTranslation();\n  const ref = React.useRef<HTMLInputElement>(null);\n  const [value, setValue] = React.useState(query);\n\n  const clear = () => {\n    setValue('');\n    setQuery('');\n    ref.current?.focus();\n  };\n\n  const search = () => {\n    setQuery(value);\n  };\n\n  const onKey = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === 'Escape') {\n      e.stopPropagation();\n      clear();\n      ref.current?.blur();\n    }\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      search();\n    }\n  };\n\n  return (\n    <div className=\"flex items-center gap-1.5\">\n      <div className=\"relative\">\n        <MagnifyingGlassIcon className=\"pointer-events-none absolute top-1/2 left-2 size-4 -translate-y-1/2 text-gray-400\" />\n        <Input\n          ref={ref}\n          value={value}\n          onChange={(e) => setValue(e.target.value)}\n          onKeyDown={onKey}\n          placeholder={t('search')}\n          aria-label={t('search')}\n          className=\"h-8 w-48 pr-8 pl-8\"\n        />\n        {value && (\n          <button\n            onClick={clear}\n            aria-label=\"Очистить\"\n            className=\"absolute top-1/2 right-2 -translate-y-1/2 text-gray-400 hover:text-black\"\n          >\n            <XMarkIcon className=\"size-4\" />\n          </button>\n        )}\n      </div>\n      <button onClick={search} className=\"rounded border px-1.5 py-1\">\n        {t('find')}\n      </button>\n    </div>\n  );\n}\n","// Фильтры поиска задач\n// Модули: React, shared, useTasks\nimport React from 'react';\nimport { TASK_STATUSES, PRIORITIES, TASK_TYPES } from 'shared';\nimport useTasks from '../context/useTasks';\nimport type { TaskFilterUser } from '../context/TasksContext';\n\ninterface Props {\n  inline?: boolean;\n}\n\nexport default function SearchFilters({ inline = false }: Props) {\n  const { filters, setFilters, filterUsers } = useTasks();\n  const [local, setLocal] = React.useState(filters);\n\n  React.useEffect(() => {\n    setLocal(filters);\n  }, [filters]);\n\n  const toFieldId = React.useCallback(\n    (prefix: string, value: string) =>\n      `${prefix}-${value}`\n        .toLowerCase()\n        .replace(/[^a-z0-9а-яё]+/gi, '-')\n        .replace(/-+/g, '-')\n        .replace(/^-|-$/g, ''),\n    [],\n  );\n\n  const toggleString = (\n    key: 'status' | 'priority' | 'taskTypes',\n    value: string,\n  ) => {\n    setLocal((prev) => {\n      const arr = prev[key];\n      const exists = arr.includes(value);\n      const next = exists ? arr.filter((v) => v !== value) : [...arr, value];\n      return { ...prev, [key]: next };\n    });\n  };\n\n  const toggleAssignee = (id: number) => {\n    setLocal((prev) => {\n      const exists = prev.assignees.includes(id);\n      const next = exists\n        ? prev.assignees.filter((value) => value !== id)\n        : [...prev.assignees, id];\n      return { ...prev, assignees: next };\n    });\n  };\n\n  const renderAssigneeLabel = (user: TaskFilterUser) => {\n    if (user.username) {\n      return `${user.name} (@${user.username})`;\n    }\n    return user.name;\n  };\n\n  const content = (\n    <div className=\"flex w-52 flex-col gap-1.5 text-sm\">\n      <div>\n        <span className=\"block text-xs font-semibold uppercase tracking-wide text-gray-600\">\n          Статус\n        </span>\n        {TASK_STATUSES.map((s) => {\n          const fieldId = toFieldId('status', s);\n          return (\n            <label\n              key={s}\n              className=\"flex items-center gap-1 text-[13px]\"\n              htmlFor={fieldId}\n            >\n              <input\n                id={fieldId}\n                name=\"status[]\"\n                type=\"checkbox\"\n                checked={local.status.includes(s)}\n                onChange={() => toggleString('status', s)}\n              />\n              {s}\n            </label>\n          );\n        })}\n      </div>\n      <div>\n        <span className=\"block text-xs font-semibold uppercase tracking-wide text-gray-600\">\n          Приоритет\n        </span>\n        {PRIORITIES.map((p) => {\n          const fieldId = toFieldId('priority', p);\n          return (\n            <label\n              key={p}\n              className=\"flex items-center gap-1 text-[13px]\"\n              htmlFor={fieldId}\n            >\n              <input\n                id={fieldId}\n                name=\"priority[]\"\n                type=\"checkbox\"\n                checked={local.priority.includes(p)}\n                onChange={() => toggleString('priority', p)}\n              />\n              {p}\n            </label>\n          );\n        })}\n      </div>\n      <div>\n        <span className=\"block text-xs font-semibold uppercase tracking-wide text-gray-600\">\n          Тип задачи\n        </span>\n        {TASK_TYPES.map((type) => {\n          const fieldId = toFieldId('task-type', type);\n          return (\n            <label\n              key={type}\n              className=\"flex items-center gap-1 text-[13px]\"\n              htmlFor={fieldId}\n            >\n              <input\n                id={fieldId}\n                name=\"taskTypes[]\"\n                type=\"checkbox\"\n                checked={local.taskTypes.includes(type)}\n                onChange={() => toggleString('taskTypes', type)}\n              />\n              {type}\n            </label>\n          );\n        })}\n      </div>\n      <div>\n        <span className=\"block text-xs font-semibold uppercase tracking-wide text-gray-600\">\n          Исполнители\n        </span>\n        <div className=\"max-h-28 overflow-y-auto pr-1\">\n          {filterUsers.map((user) => {\n            const fieldId = toFieldId('assignee', String(user.id));\n            return (\n              <label\n                key={user.id}\n                className=\"flex items-center gap-1 text-[13px]\"\n                htmlFor={fieldId}\n              >\n                <input\n                  id={fieldId}\n                  name=\"assignees[]\"\n                  type=\"checkbox\"\n                  checked={local.assignees.includes(user.id)}\n                  onChange={() => toggleAssignee(user.id)}\n                />\n                {renderAssigneeLabel(user)}\n              </label>\n            );\n          })}\n          {filterUsers.length === 0 ? (\n            <span className=\"block text-[13px] text-muted-foreground\">\n              Нет доступных исполнителей\n            </span>\n          ) : null}\n        </div>\n      </div>\n      <div className=\"flex items-center gap-1.5\">\n        <input\n          type=\"date\"\n          className=\"rounded border px-1.5 py-1 text-[13px]\"\n          name=\"from\"\n          value={local.from}\n          onChange={(e) => setLocal({ ...local, from: e.target.value })}\n        />\n        <input\n          type=\"date\"\n          className=\"rounded border px-1.5 py-1 text-[13px]\"\n          name=\"to\"\n          value={local.to}\n          onChange={(e) => setLocal({ ...local, to: e.target.value })}\n        />\n      </div>\n      <button\n        onClick={() => setFilters(local)}\n        className=\"mt-1.5 rounded border px-1.5 py-1 text-[13px]\"\n      >\n        Искать\n      </button>\n    </div>\n  );\n\n  if (inline) return content;\n\n  return (\n    <details className=\"relative\">\n      <summary className=\"cursor-pointer rounded border px-1.5 py-0.5 select-none text-sm\">\n        Фильтры\n      </summary>\n      <div className=\"absolute z-10 mt-1 rounded border bg-white p-1.5 shadow\">\n        {content}\n      </div>\n    </details>\n  );\n}\n","// Назначение файла: общий тулбар таблицы с экспортом, поиском и фильтрацией\n// Модули: React, @tanstack/react-table, jspdf\nimport React from 'react';\nimport type { Table } from '@tanstack/react-table';\nimport type JsPDFClass from 'jspdf';\nimport type { UserOptions as AutoTableOptions } from 'jspdf-autotable';\nimport { useTranslation } from 'react-i18next';\nimport GlobalSearch from './GlobalSearch';\nimport SearchFilters from './SearchFilters';\n\ninterface Props<T> {\n  table: Table<T>;\n  children?: React.ReactNode;\n  showGlobalSearch?: boolean;\n  showFilters?: boolean;\n}\n\ntype JsPdfWithAutoTable = InstanceType<typeof JsPDFClass> & {\n  autoTable: (options: AutoTableOptions) => void;\n};\n\nexport default function TableToolbar<T>({\n  table,\n  children,\n  showGlobalSearch = true,\n  showFilters = true,\n}: Props<T>) {\n  const columns = table.getAllLeafColumns();\n  const { t } = useTranslation();\n\n  const exportCsv = () => {\n    const headers = columns\n      .filter((c) => c.getIsVisible())\n      .map((c) => c.columnDef.header as string);\n    const rows = table\n      .getRowModel()\n      .rows.map((r) =>\n        r.getVisibleCells().map((c) => String(c.getValue() ?? '')),\n      );\n    const csv = [headers.join(','), ...rows.map((r) => r.join(','))].join('\\n');\n    const blob = new Blob([csv], { type: 'text/csv' });\n    const a = document.createElement('a');\n    a.href = URL.createObjectURL(blob);\n    a.download = 'table.csv';\n    a.click();\n  };\n\n  const exportPdf = async () => {\n    const pdfEntry = 'jspdf';\n    const autoTableEntry = 'jspdf-autotable';\n    const { default: jsPDF } = await import(/* @vite-ignore */ pdfEntry);\n    await import(/* @vite-ignore */ autoTableEntry);\n    const headers = columns\n      .filter((c) => c.getIsVisible())\n      .map((c) => c.columnDef.header as string);\n    const rows = table\n      .getRowModel()\n      .rows.map((r) =>\n        r.getVisibleCells().map((c) => String(c.getValue() ?? '')),\n      );\n    const doc = new jsPDF() as JsPdfWithAutoTable;\n    doc.autoTable({ head: [headers], body: rows });\n    doc.save('table.pdf');\n  };\n\n  const toggleColumn = (id: string) => {\n    const col = table.getColumn(id);\n    if (col) col.toggleVisibility();\n  };\n\n  const moveColumn = (id: string, dir: number) => {\n    const order = table.getState().columnOrder;\n    const idx = order.indexOf(id);\n    if (idx === -1) return;\n    const next = idx + dir;\n    if (next < 0 || next >= order.length) return;\n    const newOrder = [...order];\n    [newOrder[idx], newOrder[next]] = [newOrder[next], newOrder[idx]];\n    table.setColumnOrder(newOrder);\n  };\n\n  return (\n    <div className=\"flex w-full flex-wrap items-center gap-1 text-xs sm:text-sm\">\n      <div className=\"flex flex-1 flex-wrap items-center gap-1\">\n        {showGlobalSearch ? <GlobalSearch /> : null}\n        {children}\n      </div>\n      <div className=\"ml-auto flex w-full flex-wrap items-center justify-end gap-1 sm:w-auto\">\n        <details className=\"group relative flex-shrink-0\">\n          <summary className=\"cursor-pointer rounded-t-md rounded-b-none border border-b-0 border-gray-200 bg-white px-2 py-1 text-xs font-semibold leading-tight text-gray-700 shadow-sm transition-colors select-none hover:bg-gray-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-1 group-open:border-gray-200 sm:text-sm\">\n            {t('export')}\n          </summary>\n          <div className=\"absolute left-0 top-full z-10 w-32 min-w-full rounded-b-md border border-t border-gray-200 bg-white p-1 shadow-sm\">\n            <button\n              onClick={exportCsv}\n              className=\"block w-full rounded px-1.5 py-1 text-left text-xs font-medium transition-colors hover:bg-gray-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-1 sm:text-sm\"\n            >\n              CSV\n            </button>\n            <button\n              onClick={() => void exportPdf()}\n              className=\"mt-1 block w-full rounded px-1.5 py-1 text-left text-xs font-medium transition-colors hover:bg-gray-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-1 sm:text-sm\"\n            >\n              PDF\n            </button>\n          </div>\n        </details>\n        <details className=\"group relative flex-shrink-0\">\n          <summary className=\"cursor-pointer rounded-t-md rounded-b-none border border-b-0 border-gray-200 bg-white px-2 py-1 text-xs font-semibold leading-tight text-gray-700 shadow-sm transition-colors select-none hover:bg-gray-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-1 group-open:border-gray-200 sm:text-sm\">\n            {t('settings')}\n          </summary>\n          <div className=\"absolute left-0 top-full z-10 w-64 min-w-full space-y-1 rounded-b-md border border-t border-gray-200 bg-white p-1.5 shadow-sm\">\n            {showFilters ? <SearchFilters inline /> : null}\n            <div className=\"border-t pt-1\">\n              {columns.map((col) => (\n                <div\n                  key={col.id}\n                  className=\"flex items-center justify-between gap-1\"\n                >\n                  <label\n                    className=\"flex items-center gap-1 text-xs font-medium sm:text-sm\"\n                    htmlFor={`table-column-${col.id}`}\n                  >\n                    <input\n                      id={`table-column-${col.id}`}\n                      name={`column-${col.id}`}\n                      type=\"checkbox\"\n                      checked={col.getIsVisible()}\n                      onChange={() => toggleColumn(col.id)}\n                    />\n                    {col.columnDef.header as string}\n                  </label>\n                  <div className=\"flex gap-1\">\n                    <button\n                      onClick={() => moveColumn(col.id, -1)}\n                      className=\"rounded border border-gray-200 px-1 text-xs font-medium leading-none text-gray-700 transition-colors hover:bg-gray-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-1\"\n                    >\n                      ←\n                    </button>\n                    <button\n                      onClick={() => moveColumn(col.id, 1)}\n                      className=\"rounded border border-gray-200 px-1 text-xs font-medium leading-none text-gray-700 transition-colors hover:bg-gray-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-1\"\n                    >\n                      →\n                    </button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        </details>\n      </div>\n    </div>\n  );\n}\n"],"names":["MagnifyingGlassIcon","_ref","svgRef","title","titleId","props","_objectWithoutProperties","_excluded","React.createElement","Object","assign","xmlns","fill","viewBox","strokeWidth","stroke","ref","id","strokeLinecap","strokeLinejoin","d","_ref6","columns","data","pageIndex","pageSize","pageCount","onPageChange","onPageSizeChange","onRowClick","toolbarChildren","_ref6$showGlobalSearc","showGlobalSearch","_ref6$showFilters","showFilters","_ref6$wrapCellsAsBadg","wrapCellsAsBadges","_ref6$badgeClassName","badgeClassName","defaultBadgeClassName","_ref6$badgeWrapperCla","badgeWrapperClassName","defaultBadgeWrapperClassName","_ref6$badgeEmptyPlace","badgeEmptyPlaceholder","_ref6$enableVirtualiz","enableVirtualization","_ref6$virtualizationO","virtualizationOverscan","_ref6$virtualizationT","virtualizationThreshold","_ref6$rowHeight","rowHeight","_ref6$maxBodyHeight","maxBodyHeight","_React$useState6","_slicedToArray","React","useState","columnVisibility","setColumnVisibility","_React$useState8","columnOrder","setColumnOrder","table","useReactTable","state","pagination","onColumnVisibilityChange","onColumnOrderChange","getCoreRowModel","manualPagination","rows","getRowModel","virtualizationContainerRef","useRef","_React$useState0","scrollTop","setScrollTop","_React$useState10","viewportHeight","setViewportHeight","virtualizationActive","length","useLayoutEffect","element","current","updateHeight","clientHeight","ResizeObserver","observer","observe","disconnect","useEffect","handleScroll","useCallback","event","currentTarget","totalHeight","effectiveViewport","startIndex","Math","max","floor","endIndex","min","ceil","visibleRows","slice","paddingTop","paddingBottom","columnCount","getVisibleLeafColumns","jsxs","className","children","jsx","TableToolbar","containerClasses","style","maxHeight","onScroll","tableClasses","getHeaderGroups","map","hg","headerRowClasses","headers","header","_meta$minWidth","_meta$maxWidth","meta","column","columnDef","baseSize","getSize","computedWidth","width","Number","isFinite","concat","headerClassName","headerCellClasses","filter","Boolean","join","minWidth","maxWidth","isPlaceholder","flexRender","getContext","height","colSpan","row","onClick","original","bodyRowClasses","replace","getVisibleCells","cell","_meta$minWidth2","_meta$maxWidth2","cellClassName","bodyCellClasses","cellContent","shouldWrapWithBadges","renderAsBadges","renderBadgeContent","disabled","value","onChange","target","size","ForwardRef","React.forwardRef","GlobalSearch","_useTasks","useTasks","query","setQuery","t","useTranslation","_React$useState2","setValue","clear","_ref$current","focus","search","Input","e","onKeyDown","_ref$current2","key","stopPropagation","blur","preventDefault","placeholder","XMarkIcon","SearchFilters","_ref2","_ref2$inline","inline","_useTasks2","filters","setFilters","filterUsers","_React$useState4","local","setLocal","toFieldId","prefix","toLowerCase","toggleString","prev","arr","next","includes","v","_toConsumableArray","_objectSpread","_defineProperty","renderAssigneeLabel","user","username","name","content","TASK_STATUSES","s","fieldId","htmlFor","type","checked","status","PRIORITIES","p","priority","TASK_TYPES","taskTypes","String","assignees","from","to","_ref3","_ref3$showGlobalSearc","_ref3$showFilters","getAllLeafColumns","exportPdf","_callee","autoTableEntry","_yield$module$import","jsPDF","doc","_regenerator","w","_context","n","module","import","default","c","getIsVisible","r","_c$getValue2","getValue","autoTable","head","body","save","a","moveColumn","dir","order","getState","idx","indexOf","newOrder","_ref5","_c$getValue","csv","blob","Blob","document","createElement","href","URL","createObjectURL","download","click","col","getColumn","toggleVisibility","toggleColumn","exports","sanitizeHtml","html","trim","normalizeToText","wrapperClassName","emptyPlaceholder","items","pushItem","text","push","visit","node","Array","isArray","forEach","isValidElement","beforeLength","candidate","dangerouslySetInnerHTML","rawHtml","__html","renderValue","rendered","rawValue","fallback","parts","split","part","apply","extractBadgeItems","item","index"],"mappings":"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","x_google_ignoreList":[0]}