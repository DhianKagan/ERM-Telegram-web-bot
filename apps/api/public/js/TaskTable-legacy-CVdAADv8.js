!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}System.register(["./index-legacy-wk8xCH9w.js","./vendor-legacy-3V6tX1hl.js","./taskColumns-legacy-Sq45OePX.js","./AuthenticatedApp-legacy-G7eJFt6z.js","./App-legacy-BLQphYZ4.js"],function(t,n){"use strict";var r,i,o,a,u,s,c;return{setters:[function(e){r=e.j,i=e._},function(e){o=e.R,a=e.b},function(e){u=e.t},function(e){s=e.u},function(e){c=e.g}],execute:function(){t("T",function(e){var t=e.tasks,n=e.users,i=e.page,l=e.pageCount,d=e.mine,p=void 0!==d&&d,h=e.entityKind,v=void 0===h?"task":h,b=e.onPageChange,_=e.onMineChange,k=e.onRowClick,j=e.toolbarChildren,C=e.onDataChange,S=s(),x=S.query,w=S.filters,A=o.useMemo(function(){return null!=n?n:{}},[n]),E=o.useMemo(function(){return u(A,v)},[A,v]);return o.useEffect(function(){null==C||C(t)},[C,t]),r.jsx(a.Suspense,{fallback:r.jsx("div",{children:"Загрузка таблицы..."}),children:r.jsx(g,{columns:E,data:t.filter(function(e){if(x&&!function(e,t,n){var r=y(t);if(!r.length)return!0;var i=m(e,n);return!!i.length&&r.every(function(e){return f(e).some(function(e){return i.some(function(t){return t.includes(e)})})})}(e,x,A))return!1;if(w.status.length&&!w.status.includes(e.status))return!1;if(w.priority.length&&!w.priority.includes(e.priority))return!1;if(w.taskTypes.length){var t="string"==typeof e.task_type?e.task_type.trim():"";if(!t||!w.taskTypes.includes(t))return!1}if(w.assignees.length){var n=new Set,r=function(e){if("number"==typeof e&&Number.isFinite(e))n.add(e);else if("string"==typeof e){var t=Number(e.trim());Number.isFinite(t)&&n.add(t)}};if(Array.isArray(e.assignees)&&e.assignees.forEach(r),r(e.assigned_user_id),!w.assignees.some(function(e){return n.has(Number(e))}))return!1}var i=e.createdAt?new Date(e.createdAt):null;return!(w.from&&i&&i<new Date(w.from))&&!(w.to&&i&&i>new Date(w.to))}),pageIndex:i,pageSize:25,pageCount:l,onPageChange:b,onRowClick:function(e){var t=e,n=c(t._id)||c(t.id);n&&(null==k||k(n))},toolbarChildren:r.jsxs(r.Fragment,{children:["function"==typeof _&&r.jsxs("label",{className:"flex items-center gap-1 text-sm",htmlFor:"task-table-mine",children:[r.jsx("input",{id:"task-table-mine",name:"mineTasks",type:"checkbox",checked:p,onChange:function(e){return _(e.target.checked)}}),"Мои"]}),j]})})})});var f=function(e){var t=e.trim().toLowerCase();if(!t)return[];var n=t.replace(/[\s\-_/]+/g,"");return n&&n!==t?[t,n]:[t]},l=function(e,t){if("string"!=typeof t){if("number"==typeof t&&Number.isFinite(t)){var n=String(t);f(n).forEach(function(t){return e.add(t)})}}else f(t).forEach(function(t){return e.add(t)})},d=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;r>2||null==t||(Array.isArray(t)?t.forEach(function(e){return d(e,n,r+1)}):t instanceof Date?l(n,t.toISOString()):"object"!==e(t)?l(n,t):Object.values(t).forEach(function(e){return d(e,n,r+1)}))},m=function(e,t){var n,r,i,o=new Set;[e.id,e._id,e.request_id,e.task_number,e.title,e.task_description,e.location,e.start_location,e.end_location,e.project,e.comment,e.status,e.priority,e.task_type,e.route_distance_km].forEach(function(e){return l(o,e)});var a=new Set,u=function(e){var t=function(e){if("number"==typeof e&&Number.isFinite(e))return e;if("string"==typeof e){var t=e.trim();if(!t)return;var n=Number(t);if(Number.isFinite(n))return n}}(e);void 0!==t?(a.add(t),l(o,t)):"string"==typeof e&&l(o,e)};return u(null!==(n=null!==(r=e.created_by)&&void 0!==r?r:e.creator)&&void 0!==n?n:e.createdBy),u(e.assigned_user_id),u(e.controller_user_id),(e.assignees||[]).forEach(function(e){return u(e)}),null===(i=e.controllers)||void 0===i||i.forEach(function(e){return u(e)}),a.forEach(function(e){return n=t[e],r=o,void(n&&[n.name,n.username,n.telegram_username,n.telegramId,n.telegram_id,n.phone,n.mobNumber,n.email].forEach(function(e){return l(r,e)}));var n,r}),d(e.custom,o),d(e.applicant,o),d(e.logistics_details,o),d(e.procurement_details,o),d(e.work_details,o),Array.from(o)},y=function(e){return e.trim().toLowerCase().split(/\s+/).filter(Boolean)};var g=a.lazy(function(){return i(function(){return n.import("./DataTable-legacy-BuvgAuWL.js")},void 0)})}}})}();
//# sourceMappingURL=TaskTable-legacy-CVdAADv8.js.map
