<!-- Назначение файла: практический трекер внедрения оптимизаций Railway по подзадачам. -->

# Railway task board — внедрение оптимизации нагрузки и затрат

Дата старта: 11 Feb 2026 (Europe/Kyiv)

## Как читать этот трекер

- `[x]` — задача внедрена в репозиторий.
- `[~]` — в работе.
- `[ ]` — не начата.

## Этап 1 — разнести запуск процессов по отдельным Railway service commands

- [x] **T1.1** Добавить отдельные стартовые команды для API, bot и worker в корневые npm scripts.
- [x] **T1.2** Перевести `Procfile.railway` на вызов этих команд.
- [ ] **T1.3** В Railway для каждого сервиса выбрать соответствующую команду запуска (`web`, `bot`, `worker`) и проверить health.

Ожидаемый эффект:

- Явное разделение entrypoint'ов и предсказуемая настройка per-service окружения.

## Этап 2 — первичные лимиты и переменные рантайма

- [x] **T2.1** Ввести per-service `NODE_OPTIONS` (api/bot/worker) в `docker-compose.services.yml` и runbook.
- [ ] **T2.2** Разделить `QUEUE_CONCURRENCY` и связанные параметры по сервисам.
- [ ] **T2.3** Зафиксировать рекомендуемые стартовые лимиты RAM/CPU в docs + runbook.

## Этап 3 — BullMQ и наблюдаемость

- [ ] **T3.1** Проверить и привести к единому виду `removeOnComplete/removeOnFail`.
- [ ] **T3.2** Добавить базовые метрики по длительности и ошибкам job'ов.
- [ ] **T3.3** Добавить алерт на restart burst (>3 рестарта / 15 минут).

## Этап 4 — подтверждение эффективности

- [ ] **T4.1** Снять baseline метрик до изменений (7–14 дней).
- [ ] **T4.2** Выполнить staged rollout (worker → bot → api).
- [ ] **T4.3** Подготовить отчёт baseline vs after (стоимость, p95, queue lag, OOM/restarts).
