!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}System.register(["./index-legacy-Cw3EU-FN.js","./vendor-legacy-3V6tX1hl.js","./taskColumns-legacy-DnDkRZo5.js","./AuthenticatedApp-legacy-BR--zcF1.js","./App-legacy-92jDSsGS.js"],function(t,n){"use strict";var r,i,o,a,u,s,c;return{setters:[function(e){r=e.j,i=e._},function(e){o=e.R,a=e.b},function(e){u=e.t},function(e){s=e.u},function(e){c=e.g}],execute:function(){t("T",function(e){var t=e.tasks,n=e.users,i=void 0===n?{}:n,l=e.page,d=e.pageCount,p=e.mine,h=void 0!==p&&p,v=e.entityKind,b=void 0===v?"task":v,_=e.onPageChange,k=e.onMineChange,j=e.onRowClick,C=e.toolbarChildren,S=e.onDataChange,x=s(),w=x.query,A=x.filters,E=o.useMemo(function(){return u(i,b)},[i,b]);return o.useEffect(function(){null==S||S(t)},[S,t]),r.jsx(a.Suspense,{fallback:r.jsx("div",{children:"Загрузка таблицы..."}),children:r.jsx(g,{columns:E,data:t.filter(function(e){if(w&&!function(e,t,n){var r=y(t);if(!r.length)return!0;var i=m(e,n);return!!i.length&&r.every(function(e){return f(e).some(function(e){return i.some(function(t){return t.includes(e)})})})}(e,w,i))return!1;if(A.status.length&&!A.status.includes(e.status))return!1;if(A.priority.length&&!A.priority.includes(e.priority))return!1;if(A.taskTypes.length){var t="string"==typeof e.task_type?e.task_type.trim():"";if(!t||!A.taskTypes.includes(t))return!1}if(A.assignees.length){var n=new Set,r=function(e){if("number"==typeof e&&Number.isFinite(e))n.add(e);else if("string"==typeof e){var t=Number(e.trim());Number.isFinite(t)&&n.add(t)}};if(Array.isArray(e.assignees)&&e.assignees.forEach(r),r(e.assigned_user_id),!A.assignees.some(function(e){return n.has(Number(e))}))return!1}var o=e.createdAt?new Date(e.createdAt):null;return!(A.from&&o&&o<new Date(A.from))&&!(A.to&&o&&o>new Date(A.to))}),pageIndex:l,pageSize:25,pageCount:d,onPageChange:_,onRowClick:function(e){var t=e,n=c(t._id)||c(t.id);n&&(null==j||j(n))},toolbarChildren:r.jsxs(r.Fragment,{children:["function"==typeof k&&r.jsxs("label",{className:"flex items-center gap-1 text-sm",htmlFor:"task-table-mine",children:[r.jsx("input",{id:"task-table-mine",name:"mineTasks",type:"checkbox",checked:h,onChange:function(e){return k(e.target.checked)}}),"Мои"]}),C]})})})});var f=function(e){var t=e.trim().toLowerCase();if(!t)return[];var n=t.replace(/[\s\-_/]+/g,"");return n&&n!==t?[t,n]:[t]},l=function(e,t){if("string"!=typeof t){if("number"==typeof t&&Number.isFinite(t)){var n=String(t);f(n).forEach(function(t){return e.add(t)})}}else f(t).forEach(function(t){return e.add(t)})},d=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;r>2||null==t||(Array.isArray(t)?t.forEach(function(e){return d(e,n,r+1)}):t instanceof Date?l(n,t.toISOString()):"object"!==e(t)?l(n,t):Object.values(t).forEach(function(e){return d(e,n,r+1)}))},m=function(e,t){var n,r,i,o=new Set;[e.id,e._id,e.request_id,e.task_number,e.title,e.task_description,e.location,e.start_location,e.end_location,e.project,e.comment,e.status,e.priority,e.task_type,e.route_distance_km].forEach(function(e){return l(o,e)});var a=new Set,u=function(e){var t=function(e){if("number"==typeof e&&Number.isFinite(e))return e;if("string"==typeof e){var t=e.trim();if(!t)return;var n=Number(t);if(Number.isFinite(n))return n}}(e);void 0!==t?(a.add(t),l(o,t)):"string"==typeof e&&l(o,e)};return u(null!==(n=null!==(r=e.created_by)&&void 0!==r?r:e.creator)&&void 0!==n?n:e.createdBy),u(e.assigned_user_id),u(e.controller_user_id),(e.assignees||[]).forEach(function(e){return u(e)}),null===(i=e.controllers)||void 0===i||i.forEach(function(e){return u(e)}),a.forEach(function(e){return n=t[e],r=o,void(n&&[n.name,n.username,n.telegram_username,n.telegramId,n.telegram_id,n.phone,n.mobNumber,n.email].forEach(function(e){return l(r,e)}));var n,r}),d(e.custom,o),d(e.applicant,o),d(e.logistics_details,o),d(e.procurement_details,o),d(e.work_details,o),Array.from(o)},y=function(e){return e.trim().toLowerCase().split(/\s+/).filter(Boolean)};var g=a.lazy(function(){return i(function(){return n.import("./DataTable-legacy-BVxdFFVf.js")},void 0)})}}})}();
//# sourceMappingURL=TaskTable-legacy-CNCVxLCE.js.map
