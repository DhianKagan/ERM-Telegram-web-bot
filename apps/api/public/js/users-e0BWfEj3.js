import{h as c,I as h,J as f}from"./App-CBKZhWa-.js";const p=new Set(["roleId","departmentId","divisionId","positionId"]),w=r=>{if(typeof r!="string")return;const t=r.trim();return t.length>0?t:void 0},y=(r,t,s)=>{const e={};if(r!==void 0&&(e.id=r),typeof t=="string"){const n=t.trim();n.length>0&&(e.username=n)}else t!==void 0&&(e.username=t);const o=w(s);return o&&(e.roleId=o),e},m=r=>{const t={};return Object.entries(r).forEach(([s,e])=>{if(e!=null){if(typeof e=="string"){const o=e.trim();if(p.has(s)){if(o.length===0)return;t[s]=o;return}t[s]=o;return}t[s]=e}}),t},l=async r=>{const t=await c("/api/v1/users/".concat(r),{noRedirect:!0});if(t.status===404)return null;if(!t.ok){const e=await t.text().catch(()=>"");throw new Error(e||"Не удалось загрузить пользователя")}const s=await t.json();return f(s)},g=async()=>{const r=await c("/api/v1/users");if(r.ok){const s=await r.json();return Array.isArray(s)?h(s):[]}const t=await r.text().catch(()=>"");throw new Error(t||"Не удалось загрузить пользователей")},b=(r,t,s)=>{const e=y(r,t,s);return c("/api/v1/users",{method:"POST",confirmed:!0,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(async o=>{if(!o.ok){const i=await o.text().catch(()=>"");let a="Не удалось создать пользователя";if(i)try{const d=JSON.parse(i);a=d.error||d.detail||d.message||a}catch(d){a=i}throw new Error(a)}const n=await o.json();return f(n)})},E=(r,t)=>c("/api/v1/users?preview=1",{method:"POST",confirmed:!0,headers:{"Content-Type":"application/json"},body:JSON.stringify({id:r,username:t})}).then(async s=>{if(!s.ok){const e=await s.text().catch(()=>"");let o="Не удалось получить сгенерированные данные";if(e)try{const n=JSON.parse(e);o=n.error||n.detail||n.message||o}catch(n){o=e}throw new Error(o)}return s.json()}),U=(r,t)=>{const s=m(t);return c("/api/v1/users/".concat(r),{method:"PATCH",confirmed:!0,headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then(async e=>{if(!e.ok){const n=await e.text().catch(()=>"");let i="Не удалось обновить пользователя";if(n)try{const a=JSON.parse(n);i=a.error||a.detail||a.message||i}catch(a){i=n}throw new Error(i)}const o=await e.json();return f(o)})},j=async r=>{const t=await c("/api/v1/users/".concat(r),{method:"DELETE",confirmed:!0});if(t.status===404)throw new Error("Пользователь не найден");if(!t.ok){const s=await t.text().catch(()=>"");throw new Error(s||"Не удалось удалить пользователя")}};export{l as a,b as c,j as d,g as f,E as p,U as u};
//# sourceMappingURL=users-e0BWfEj3.js.map
