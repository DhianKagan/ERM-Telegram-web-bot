<!-- Назначение файла: единая индекс-страница документации и навигации по проекту. -->

# ERM Telegram Web Bot — Индекс проекта

> Живой документ для быстрой навигации по проекту: что уже реализовано, где это лежит и куда смотреть в первую очередь.
> Документ можно безопасно расширять по мере роста системы.

---

## 1) Что это за проект

**ERM Telegram Web Bot** — монорепозиторий системы управления задачами и ресурсами предприятия:

- Telegram-бот для постановки и контроля задач,
- REST API (Express + TypeScript),
- веб-интерфейс (панель управления, коллекции, аналитика),
- фоновые очереди и интеграции (Redis/BullMQ, карты, хранилище файлов).

Проект рассчитан на ролевую модель доступа, аудит действий, вложения, экспорт данных и операционную наблюдаемость.

---

## 2) Состав монорепозитория

### Приложения

- `apps/api` — API, бизнес-логика, авторизация, RBAC, маршруты, интеграции.
- `apps/worker` — воркер фоновых задач.

### Пакеты

- `packages/shared` — общие типы/утилиты для приложений.
- `packages/types` — типы и контракты между сервисами.

### Инфраструктура и эксплуатация

- `prometheus/` — мониторинг и метрики.
- `profiling/` — профилирование и эксплуатационные настройки.
- `scripts/` — служебные/CI-скрипты, проверки и утилиты.

---

## 3) Что уже есть в функционале

- Управление задачами: создание, назначение, статусы, фильтры, архивирование.
- Управление коллекциями: объекты, отделы, сотрудники, автопарк, основные средства.
- Файлы: загрузка, предпросмотр, привязка к сущностям, диагностика «осиротевших» файлов.
- Telegram-интеграция: уведомления и взаимодействие с задачами.
- Аналитика и журналы: отчёты, событийный лог, базовые эксплуатационные метрики.
- Короткие ссылки и редиректы по slug (`/:prefix/:slug`) для безопасной переадресации.

---

## 4) Индекс документации (куда идти за деталями)

### Базовая навигация

- Главный обзор: [`../README.md`](../README.md)
- Техническое руководство: [`technical_manual.md`](technical_manual.md)
- Архитектура: [`architecture.md`](architecture.md)
- Инструкции для ассистентов/Codex: [`../AGENTS.md`](../AGENTS.md), [`../.openai/assistant_instructions.json`](../.openai/assistant_instructions.json)

### API и эксплуатация

- API-документация: [`api/`](api)
- Логи и деплой в Railway: [`railway_logs.md`](railway_logs.md), [`railway_full_setup.md`](railway_full_setup.md), [`railway_split_services.md`](railway_split_services.md)
- Планы надёжности/восстановления: [`logistics_recovery_plan.md`](logistics_recovery_plan.md)
- Монорепо (аудит A1): [`workspace-audit-a1.md`](workspace-audit-a1.md)
- Монорепо (baseline A5): [`test_reports/2026-02-12_monorepo-a5-baseline.md`](test_reports/2026-02-12_monorepo-a5-baseline.md)

### Безопасность и процессы

- Безопасность: [`security/`](security)
- Roadmap: [`../ROADMAP.md`](../ROADMAP.md)
- Архив старых материалов: [`archive/`](archive)

---

## 5) Ловушка «кривых ссылок» и редиректов (рабочий реестр)

Используем этот раздел как **единый реестр проблемных URL**:

| Тип          | Проблемный путь         | Ожидаемое поведение                                            | Статус      |
| ------------ | ----------------------- | -------------------------------------------------------------- | ----------- |
| HTTP 404     | `/` (POST)              | Возврат `404 Not found` для невалидных POST-запросов на корень | ✅ внедрено |
| SPA fallback | `GET /<frontend-route>` | Отдача `index.html` для клиентских маршрутов без расширений    | ✅ внедрено |
| Short links  | `/<short-prefix>/:slug` | Редирект по сохранённой короткой ссылке                        | ✅ внедрено |

> По мере обнаружения новых «кривых» ссылок добавляйте строки в таблицу: это станет рабочей картой для точечных фиксов.

---

## 6) Как поддерживать этот индекс

1. Добавляйте новые разделы только при реальных изменениях в проекте.
2. Для каждого нового крупного модуля добавляйте ссылку на исходный документ.
3. Проблемные URL и редиректы фиксируйте в таблице из раздела 5.
4. При переносе/удалении документов обновляйте ссылки здесь в первую очередь.
5. Для правил работы ассистентов не дублируйте инструкции в docs: используйте только AGENTS.md и JSON.

---

## 7) Быстрый чек перед релизом документации

- Ссылки из этого файла открываются без 404.
- Новые разделы отражают фактическое состояние кода.
- Описание модулей не противоречит `README.md` и `technical_manual.md`.
