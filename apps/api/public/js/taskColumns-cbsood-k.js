import{j as s}from"./index-DgL4A3Hy.js";import{b as W,R as h}from"./vendor-bFQg9Mu4.js";import{P as le,o as q}from"./App-C5qf9m0C.js";import{E as A}from"./EmployeeLink-Cf0n-sug.js";function oe({title:n,titleId:e,...l},t){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":e},l),n?W.createElement("title",{id:e},n):null,W.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 1 1-16 0 8 8 0 0 1 16 0ZM8.94 6.94a.75.75 0 1 1-1.061-1.061 3 3 0 1 1 2.871 5.026v.345a.75.75 0 0 1-1.5 0v-.5c0-.72.57-1.172 1.081-1.287A1.5 1.5 0 1 0 8.94 6.94ZM10 15a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z",clipRule:"evenodd"}))}const ce=W.forwardRef(oe),U=n=>{if(!n)return null;const e=new Date(n);return Number.isNaN(e.getTime())?null:e},de=n=>Number.isNaN(n)?0:n>1?1:n<0?0:n,me=(n,e,l=new Date)=>{const t=U(e),r=U(n);if(!t)return{kind:"invalid",reason:e?"invalid":"missing",dueDate:null,startDate:r,remainingMs:null};const a=t.getTime()-l.getTime();if(a<0)return{kind:"overdue",dueDate:t,startDate:r,remainingMs:a};if(!r)return{kind:"pending",issue:"missing-start",dueDate:t,startDate:null,remainingMs:a};if(r.getTime()>=t.getTime())return{kind:"pending",issue:"invalid-range",dueDate:t,startDate:r,remainingMs:a};const o=t.getTime()-r.getTime(),i=de(a/o);let c;return i>.6?c="safe":i>=.2?c="warn":c="danger",{kind:"countdown",ratio:i,level:c,dueDate:t,startDate:r,remainingMs:a}},ge="inline-flex min-w-0 items-center gap-0.5 whitespace-nowrap rounded-full px-1.5 py-0.5 text-center text-[0.66rem] font-semibold uppercase tracking-wide shadow-xs",y="text-black dark:text-white",u=(n,e="")=>[ge,"transition-colors",y,e,n].filter(Boolean).join(" "),S="focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background",_="inline-flex max-w-full min-w-0 items-center gap-0.5 whitespace-nowrap rounded-full px-1.5 py-0.5 text-left text-[0.7rem] font-semibold leading-tight tracking-normal shadow-xs sm:px-1.5 sm:text-[0.76rem]",E="".concat(_," font-mono normal-case ").concat(y," ring-1 ring-slate-500/30 bg-slate-500/10 dark:bg-slate-500/20 dark:ring-slate-400/30"),ue="text-[0.65rem] font-semibold text-slate-500 dark:text-slate-200",fe="".concat(_," justify-center font-mono uppercase tracking-[0.18em] text-[0.68rem] ").concat(y," ring-1 ring-slate-500/30 bg-slate-500/10 dark:bg-slate-500/20 dark:ring-slate-400/30"),pe="".concat(_," justify-start normal-case ").concat(y," ring-1 ring-indigo-500/40 bg-indigo-500/15 dark:bg-indigo-400/25 dark:ring-indigo-300/45"),he="".concat(_," w-full max-w-full justify-start normal-case ").concat(y," ring-1 ring-blue-500/40 bg-blue-500/15 dark:bg-blue-400/20 dark:ring-blue-300/45"),xe="".concat(_," normal-case ").concat(y," ring-1 ring-violet-500/35 bg-violet-500/20 dark:bg-violet-400/30 dark:ring-violet-300/45"),T=u("bg-muted/60 ring-1 ring-muted-foreground/30 dark:bg-slate-700/60 dark:ring-slate-500/35"),O="".concat(_," normal-case ").concat(y," ring-1 ring-emerald-500/30 bg-emerald-500/15 dark:bg-emerald-400/20 dark:ring-emerald-300/30"),J="".concat(O," ").concat(S," no-underline underline-offset-4 hover:underline"),Q={Новая:u("bg-sky-500/20 ring-1 ring-sky-500/45 dark:bg-sky-400/25 dark:ring-sky-300/45"),"В работе":u("bg-amber-500/25 ring-1 ring-amber-500/45 dark:bg-amber-400/25 dark:ring-amber-300/45"),Выполнена:u("bg-emerald-500/20 ring-1 ring-emerald-500/40 dark:bg-emerald-400/25 dark:ring-emerald-300/45"),Отменена:u("bg-rose-500/20 ring-1 ring-rose-500/40 dark:bg-rose-400/25 dark:ring-rose-300/45")},be=u("bg-accent/80 ring-1 ring-destructive/40 dark:bg-accent/60 dark:ring-destructive/40"),ke=u("bg-accent/75 ring-1 ring-primary/40 dark:bg-accent/55 dark:ring-primary/40"),we=u("bg-accent/65 ring-1 ring-primary/30 dark:bg-accent/45 dark:ring-primary/30"),Ne=u("bg-accent/50 ring-1 ring-primary/20 dark:bg-accent/35 dark:ring-primary/20"),Y={срочно:u("bg-rose-500/20 ring-1 ring-rose-500/40 dark:bg-rose-400/25 dark:ring-rose-300/45"),"в течение дня":u("bg-sky-500/20 ring-1 ring-sky-500/40 dark:bg-sky-400/25 dark:ring-sky-300/45"),"до выполнения":u("bg-slate-500/25 ring-1 ring-slate-500/45 dark:bg-slate-400/25 dark:ring-slate-300/45","normal-case")},Z=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),ye=n=>Z(Q,n)?Q[n]:null,$e=n=>{const e=n.trim().toLowerCase();return e?Z(Y,e)?Y[e]:/сроч|urgent/.test(e)?be:/высок|повыш|high/.test(e)?ke:/низк|бесср|без\s+срок|до\s+выполн|low|minor/.test(e)?Ne:/обыч|дня|сутк|norm|stand/.test(e)?we:null:null},je=n=>{const e=n.trim();return e&&(/^бессроч/i.test(e)?"До выполнения":e)},ve="text-[11px] font-medium text-slate-600 dark:text-slate-300",v={доставить:u("bg-sky-500/20 ring-1 ring-sky-500/40 dark:bg-sky-400/25 dark:ring-sky-300/45"),купить:u("bg-violet-500/20 ring-1 ring-violet-500/40 dark:bg-violet-400/25 dark:ring-violet-300/45"),выполнить:u("bg-emerald-500/20 ring-1 ring-emerald-500/40 dark:bg-emerald-400/25 dark:ring-emerald-300/45"),построить:u("bg-amber-500/25 ring-1 ring-amber-500/45 dark:bg-amber-400/25 dark:ring-amber-300/45"),починить:u("bg-orange-500/20 ring-1 ring-orange-500/40 dark:bg-orange-400/25 dark:ring-orange-300/45")},Ce=n=>{const e=n.trim().toLowerCase();return e?Z(v,e)?v[e]:/стро|монтаж/.test(e)?v.построить:/ремонт|чин/.test(e)?v.починить:/закуп|покуп|приобр/.test(e)?v.купить:/достав|курьер/.test(e)?v.доставить:/исполн|выполн/.test(e)?v.выполнить:null:null},X=n=>{if(typeof n=="number")return Number.isFinite(n)?n:null;if(typeof n=="string"){const e=n.trim();if(!e)return null;const l=Number(e.replace(/\s+/g,"").replace(/,/g,"."));return Number.isFinite(l)?l:null}return null},_e=n=>{const e=X(n);return e!==null?e.toLocaleString("ru-RU",{maximumFractionDigits:2,minimumFractionDigits:2}):typeof n=="string"?n.trim():typeof n=="number"?n.toString():""},De=u("bg-emerald-500/20 ring-1 ring-emerald-500/40 dark:bg-emerald-400/25 dark:ring-emerald-300/45"),Me=u("bg-sky-500/20 ring-1 ring-sky-500/40 dark:bg-sky-400/25 dark:ring-sky-300/45"),Be=u("bg-amber-500/25 ring-1 ring-amber-500/45 dark:bg-amber-400/25 dark:ring-amber-300/45"),Te=u("bg-rose-500/20 ring-1 ring-rose-500/40 dark:bg-rose-400/25 dark:ring-rose-300/45"),We=n=>{const e=X(n);return e===null?null:e<5?De:e<25?Me:e<100?Be:Te},Ee=new Intl.DateTimeFormat("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:q}),Pe=new Intl.DateTimeFormat("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",timeZone:q}),Re=new Intl.DateTimeFormat("ru-RU",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:q}),C=n=>{if(!n)return null;const e=new Date(n);return Number.isNaN(e.getTime())?null:e},P=n=>{const e=C(n);if(!e)return null;const l="".concat(Ee.format(e).replace(", "," ")," ").concat(le),t=Pe.format(e),r=Re.format(e);return{full:l,date:t||l,time:r}},K=n=>{const e=P(n);return e?s.jsx("span",{className:E,title:e.full,children:s.jsxs("time",{dateTime:n,className:"flex w-full items-baseline gap-1 truncate tabular-nums",children:[s.jsx("span",{className:"truncate",children:e.date}),e.time?s.jsx("span",{className:ue,children:e.time}):null]})}):""},M=(n,e)=>{const l=n.trim();if(!l||e<2||l.length<=e)return l;const t=l.slice(0,e-1).trimEnd();return"".concat(t,"…")},Fe={task:{nominative:"Задача",accusative:"Задачу",genitive:"задачи"},request:{nominative:"Заявка",accusative:"Заявку",genitive:"заявки"}},N=(n,e,l)=>{const t=Fe[n][e];return l!=null&&l.lower?t.toLowerCase():t},L=(n,e)=>typeof n=="string"&&n.trim().toLowerCase()==="request"?"request":e,Ie=n=>n.replace(/[.*+?^${}()|[\\]\\]/g,"\\$&"),b="".concat(_," min-w-0 justify-start normal-case ").concat(y," tabular-nums ring-1"),Le={safe:"".concat(b," bg-emerald-500/25 ring-emerald-500/45 dark:bg-emerald-400/25 dark:ring-emerald-300/45"),warn:"".concat(b," bg-amber-500/25 ring-amber-500/45 dark:bg-amber-400/25 dark:ring-amber-300/45"),danger:"".concat(b," bg-orange-500/25 ring-orange-500/45 dark:bg-orange-400/25 dark:ring-orange-300/45"),overdue:"".concat(b," bg-rose-500/30 ring-rose-500/55 dark:bg-rose-400/30 dark:ring-rose-300/50"),pending:"".concat(b," bg-sky-500/20 ring-sky-500/45 dark:bg-sky-400/25 dark:ring-sky-300/45")},V="".concat(b," bg-slate-500/15 ring-slate-500/35 dark:bg-slate-500/25 dark:ring-slate-400/35"),B=n=>{const e=Math.abs(n),l=Math.max(0,Math.floor(e/(60*1e3))),t=Math.floor(l/1440),r=Math.floor(l%1440/60),a=l%60,o=i=>i.toString().padStart(2,"0");return{days:t,hours:r,minutes:a,paddedDays:o(t),paddedHours:o(r),paddedMinutes:o(a)}},g=(n,e)=>{const l=Math.abs(n)%100;if(l>=11&&l<=14)return e[2];const t=l%10;return t===1?e[0]:t>=2&&t<=4?e[1]:e[2]},Se=n=>n.kind==="overdue"?"overdue":n.kind==="pending"?"pending":n.level,Oe=n=>{const{days:e,hours:l,minutes:t}=B(n.remainingMs);return n.kind==="overdue"?"Просрочено на ".concat(e," ").concat(g(e,["день","дня","дней"])," ").concat(l," ").concat(g(l,["час","часа","часов"])," ").concat(t," ").concat(g(t,["минута","минуты","минут"])):n.kind==="pending"?"Начало через ".concat(e," ").concat(g(e,["день","дня","дней"])," ").concat(l," ").concat(g(l,["час","часа","часов"])," ").concat(t," ").concat(g(t,["минута","минуты","минут"])):"До дедлайна ".concat(e," ").concat(g(e,["день","дня","дней"])," ").concat(l," ").concat(g(l,["час","часа","часов"])," ").concat(t," ").concat(g(t,["минута","минуты","минут"]))},G=(n,e,l)=>{if(!e)return l?l.trim():void 0;if(n.kind==="overdue")return"Просрочено с ".concat(e.full);if(n.kind==="pending"){const t=n.issue==="missing-start"?"Не указана дата начала":"Диапазон дат некорректен";return"".concat(t,". Срок ").concat(e.full)}return"Выполнить до ".concat(e.full)},ee=6e4,Ke=n=>{const e=Math.abs(n);if(e<ee)return"менее минуты";const{days:l,hours:t,minutes:r}=B(e),a=[];return l&&a.push("".concat(l," ").concat(g(l,["день","дня","дней"]))),t&&a.push("".concat(t," ").concat(g(t,["час","часа","часов"]))),r&&a.length<2&&a.push("".concat(r," ").concat(g(r,["минута","минуты","минут"]))),a.length?a.slice(0,2).join(" "):"менее минуты"},te=(n,e,l)=>{if(n!=="Выполнена")return null;const t=C(e),r=C(l);if(!t||!r)return null;const a=r.getTime()-t.getTime();if(!Number.isFinite(a))return null;if(Math.abs(a)<ee)return"Выполнена точно в срок";const o=Ke(a);return o?a<0?"Выполнена досрочно на ".concat(o):"Выполнена с опозданием на ".concat(o):"Выполнена точно в срок"};function qe({startValue:n,dueValue:e,rawDue:l,status:t,completedAt:r}){const a=h.useMemo(()=>C(r),[r]),o=t==="Выполнена",[i,c]=h.useState(()=>a!=null?a:new Date);h.useEffect(()=>{if(o){a&&c(a);return}const D=()=>c(new Date);D();const F=window.setInterval(D,6e4);return()=>window.clearInterval(F)},[o,a,n,e]);const m=a!=null?a:i,d=h.useMemo(()=>me(n,e,m),[n,e,m]),f=h.useMemo(()=>P(e),[e]),k=h.useMemo(()=>te(t,e,r),[t,e,r]);if(d.kind==="invalid")return s.jsxs("span",{className:"".concat(V," inline-flex items-center gap-1.5"),title:d.reason==="missing"?"Срок не назначен":"Срок указан некорректно",children:[s.jsx(ce,{className:"size-4 flex-shrink-0 text-black dark:text-white","aria-hidden":!0}),s.jsx("span",{className:"truncate",children:"Нет данных"})]});const $=Se(d),w=Le[$],x=B(d.remainingMs),p=Oe(d),R=k?"".concat(k,". ").concat(G(d,f,l)):G(d,f,l);return s.jsxs("span",{className:"".concat(w," inline-flex items-center gap-1.5"),title:R,children:[s.jsx("span",{className:"sr-only",children:p}),s.jsxs("span",{"aria-hidden":!0,className:"flex items-end gap-1 text-black dark:text-white",children:[s.jsxs("span",{className:"flex flex-col items-center leading-tight",children:[s.jsx("span",{className:"text-[0.8rem] font-semibold tabular-nums",children:x.paddedDays}),s.jsx("span",{className:"text-[9px] font-medium text-black/80 dark:text-white/80",children:g(x.days,["день","дня","дней"])})]}),s.jsxs("span",{className:"flex flex-col items-center leading-tight",children:[s.jsx("span",{className:"text-[0.8rem] font-semibold tabular-nums",children:x.paddedHours}),s.jsx("span",{className:"text-[9px] font-medium text-black/80 dark:text-white/80",children:g(x.hours,["час","часа","часов"])})]}),s.jsxs("span",{className:"flex flex-col items-center leading-tight",children:[s.jsx("span",{className:"text-[0.8rem] font-semibold tabular-nums",children:x.paddedMinutes}),s.jsx("span",{className:"text-[9px] font-medium text-black/80 dark:text-white/80",children:g(x.minutes,["минута","минуты","минут"])})]})]}),k?s.jsx("span",{className:"sr-only",children:k}):null]})}const Ze={completed:"".concat(b," bg-emerald-500/25 ring-emerald-500/45 dark:bg-emerald-400/25 dark:ring-emerald-300/45"),cancelled:"".concat(b," bg-rose-500/30 ring-rose-500/55 dark:bg-rose-400/30 dark:ring-rose-300/50"),active:"".concat(b," bg-amber-500/25 ring-amber-500/45 dark:bg-amber-400/25 dark:ring-amber-300/45"),planned:"".concat(b," bg-sky-500/20 ring-sky-500/45 dark:bg-sky-400/25 dark:ring-sky-300/45"),idle:V},ne=(n,e,l)=>{const{days:t,hours:r,minutes:a}=n;if(!t&&!r&&!a)return e==="completed"?"".concat(N(l,"nominative")," завершена менее чем за минуту"):"Затрачено менее минуты";const o="".concat(t," ").concat(g(t,["день","дня","дней"])),i="".concat(r," ").concat(g(r,["час","часа","часов"])),c="".concat(a," ").concat(g(a,["минута","минуты","минут"])),m="".concat(o," ").concat(i," ").concat(c);return e==="completed"?"".concat(N(l,"nominative")," завершена за ").concat(m):"Затрачено ".concat(m)},ze=(n,e,l,t,r="task")=>{const a=[],o=e?P(e):null,i=l?P(l):null;if(o&&a.push("Начало: ".concat(o.full)),i&&a.push(n==="completed"?"Завершено: ".concat(i.full):"Текущее время: ".concat(i.full)),t){const c=ne(t,n==="completed"?"completed":"running",r),m=n==="completed"?c.replace(new RegExp("^".concat(Ie("".concat(N(r,"nominative")," завершена за ")))),"Продолжительность: "):c.replace(/^Затрачено\s/,"Продолжительность: ");a.push(n==="idle"?"Продолжительность: ".concat(c):m)}return a.length?a.join("\n"):n==="idle"?"Продолжительность появится после указания даты начала":"Нет данных о продолжительности"};function He({progressStartValue:n,plannedStartValue:e,completedValue:l,status:t,entityKind:r}){var H;const a=h.useMemo(()=>C(e),[e]),o=h.useMemo(()=>C(n),[n]),i=h.useMemo(()=>C(l),[l]),c=t==="Выполнена"||t==="Отменена",m=t==="Отменена",d=t==="Новая",f=h.useMemo(()=>{var j;return d?null:(j=o!=null?o:a)!=null?j:null},[d,o,a]),[k,$]=h.useState(()=>c&&i?i:new Date);h.useEffect(()=>{if(c){i&&$(i);return}if(!f)return;const j=()=>$(new Date);j();const I=window.setInterval(j,6e4);return()=>window.clearInterval(I)},[c,i,f]);const w=c&&i?i:k,x=f?Math.max(0,w.getTime()-f.getTime()):null,p=h.useMemo(()=>d?B(0):x!==null?B(x):null,[x,d]),R=h.useMemo(()=>w.toISOString(),[w]),D=d||!f?"idle":c?"completed":"running",F=d||!f?"idle":c?m?"cancelled":"completed":t==="В работе"?"active":"planned",z=d?"".concat(N(r,"nominative")," ещё не начата"):p?ne(p,D==="completed"?"completed":"running",r):"Продолжительность появится после начала",re=(H=n!=null?n:e)!=null?H:void 0,ae=d?"Таймер запустится после перевода ".concat(N(r,"genitive",{lower:!0})," в статус «В работе»"):ze(D,re,D==="completed"?l!=null?l:void 0:R,p!=null?p:void 0,r),se=()=>{if(c&&i&&l)return K(l);if(c)return s.jsx("span",{className:E,title:"Нет отметки о завершении",children:s.jsx("span",{className:"truncate",children:"Нет данных"})});if(!f){const I=t==="Новая"?"Не начата":t==="В работе"?"В работе":"В ожидании",ie=t==="Новая"?"".concat(N(r,"nominative")," ещё не начата"):t==="В работе"?"Таймер запустится после фиксации начала":"Дата начала отсутствует";return s.jsx("span",{className:E,title:ie,children:s.jsx("span",{className:"truncate",children:I})})}const j=t==="В работе"?"В работе":"В ожидании";return s.jsx("span",{className:E,title:"".concat(N(r,"nominative")," ещё не завершена"),children:s.jsx("span",{className:"truncate",children:j})})};return s.jsxs("div",{className:"flex flex-col items-start gap-1",children:[se(),s.jsxs("span",{className:"".concat(Ze[F]," inline-flex items-center gap-1.5"),title:ae,children:[s.jsx("span",{className:"sr-only",children:z}),p?s.jsxs("span",{"aria-hidden":!0,className:"flex items-end gap-1 text-black dark:text-white",children:[s.jsxs("span",{className:"flex flex-col items-center leading-tight",children:[s.jsx("span",{className:"text-[0.8rem] font-semibold tabular-nums",children:p.paddedDays}),s.jsx("span",{className:"text-[9px] font-medium text-black/80 dark:text-white/80",children:g(p.days,["день","дня","дней"])})]}),s.jsxs("span",{className:"flex flex-col items-center leading-tight",children:[s.jsx("span",{className:"text-[0.8rem] font-semibold tabular-nums",children:p.paddedHours}),s.jsx("span",{className:"text-[9px] font-medium text-black/80 dark:text-white/80",children:g(p.hours,["час","часа","часов"])})]}),s.jsxs("span",{className:"flex flex-col items-center leading-tight",children:[s.jsx("span",{className:"text-[0.8rem] font-semibold tabular-nums",children:p.paddedMinutes}),s.jsx("span",{className:"text-[9px] font-medium text-black/80 dark:text-white/80",children:g(p.minutes,["минута","минуты","минут"])})]})]}):s.jsx("span",{className:"text-xs font-medium text-black dark:text-white",children:z})]})]})}function Ye(n,e="task"){return[{header:"Номер",id:"number",accessorFn:t=>{const a=L(t.kind,e)==="request"?t.request_id||t.task_number||t._id:t.task_number||t.request_id||t._id;return typeof a=="string"?a:a==null?"":String(a)},meta:{width:"clamp(4.25rem, 8vw, 6.25rem)",minWidth:"4rem",maxWidth:"6.5rem",cellClassName:"whitespace-nowrap text-center font-mono tabular-nums sm:text-left sm:pl-1.5",headerClassName:"whitespace-nowrap text-center sm:text-left"},cell:t=>{var f,k,$,w;const r=t.row.original,a=L(r.kind,e),o=(t.getValue()||"").trim(),i=a==="request"?(k=(f=r.request_id)!=null?f:r.task_number)!=null?k:String(r._id):(w=($=r.task_number)!=null?$:r.request_id)!=null?w:String(r._id),c=o||i||"",m=c.match(/\d+/),d=m?m[0]:c;return s.jsx("span",{className:"".concat(fe," justify-center"),title:c,children:s.jsx("span",{className:"truncate",children:d})})}},{header:"".concat(N(e,"accusative")," создал"),accessorKey:"createdAt",meta:{width:"clamp(9rem, 18vw, 14rem)",minWidth:"8.5rem",maxWidth:"16rem",cellClassName:"whitespace-nowrap"},cell:({row:t})=>{var d,f;const r=(f=(d=t.original.created_by)!=null?d:t.original.createdBy)!=null?f:t.original.creator,a=typeof r=="number"?r:typeof r=="string"&&r.trim()?Number(r):NaN;if(!Number.isFinite(a))return s.jsx("span",{className:"text-muted-foreground",children:"—"});const o=a,i=n[o],c=(i==null?void 0:i.name)||(i==null?void 0:i.telegram_username)||(i==null?void 0:i.username)||String(o),m=c.trim()||String(o);return s.jsx(A,{employeeId:o,stopPropagation:!0,title:m,className:"".concat(he," ").concat(S," no-underline"),children:s.jsx("span",{className:"truncate",children:M(c,32)})})}},{header:"Название",accessorKey:"title",meta:{width:"clamp(8rem, 18vw, 18rem)",minWidth:"7rem",maxWidth:"18rem",cellClassName:"align-top"},cell:t=>{var c,m;const r=t.getValue()||"",a=M(r,72),o=t.row.original,i=te(o.status,(c=o.due_date)!=null?c:void 0,(m=o.completed_at)!=null?m:void 0);return s.jsxs("div",{className:"flex flex-col items-start gap-1",children:[s.jsx("span",{title:r,className:"".concat(pe," whitespace-normal"),children:s.jsx("span",{className:"block max-w-full break-words text-left leading-snug",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:a})}),i?s.jsx("span",{className:ve,children:i}):null]})}},{header:"Исполнители",accessorKey:"assignees",meta:{width:"clamp(7rem, 20vw, 13rem)",minWidth:"6rem",maxWidth:"13rem"},cell:({row:t})=>{const r=Array.isArray(t.original.assignees)?t.original.assignees:typeof t.original.assigned_user_id=="number"?[t.original.assigned_user_id]:[];if(!r.length)return s.jsx("span",{className:"text-muted-foreground",children:"—"});const a=r.map(i=>{var c,m,d;return{id:i,label:((c=n[i])==null?void 0:c.name)||((m=n[i])==null?void 0:m.telegram_username)||((d=n[i])==null?void 0:d.username)||String(i)}}),o=a.map(i=>i.label).join(", ");return s.jsx("div",{className:"flex w-full flex-wrap items-start gap-1 leading-tight",title:o,children:a.map(({id:i,label:c})=>s.jsx(A,{employeeId:i,stopPropagation:!0,className:"".concat(xe," ").concat(S," no-underline"),children:s.jsx("span",{className:"truncate",children:M(c,18)})},i))})}},{header:"Статус",accessorKey:"status",meta:{width:"clamp(4.5rem, 8vw, 6.5rem)",minWidth:"4.5rem",maxWidth:"6.5rem",cellClassName:"whitespace-nowrap"},cell:t=>{const r=t.getValue()||"";if(!r)return"";const a=ye(r);return a?s.jsx("span",{className:a,children:r}):s.jsx("span",{className:T,children:r})}},{header:"Приоритет",accessorKey:"priority",meta:{width:"clamp(8.5rem, 15vw, 12.5rem)",minWidth:"8.5rem",maxWidth:"12.5rem",cellClassName:"whitespace-nowrap"},cell:t=>{const r=t.getValue()||"";if(!r.trim())return"";const a=je(r),i=$e(r)||"".concat(T," normal-case");return s.jsx("span",{className:i,title:a,children:a})}},{header:"Начало",accessorKey:"start_date",meta:{width:"clamp(6.75rem, 11vw, 8.75rem)",minWidth:"6.5rem",maxWidth:"9rem",cellClassName:"whitespace-nowrap text-xs sm:text-sm"},cell:t=>K(t.getValue())},{header:"Дедлайн",accessorKey:"due_date",meta:{width:"clamp(10.5rem, 20vw, 15.5rem)",minWidth:"10rem",maxWidth:"16.5rem",cellClassName:"whitespace-nowrap text-xs sm:text-sm"},cell:t=>{var c,m,d;const r=t.getValue(),a=t.row.original,o=s.jsx(qe,{startValue:(c=a.start_date)!=null?c:void 0,dueValue:(m=a.due_date)!=null?m:void 0,rawDue:r,status:a.status,completedAt:(d=a.completed_at)!=null?d:void 0});if(!r)return o;const i=K(r);return typeof i=="string"?i?s.jsxs("div",{className:"flex flex-col items-start gap-1",children:[i?s.jsx("span",{children:i}):null,o]}):o:s.jsxs("div",{className:"flex flex-col items-start gap-1",children:[i,o]})}},{header:"Время выполнения",accessorKey:"completed_at",meta:{width:"clamp(10.5rem, 20vw, 15.5rem)",minWidth:"10rem",maxWidth:"16.5rem",cellClassName:"whitespace-nowrap text-xs sm:text-sm"},cell:t=>{var o,i,c;const r=t.row.original,a=L(r.kind,e);return s.jsx(He,{progressStartValue:(o=r.in_progress_at)!=null?o:void 0,plannedStartValue:(i=r.start_date)!=null?i:void 0,completedValue:(c=t.getValue())!=null?c:void 0,status:r.status,entityKind:a})}},{header:"Тип",accessorKey:"task_type",meta:{width:"clamp(4.5rem, 8vw, 6.5rem)",minWidth:"4.5rem",maxWidth:"6.5rem",cellClassName:"whitespace-nowrap"},cell:t=>{const a=(t.getValue()||"").trim();if(!a)return"";const i=Ce(a)||"".concat(T," normal-case");return s.jsx("span",{className:i,title:a,children:a})}},{header:"Старт",accessorKey:"start_location",meta:{width:"clamp(5.5rem, 14vw, 9.5rem)",minWidth:"5rem",maxWidth:"9.5rem",cellClassName:"whitespace-nowrap"},cell:({row:t})=>{var m,d;const r=(m=t.original.start_location)!=null?m:"",a=r.trim(),o=a.split(/[\s,;]+/).filter(Boolean)[0]||a,i=M(o,24),c=(d=t.original.start_location_link)!=null?d:void 0;return c?s.jsx("a",{href:c,target:"_blank",rel:"noopener noreferrer",className:J,title:r,children:s.jsx("span",{className:"truncate",children:i})}):s.jsx("span",{title:r,className:O,children:s.jsx("span",{className:"truncate",children:i})})}},{header:"Финиш",accessorKey:"end_location",meta:{width:"clamp(5.5rem, 14vw, 9.5rem)",minWidth:"5rem",maxWidth:"9.5rem",cellClassName:"whitespace-nowrap"},cell:({row:t})=>{var m,d;const r=(m=t.original.end_location)!=null?m:"",a=r.trim(),o=a.split(/[\s,;]+/).filter(Boolean)[0]||a,i=M(o,24),c=(d=t.original.end_location_link)!=null?d:void 0;return c?s.jsx("a",{href:c,target:"_blank",rel:"noopener noreferrer",className:J,title:r,children:s.jsx("span",{className:"truncate",children:i})}):s.jsx("span",{title:r,className:O,children:s.jsx("span",{className:"truncate",children:i})})}},{header:"Км",accessorKey:"route_distance_km",meta:{width:"clamp(3.25rem, 6vw, 4.75rem)",minWidth:"3rem",maxWidth:"4.75rem",cellClassName:"whitespace-nowrap text-center sm:text-left",headerClassName:"text-center sm:text-left"},cell:t=>{const r=t.getValue();if(r==null||typeof r=="string"&&!r.trim())return"";const a=_e(r);if(!a)return"";const i=We(r)||T;return s.jsx("span",{className:i,title:"".concat(a," км"),children:a})}}]}export{qe as D,Ce as a,$e as b,he as c,T as f,ye as g,Ye as t};
//# sourceMappingURL=taskColumns-cbsood-k.js.map
