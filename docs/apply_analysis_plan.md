<!-- Назначение файла: план внедрения рекомендаций из анализа. Затрагиваются модули bot и web. -->

# План внедрения рекомендаций

Документ содержит задачи по реализации предложений из проведённого анализа. Они сгруппированы по направлениям.

## Бекенд

1. Подготовить постепенную миграцию кода на TypeScript: настроить сборку и добавить типы для сервисов.
2. Проверить индексы MongoDB на полях фильтрации задач и пользователей.
3. Настроить мониторинг размера файла `logs/api.log` и параметра `LOG_BUFFER_SIZE`, при необходимости автоматически архивировать записи старше 30 дней.
4. Добавить алерты Prometheus на рост метрик ошибок и CSRF.
5. Расширить набор автотестов, покрывая критичные маршруты и проверки ролей.
6. Включить `noImplicitAny`, убрать директивы `@ts-nocheck` и описать типы контроллеров и сервисов.
7. Заменить все `any` на явные типы, вернуть правило ESLint `no-explicit-any`.
8. Удалить модуль `services/tasks.ts`, перенести его функции в `TasksService`.
9. Перейти от service locator к инъекциям через конструкторы `tsyringe`.
10. Разделить `db/queries.ts` на специализированные репозитории по доменам.
11. Типизировать логгер `wgLogEngine` и описать интерфейсы выходов.

## Фронтенд

1. Провести тестирование интерфейса в актуальных браузерах и на мобильных устройствах.
2. Реализовать переключение тёмной темы через Tailwind.
3. Проверить контрастность текста по WCAG и скорректировать цвета при необходимости.
4. Доработать поиск и фильтры задач, добавить всплывающие уведомления об успехе и ошибках.
5. Переписать форму задач на React Hook Form + Zod, использовать react-select для выбора исполнителей и контролёров.

## Безопасность

1. Использовать DOMPurify для очистки HTML описаний задач.
2. Настроить лимит попыток отправки кода авторизации и добавить логирование этих событий.
3. Регулярно обновлять зависимости через `pnpm audit` и Dependabot.

## Telegram-бот

1. Обновить команду `/help`, указав все доступные действия.
2. Добавить inline-кнопки для смены статуса задач прямо из списка.
3. Использовать `sendChatAction('typing')` при длительных операциях.
4. Реализовать команду `/feedback` для сбора отзывов.
5. Перейти на паттерн Command для обработки команд бота.
6. Использовать паттерн Strategy для различных методов расчёта маршрутов.

## Общие задачи

1. Завершить настройку CI/CD на GitHub Actions с автодеплоем на Railway.
2. Дополнить документацию диаграммами архитектуры.
3. В README перечислить модули Auth, Tasks, Users, Roles и Logs.
4. Добавить примеры вызова API с DTO в разделе быстрого старта.
5. Унифицировать обработку ошибок API с использованием собственных классов.
6. Расширить тестовое покрытие для ролей, логов и команд бота.
7. Обновить документацию после рефакторинга типизации и архитектуры.
